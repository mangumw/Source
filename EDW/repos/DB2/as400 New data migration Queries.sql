create table CSHEGC(
StoreNumber int,
TransactionDate date,
RegisterNumber int,
RollOverNumber int,
TransactionNumber int,
SequenceNumber int,
TransactionType varchar(2),
ExtendedAmount decimal (9,2),
GiftCardNumber varchar (20),
GCAuthCode varchar(10),
DateCreated Date,
ProgramName varchar(10)
)

CREATE TABLE [dbo].[CSHEGC](
	[Store_Number] [decimal](18, 0) NULL,
	[Day_Date] [smalldatetime] NULL,
	[Register_Number] [decimal](18, 0) NULL,
	[Roll_Over] [decimal](18, 0) NULL,
	[Transaction_Number] [decimal](18, 0) NULL,
	[Sequence_Number] [decimal](18, 0) NULL,
	[Transaction_Type] [varchar](2) NULL,
	[Extended_Amount] [decimal](29, 2) NULL,
	[Gift_Card_Number] [varchar](20) NULL,
	[GC_Auth_Code] [varchar](10) NULL,
	[Date_Created] [numeric](8, 0) NULL,
	[Program_Name] [varchar](10) NULL
) ON [PRIMARY]
GO


insert into CSHEGC(
StoreNumber,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
SequenceNumber,
TransactionType,
ExtendedAmount,
GiftCardNumber,
GCAuthCode,
DateCreated,
ProgramName)

select top 10
StoreNumber,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
SequenceNumber,
TransactionType,
ExtendedAmount,
GiftCardNumber,
GCAuthCode,
DateCreated,
ProgramName
 from openquery (bkl400, 
'select 
EGSTOR as StoreNumber,
to_date(CHAR(EGDATE), ''YYYYMMDD'') as TransactionDate,
EGREG# as RegisterNumber,
EGROLL as RollOverNumber,
EGTRN# as TransactionNumber,
EGSEQ# as SequenceNumber,
EGDTYP as TransactionType,
EGEXTA as ExtendedAmount,
EGGCNM as GiftCardNumber,
EGGCAC as GCAuthCode,
to_date(char(EGCDTE), ''YYYYMMDD'') as DateCreated,
EGPRGM as ProgramName
from MM4R4LIB.CSHEGC
WHERE egdate >= varchar_format (current date -1 days, ''YYYYMMDD'')')

create table CSHRED (
StoreNumber int,
TransactionCentury int,
TransactionDate date,
RegisterNumber int,
TillNumber int,
ReportLineNo int,
DepartmentNo int,
ReportAmount Decimal(11,2)
)

insert into CSHRED (
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
TillNumber,
ReportLineNo,
DepartmentNo,
ReportAmount
)

select TOP 10 
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
TillNumber,
ReportLineNo,
DepartmentNo,
ReportAmount
from openquery (bkl400,
'select 
RDSTOR as StoreNumber,
RDCEN as TransactionCentury,
timestamp_format(char(RDDATE), ''YYMMDD'') as TransactionDate,
RDREG as RegisterNumber,
RDTIL as TillNumber,
RDLIN as ReportLineNo,
RDDEPT as DepartmentNo,
RDAMT as ReportAmount
from MM4R4LIB.CSHRED 
where rddate >= varchar_format (current date -1 days, ''YYMMDD'')')

Create table CSHSUM (
StoreNumber int,
TransactionCentury int,
TransactionDate date,
RegisterNumber int,
RollOverNumber int,
TransactionNumber int,
TransactionTime int,
TransactionType varchar (2),
TransactionAmount decimal (11,2),
TenderAmount decimal (11,2),
Status varchar(1),
Highlight varchar(1),
CashierNumber int,
TillNumber int,
SalespersonNo int,
AcctType varchar(1),
AccountNumber int,
ReasonCode varchar (16),
OriginalSalesperson int,
OriginalStore int,
CustomerNumber int,
ProcessDate date
)

insert into CSHSUM (
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
TransactionTime,
TransactionType,
TransactionAmount,
TenderAmount,
Status,
Highlight,
CashierNumber,
TillNumber,
SalespersonNo,
AcctType,
AccountNumber,
ReasonCode,
OriginalSalesperson,
OriginalStore,
CustomerNumber,
ProcessDate
)

select TOP 10
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
TransactionTime,
TransactionType,
TransactionAmount,
TenderAmount,
Status,
Highlight,
CashierNumber,
TillNumber,
SalespersonNo,
AcctType,
AccountNumber,
ReasonCode,
OriginalSalesperson,
OriginalStore,
CustomerNumber,
ProcessDate
from openquery (bkl400, 
'select 
CSSTOR	as StoreNumber,
CSCEN	as TransactionCentury,
timestamp_format(char(CSDATE), ''YYMMDD'')	as TransactionDate,
CSREG#	as RegisterNumber,
CSROLL	as RollOverNumber,
CSTRN#	as TransactionNumber,
CSTIME	as TransactionTime,
CSTTYP	as TransactionType,
CSTAMT	as TransactionAmount,
CSTTND	as TenderAmount,
CSTSTS	as Status,
CSHLTE	as Highlight,
CSCSH#	as CashierNumber,
CSTIL	as TillNumber,
CSSLPR	as SalespersonNo,
CSATYP	as AcctType,
CSACCT	as AccountNumber,
CSSRSN	as ReasonCode,
CSSOSP	as OriginalSalesperson,
CSSOST	as OriginalStore,
CSCUST	as CustomerNumber,
to_date(char(CSPDTE), ''YYYYMMDD'')	as ProcessDate
from MM4R4LIB.CSHSUM
where CSDATE >= varchar_format (current date -1 days, ''YYMMDD'')')

create table CSHTND (
StoreNumber int,
TransactionCentury int,
TransactionDate date,
RegisterNumber int,
RollOverNumber int,
TransactionNumber int,
SequenceNumber int,
TransactionType varchar(2),
AmountTendered decimal (11,2),
TenderDocumentNumber varchar (15),
Status varchar(1),
CashierNumber int,
TillNumber int,
CreditCardNumber varchar(21),
ExpiryDate decimal(5,0),
AuthorizationCode varchar(6),
POSSeqNumber int
)

insert into CSHTND (
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
SequenceNumber,
TransactionType,
AmountTendered,
TenderDocumentNumber,
Status,
CashierNumber,
TillNumber,
CreditCardNumber,
ExpiryDate,
AuthorizationCode,
POSSeqNumber
)

select TOP 10 
StoreNumber,
TransactionCentury,
TransactionDate,
RegisterNumber,
RollOverNumber,
TransactionNumber,
SequenceNumber,
TransactionType,
AmountTendered,
TenderDocumentNumber,
Status,
CashierNumber,
TillNumber,
CreditCardNumber,
ExpiryDate,
AuthorizationCode,
POSSeqNumber
from openquery (bkl400, 
'select 
CSSTOR as StoreNumber,
CSCEN as TransactionCentury,
case cscen 
when 0 then date(timestamp_format(char(CSDATE+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(CSDATE,6,0)),''YYMMDD'') end as TransactionDate,
CSREG# as RegisterNumber,
CSROLL as RollOverNumber,
CSTRN# as TransactionNumber,
CSSEQ# as SequenceNumber,
CSDTYP as TransactionType,
CSDAMT as AmountTendered,
CSDOC# as TenderDocumentNumber,
CSDSTS as Status,
CSCSH# as CashierNumber,
CSTIL as TillNumber,
CSCRD# as CreditCardNumber,
CSCRDX as ExpiryDate,
CSCAUT as AuthorizationCode,
CSPSSQ as POSSeqNumber
from MM4R4LIB.CSHTND')

create table CSHDEP (
StoreNumber int,
DepositCentury int,
DepositDate Date,
RegisterNumber int,
TillNumber int,
ReportLineNo int,
DepositAmount decimal(11,2)
)

insert into CSHDEP (
StoreNumber,
DepositCentury,
DepositDate,
RegisterNumber,
TillNumber,
ReportLineNo,
DepositAmount 
)

select TOP 10 
StoreNumber,
DepositCentury,
DepositDate,
RegisterNumber,
TillNumber,
ReportLineNo,
DepositAmount 
from openquery (bkl400, 
'select 
DPSTOR as StoreNumber,
DPCEN as DepositCentury,
case DPCEN 
when 0 then date(timestamp_format(char(DPDATE+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(DPDATE,6,0)),''YYMMDD'') end as DepositDate,
DPREG as RegisterNumber,
DPTIL as TillNumber,
DPLIN as ReportLineNo,
DPAMT as DepositAmount
from MM4R4LIB.CSHDEP')

create table TRFHDR (
TransferBatchNumber varchar (8),
TransferStatusOptions varchar (1),
TransferType varchar (1),
TransferPriorityCodes varchar (1),
FromStoreorWarehouse int,
ToStoreorWarehouse int,
InitiationDateCenturyCode int,
InitiationDate date,
ShipbyDateCenturyCode int,
ShipbyDate date,
ShippingDateCenturyCode int,
ShippingDate date,
ReceivingDateCenturyCode int,
RecvDate date,
SpecialInstructionsLine varchar (30),
DefaultWarehouseSlot varchar (8),
TransferReferenceNumberPONumberWONumber varchar (8),
ShippingDocumentPrinted varchar (1),
TransferInitiatedByCode varchar (1),
PurchaseOrderNumber int,
PurchaseOrderBackOrder int,
TotalUnitsRequestedforallDetail int,
TotalPicksRequestedforallDetail int,
TotalPalletsRequestforallDetail int,
TotalCartonsRequestedforallDetail int,
TotalInnerPacksRequestedforallDetail int,
TotalRetailValueofallDetailLines decimal (11,2),
TotalCostValueofallDetailLines decimal (11,3),
TotalCubeMeasureofallDetailLines decimal (11,3),
TotalUnitsPickedofallDetail int,
TotalPalletsPickedofallDetail int,
TotalCartonsPickedofallDetail int,
TotalInnerPacksPickedofallDetail int,
TotalRetailValueofallallPickedDetailLines decimal (11,2),
TotalCostValueofallPickedDetailLines decimal (11,3),
TotalCubicMeasureofallPickedDetailLines decimal (11,3),
TransferLinestoPick int,
WarehouseCycleNumber int,
ScheduleWaveNumber int,
ScheduleWaveSequence int,
ScheduleName varchar (8),
TransferXRef varchar(8),
ConsolidateTransfer varchar(1) 
)

insert into TRFHDR (
TransferBatchNumber,
TransferStatusOptions,
TransferType,
TransferPriorityCodes,
FromStoreorWarehouse,
ToStoreorWarehouse,
InitiationDateCenturyCode,
InitiationDate,
ShipbyDateCenturyCode,
ShipbyDate,
ShippingDateCenturyCode,
ShippingDate,
ReceivingDateCenturyCode,
RecvDate,
SpecialInstructionsLine,
DefaultWarehouseSlot,
TransferReferenceNumberPONumberWONumber,
ShippingDocumentPrinted,
TransferInitiatedByCode,
PurchaseOrderNumber,
PurchaseOrderBackOrder,
TotalUnitsRequestedforallDetail,
TotalPicksRequestedforallDetail,
TotalPalletsRequestforallDetail,
TotalCartonsRequestedforallDetail,
TotalInnerPacksRequestedforallDetail,
TotalRetailValueofallDetailLines,
TotalCostValueofallDetailLines,
TotalCubeMeasureofallDetailLines,
TotalUnitsPickedofallDetail,
TotalPalletsPickedofallDetail,
TotalCartonsPickedofallDetail,
TotalInnerPacksPickedofallDetail,
TotalRetailValueofallallPickedDetailLines,
TotalCostValueofallPickedDetailLines,
TotalCubicMeasureofallPickedDetailLines,
TransferLinestoPick,
WarehouseCycleNumber,
ScheduleWaveNumber,
ScheduleWaveSequence,
ScheduleName,
TransferXRef,
ConsolidateTransfer  
)

select TOP 10 
TransferBatchNumber,
TransferStatusOptions,
TransferType,
TransferPriorityCodes,
FromStoreorWarehouse,
ToStoreorWarehouse,
InitiationDateCenturyCode,
InitiationDate,
ShipbyDateCenturyCode,
ShipbyDate,
ShippingDateCenturyCode,
ShippingDate,
ReceivingDateCenturyCode,
RecvDate,
SpecialInstructionsLine,
DefaultWarehouseSlot,
TransferReferenceNumberPONumberWONumber,
ShippingDocumentPrinted,
TransferInitiatedByCode,
PurchaseOrderNumber,
PurchaseOrderBackOrder,
TotalUnitsRequestedforallDetail,
TotalPicksRequestedforallDetail,
TotalPalletsRequestforallDetail,
TotalCartonsRequestedforallDetail,
TotalInnerPacksRequestedforallDetail,
TotalRetailValueofallDetailLines,
TotalCostValueofallDetailLines,
TotalCubeMeasureofallDetailLines,
TotalUnitsPickedofallDetail,
TotalPalletsPickedofallDetail,
TotalCartonsPickedofallDetail,
TotalInnerPacksPickedofallDetail,
TotalRetailValueofallallPickedDetailLines,
TotalCostValueofallPickedDetailLines,
TotalCubicMeasureofallPickedDetailLines,
TransferLinestoPick,
WarehouseCycleNumber,
ScheduleWaveNumber,
ScheduleWaveSequence,
ScheduleName,
TransferXRef,
ConsolidateTransfer  
from openquery (bkl400, 
'select 
TRFBCH as TransferBatchNumber,
TRFSTS as TransferStatusOptions,
TRFTYP as TransferType,
TRFPTY as TransferPriorityCodes,
TRFFLC as FromStoreorWarehouse,
TRFTLC as ToStoreorWarehouse,
TRFICN as InitiationDateCenturyCode,
case TRFICN 
when 0 then date(timestamp_format(char(TRFIDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(TRFIDT,6,0)),''YYMMDD'') end as InitiationDate,
TRFBCN as ShipbyDateCenturyCode,
case TRFBCN 
when 0 then date(timestamp_format(char(TRFBDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(TRFBDT,6,0)),''YYMMDD'') end as ShipbyDate,
TRFSCN as ShippingDateCenturyCode,
case TRFSCN 
when 0 then date(timestamp_format(char(TRFSDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(TRFSDT,6,0)),''YYMMDD'') end as ShippingDate,
TRFRCN as ReceivingDateCenturyCode,
case TRFRCN 
when 0 then date(timestamp_format(char(TRFRDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(TRFRDT,6,0)),''YYMMDD'') end as RecvDate,
TRFINS as SpecialInstructionsLine,
TRFDLC as DefaultWarehouseSlot,
TRFREF as TransferReferenceNumberPONumberWONumber,
TRFPYN as ShippingDocumentPrinted,
TRINIT as TransferInitiatedByCode,
TRFPO# as PurchaseOrderNumber,
TRFBO# as PurchaseOrderBackOrder,
THTUNT as TotalUnitsRequestedforallDetail,
THTPCK as TotalPicksRequestedforallDetail,
THTPLT as TotalPalletsRequestforallDetail,
THTCTN as TotalCartonsRequestedforallDetail,
THTIPK as TotalInnerPacksRequestedforallDetail,
THTRTA as TotalRetailValueofallDetailLines,
THTCST as TotalCostValueofallDetailLines,
THTCUB as TotalCubeMeasureofallDetailLines,
THTUNP as TotalUnitsPickedofallDetail,
THTPLP as TotalPalletsPickedofallDetail,
THTCTP as TotalCartonsPickedofallDetail,
THTIPP as TotalInnerPacksPickedofallDetail,
THTRTP as TotalRetailValueofallallPickedDetailLines,
THTCSP as TotalCostValueofallPickedDetailLines,
THTPCU as TotalCubicMeasureofallPickedDetailLines,
TRPKLN as TransferLinestoPick,
THCYCL as WarehouseCycleNumber,
THSCWV as ScheduleWaveNumber,
THSCSQ as ScheduleWaveSequence,
THSCNM as ScheduleName,
TRFXRF as TransferXRef,
THCNYN as ConsolidateTransfer 
from MM4R4LIB.TRFHDR')

create table TRFDTL (
TransferBatchNumber varchar (8),
FromStoreorWarehouse int,
ToStoreorWarehouse int,
SkuNumber int,
VendorNumber int,
Dept int,
SubDept int,
Class int,
SubClass int,
QtyRequest int,
QtyShipped int,
QtyReceive int,
QtyAllocate int,
SubstituteNumber int,
SubstituteCode varchar(1),
ReceivedWarehouseLocation varchar(8),
UnitCost decimal (9,3),
RetailIn decimal (9,2),
RetailOut decimal (9,2),
Cube decimal (9,3),
VendorsPartNumber varchar(15),
TransferStatusOpt varchar(1),
TransferType varchar(1),
TransferPriorityOpt varchar(1),
WarehouseCycleNumber int,
ScheduleWaveNumber int,
ScheduleWaveSequence int,
ScheduleName varchar(8),
StyleVendor int,
StyleNumber varchar(15),
ColorCode int,
SizeCode varchar (4),
DimensionCode varchar(4),
TransferDiscrepancyFlag varchar(1),
CartonShipQty int,
CartonReceiveQty int,
Weight decimal (7,3)
)

insert into TRFDTL (
TransferBatchNumber,
FromStoreorWarehouse,
ToStoreorWarehouse,
SkuNumber,
VendorNumber,
Dept,
SubDept,
Class,
SubClass,
QtyRequest,
QtyShipped,
QtyReceive,
QtyAllocate,
SubstituteNumber,
SubstituteCode,
ReceivedWarehouseLocation,
UnitCost,
RetailIn,
RetailOut,
Cube,
VendorsPartNumber,
TransferStatusOpt,
TransferType,
TransferPriorityOpt,
WarehouseCycleNumber,
ScheduleWaveNumber,
ScheduleWaveSequence,
ScheduleName,
StyleVendor,
StyleNumber,
ColorCode,
SizeCode,
DimensionCode,
TransferDiscrepancyFlag,
CartonShipQty,
CartonReceiveQty,
Weight  
)

select TOP 10 
TransferBatchNumber,
FromStoreorWarehouse,
ToStoreorWarehouse,
SkuNumber,
VendorNumber,
Dept,
SubDept,
Class,
SubClass,
QtyRequest,
QtyShipped,
QtyReceive,
QtyAllocate,
SubstituteNumber,
SubstituteCode,
ReceivedWarehouseLocation,
UnitCost,
RetailIn,
RetailOut,
Cube,
VendorsPartNumber,
TransferStatusOpt,
TransferType,
TransferPriorityOpt,
WarehouseCycleNumber,
ScheduleWaveNumber,
ScheduleWaveSequence,
ScheduleName,
StyleVendor,
StyleNumber,
ColorCode,
SizeCode,
DimensionCode,
TransferDiscrepancyFlag,
CartonShipQty,
CartonReceiveQty,
Weight  
from openquery (bkl400, 
'select 
TRFBCH as TransferBatchNumber,
TRFFLC as FromStoreorWarehouse,
TRFTLC as ToStoreorWarehouse,
INUMBR as SkuNumber,
ASNUM as VendorNumber,
IDEPT as Dept,
ISDEPT as SubDept,
ICLAS as Class,
ISCLAS as SubClass,
TRFREQ as QtyRequest,
TRFSHP as QtyShipped,
TRFREC as QtyReceive,
TRFALC as QtyAllocate,
TRFSUB as SubstituteNumber,
TRFSCD as SubstituteCode,
TRFRLC as ReceivedWarehouseLocation,
TRFCST as UnitCost,
TRFRIN as RetailIn,
TRFROU as RetailOut,
ICUBE as Cube,
IVNDP# as VendorsPartNumber,
TRFSTS as TransferStatusOpt,
TRFTYP as TransferType,
TRFPTY as TransferPriorityOpt,
TDCYCL as WarehouseCycleNumber,
TDSCWV as ScheduleWaveNumber,
TDSCSQ as ScheduleWaveSequence,
TDSCNM as ScheduleName,
TRSVND as StyleVendor,
TRSTYL as StyleNumber,
TRSCOL as ColorCode,
TRSSIZ as SizeCode,
TRSDIM as DimensionCode,
TRFDSP as TransferDiscrepancyFlag,
TDSCQT as CartonShipQty,
TDRCQT as CartonReceiveQty,
TDWGHT as Weight 
from MM4R4LIB.TRFDTL')

create table INVBAL (
SkuNumber int,
Store int,
OnhandBOY int,
OnhandBOP int,
Onhand int,
Turns DECIMAL(4,1),
GMROI DECIMAL(4,1),
CurrentWkls int,
WeeklySales01 int,
WeeklySales02 int,
WeeklySales03 int,
WeeklySales04 int,
WeeklySales05 int,
WeeklySales06 int,
WeeklySales07 int,
WeeklySales08 int,
NumberOrdersYTD int,
LeaddaysYTD int,
RegSlsUnitsPTD int,
RegSlsUnitsYTD int,
RegSlsAmtPTD DECIMAL	(11,2),
RegSlsAmtYTD DECIMAL	(11,2),
RegSlsVATAmtPTD DECIMAL	(11,2),
RegSlsVATAmtYTD DECIMAL	(11,2),
RegCstAmtPTD DECIMAL	(11,2),
RegCstAmtYTD DECIMAL	(11,2),
AdSlsUnitsPTD int,
AdSlsUnitsYTD int,
AdSlsAmtPTD DECIMAL	(9,2),
AdSlsAmtYTD DECIMAL	(9,2),
AdSlsVATAmtPTD DECIMAL	(9,2),
AdSlsVATAmtYTD DECIMAL	(9,2),
AdCstAmtPTD DECIMAL	(9,2),
AdCstAmtYTD DECIMAL	(9,2),
RetSlsUnitsYTD int,
ReceiptUnitsPTD int,
ReceiptUnitsYTD int,
ReceiptAmtPTD DECIMAL	(11,2),
ReceiptAmtYTD DECIMAL	(11,2),
TrninUnitsPTD int,
TrninUnitsYTD int,
TrnoutUnitsPTD int,
TrnoutUnitsYTD int,
TrnsfrsAmtPTD DECIMAL (11,2),
TrnsfrsAmtYTD DECIMAL (11,2),
RTVUnitsPTD int,
RTVUnitsYTD int,
RTVAmtPTD DECIMAL (9,2),
RTVAmtYTD DECIMAL (9,2),
AdjUnitsPTD int,
AdjUnitsYTD int,
AdjAmtPTD DECIMAL (9,2),
AdjAmtYTD DECIMAL (9,2),
PhyAdjUnitsPTD int,
PhyAdjUnitsYTD int,
PhyAdjAmtPTD DECIMAL (9,2),
PhyAdjAmtYTD DECIMAL (9,2),
DateLastOrderedCenturyCode int,
DateLastOrdered date,
DateLastRecCenturyCode int,
DateLastReceived date,
DateLastAdjCenturyCode int,
DateLastAdjusted date,
DateLastSoldCenturyCode int,
DateLastSold date,
DateOutStockCenturyCode int,
DateOutStock date,
AverageCost DECIMAL	(11,4),
QtyLastReceived int,
AvgOHatWkEnd DECIMAL (9,2),
AvgUnitRtlWkend DECIMAL	(9,2),
AvgUnitCostWkend DECIMAL (11,3),
CurrWkOutOfStock CHAR(1) NULL,
Week01OutofStock CHAR(1) NULL,
Week02OutofStock CHAR(1) NULL,
Week03OutofStock CHAR(1) NULL,
Week04OutofStock CHAR(1) NULL,
Week05OutofStock CHAR(1) NULL,
Week06OutofStock CHAR(1) NULL,
Week07OutofStock CHAR(1) NULL,
Week08OutofStock CHAR(1) NULL,
Department DECIMAL (3,0),
SubDepartment DECIMAL (3,0),
Class DECIMAL (3,0),
SubClass DECIMAL (3,0),
DateFirstRecCenturyCode int,
DateFirstReceived date,
VendorNumber int,
StyleNumber CHAR(15) NULL,
POOnOrderQty int,
TrfOnOrderQty int,
InTransitQty int,
MovingAnnualSalesUnit int,
MovingAnnualSalesRtl DECIMAL (11,2),
MovingAnnualSalesVAT DECIMAL (11,2),
MovingAnnualSalesCost DECIMAL (11,2),
LandedAverageCost DECIMAL (11,4),
AllocateReserveQuantity int,
NonSellableInventoryQty	int
)

insert into INVBAL (
SkuNumber,
Store,
OnhandBOY,
OnhandBOP,
Onhand,
Turns,
GMROI,
CurrentWkls,
WeeklySales01,
WeeklySales02,
WeeklySales03,
WeeklySales04,
WeeklySales05,
WeeklySales06,
WeeklySales07,
WeeklySales08,
NumberOrdersYTD,
LeaddaysYTD,
RegSlsUnitsPTD,
RegSlsUnitsYTD,
RegSlsAmtPTD,
RegSlsAmtYTD,
RegSlsVATAmtPTD,
RegSlsVATAmtYTD,
RegCstAmtPTD,
RegCstAmtYTD,
AdSlsUnitsPTD,
AdSlsUnitsYTD,
AdSlsAmtPTD,
AdSlsAmtYTD,
AdSlsVATAmtPTD,
AdSlsVATAmtYTD,
AdCstAmtPTD,
AdCstAmtYTD,
RetSlsUnitsYTD,
ReceiptUnitsPTD,
ReceiptUnitsYTD,
ReceiptAmtPTD,
ReceiptAmtYTD,
TrninUnitsPTD,
TrninUnitsYTD,
TrnoutUnitsPTD,
TrnoutUnitsYTD,
TrnsfrsAmtPTD,
TrnsfrsAmtYTD,
RTVUnitsPTD,
RTVUnitsYTD,
RTVAmtPTD,
RTVAmtYTD,
AdjUnitsPTD,
AdjUnitsYTD,
AdjAmtPTD,
AdjAmtYTD,
PhyAdjUnitsPTD,
PhyAdjUnitsYTD,
PhyAdjAmtPTD,
PhyAdjAmtYTD,
DateLastOrderedCenturyCode,
DateLastOrdered,
DateLastRecCenturyCode,
DateLastReceived,
DateLastAdjCenturyCode,
DateLastAdjusted,
DateLastSoldCenturyCode,
DateLastSold,
DateOutStockCenturyCode,
DateOutStock,
AverageCost,
QtyLastReceived,
AvgOHatWkEnd,
AvgUnitRtlWkend,
AvgUnitCostWkend,
CurrWkOutOfStock,
Week01OutofStock,
Week02OutofStock,
Week03OutofStock,
Week04OutofStock,
Week05OutofStock,
Week06OutofStock,
Week07OutofStock,
Week08OutofStock,
Department,
SubDepartment,
Class,
SubClass,
DateFirstRecCenturyCode,
DateFirstReceived,
VendorNumber,
StyleNumber,
POOnOrderQty,
TrfOnOrderQty,
InTransitQty,
MovingAnnualSalesUnit,
MovingAnnualSalesRtl,
MovingAnnualSalesVAT,
MovingAnnualSalesCost,
LandedAverageCost,
AllocateReserveQuantity,
NonSellableInventoryQty 
)

select TOP 10 
SkuNumber,
Store,
OnhandBOY,
OnhandBOP,
Onhand,
Turns,
GMROI,
CurrentWkls,
WeeklySales01,
WeeklySales02,
WeeklySales03,
WeeklySales04,
WeeklySales05,
WeeklySales06,
WeeklySales07,
WeeklySales08,
NumberOrdersYTD,
LeaddaysYTD,
RegSlsUnitsPTD,
RegSlsUnitsYTD,
RegSlsAmtPTD,
RegSlsAmtYTD,
RegSlsVATAmtPTD,
RegSlsVATAmtYTD,
RegCstAmtPTD,
RegCstAmtYTD,
AdSlsUnitsPTD,
AdSlsUnitsYTD,
AdSlsAmtPTD,
AdSlsAmtYTD,
AdSlsVATAmtPTD,
AdSlsVATAmtYTD,
AdCstAmtPTD,
AdCstAmtYTD,
RetSlsUnitsYTD,
ReceiptUnitsPTD,
ReceiptUnitsYTD,
ReceiptAmtPTD,
ReceiptAmtYTD,
TrninUnitsPTD,
TrninUnitsYTD,
TrnoutUnitsPTD,
TrnoutUnitsYTD,
TrnsfrsAmtPTD,
TrnsfrsAmtYTD,
RTVUnitsPTD,
RTVUnitsYTD,
RTVAmtPTD,
RTVAmtYTD,
AdjUnitsPTD,
AdjUnitsYTD,
AdjAmtPTD,
AdjAmtYTD,
PhyAdjUnitsPTD,
PhyAdjUnitsYTD,
PhyAdjAmtPTD,
PhyAdjAmtYTD,
DateLastOrderedCenturyCode,
DateLastOrdered,
DateLastRecCenturyCode,
DateLastReceived,
DateLastAdjCenturyCode,
DateLastAdjusted,
DateLastSoldCenturyCode,
DateLastSold,
DateOutStockCenturyCode,
DateOutStock,
AverageCost,
QtyLastReceived,
AvgOHatWkEnd,
AvgUnitRtlWkend,
AvgUnitCostWkend,
CurrWkOutOfStock,
Week01OutofStock,
Week02OutofStock,
Week03OutofStock,
Week04OutofStock,
Week05OutofStock,
Week06OutofStock,
Week07OutofStock,
Week08OutofStock,
Department,
SubDepartment,
Class,
SubClass,
DateFirstRecCenturyCode,
DateFirstReceived,
VendorNumber,
StyleNumber,
POOnOrderQty,
TrfOnOrderQty,
InTransitQty,
MovingAnnualSalesUnit,
MovingAnnualSalesRtl,
MovingAnnualSalesVAT,
MovingAnnualSalesCost,
LandedAverageCost,
AllocateReserveQuantity,
NonSellableInventoryQty 
from openquery (bkl400, 
'select 
INUMBR as SkuNumber,
ISTORE as Store,
IBHBOY as OnhandBOY,
IBHBOP as OnhandBOP,
IBHAND as Onhand,
IBTRNS as Turns,
IBGMRI as GMROI,
IBWKCR as CurrentWkls,
IBWK01 as WeeklySales01,
IBWK02 as WeeklySales02,
IBWK03 as WeeklySales03,
IBWK04 as WeeklySales04,
IBWK05 as WeeklySales05,
IBWK06 as WeeklySales06,
IBWK07 as WeeklySales07,
IBWK08 as WeeklySales08,
IB#ORD as NumberOrdersYTD,
IBLEAD as LeaddaysYTD,
IBRSUP as RegSlsUnitsPTD,
IBRSUY as RegSlsUnitsYTD,
IBRSDP as RegSlsAmtPTD,
IBRSDY as RegSlsAmtYTD,
IBVRSP as RegSlsVATAmtPTD,
IBVRSY as RegSlsVATAmtYTD,
IBRCSP as RegCstAmtPTD,
IBRCSY as RegCstAmtYTD,
IBASUP as AdSlsUnitsPTD,
IBASUY as AdSlsUnitsYTD,
IBASDP as AdSlsAmtPTD,
IBASDY as AdSlsAmtYTD,
IBVASP as AdSlsVATAmtPTD,
IBVASY as AdSlsVATAmtYTD,
IBACSP as AdCstAmtPTD,
IBACSY as AdCstAmtYTD,
IBRETS as RetSlsUnitsYTD,
IBRCUP as ReceiptUnitsPTD,
IBRCUY as ReceiptUnitsYTD,
IBRCDP as ReceiptAmtPTD,
IBRCDY as ReceiptAmtYTD,
IBTIUP as TrninUnitsPTD,
IBTIUY as TrninUnitsYTD,
IBTOUP as TrnoutUnitsPTD,
IBTOUY as TrnoutUnitsYTD,
IBTFDP as TrnsfrsAmtPTD,
IBTFDY as TrnsfrsAmtYTD,
IBRVUP as RTVUnitsPTD,
IBRVUY as RTVUnitsYTD,
IBRVDP as RTVAmtPTD,
IBRVDY as RTVAmtYTD,
IBAJUP as AdjUnitsPTD,
IBAJUY as AdjUnitsYTD,
IBAJDP as AdjAmtPTD,
IBAJDY as AdjAmtYTD,
IBPHUP as PhyAdjUnitsPTD,
IBPHUY as PhyAdjUnitsYTD,
IBPHDP as PhyAdjAmtPTD,
IBPHDY as PhyAdjAmtYTD,
IBCEN1 as DateLastOrderedCenturyCode,
case IBCEN1 
when 0 then date(timestamp_format(char(IBALD1+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBALD1,6,0)),''YYMMDD'') end as DateLastOrdered,
IBCEN2 as DateLastRecCenturyCode,
case IBCEN2 
when 0 then date(timestamp_format(char(IBALD2+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBALD2,6,0)),''YYMMDD'') end as DateLastReceived,
IBCEN3 as DateLastAdjCenturyCode,
case IBCEN3 
when 0 then date(timestamp_format(char(IBALD3+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBALD3,6,0)),''YYMMDD'') end as DateLastAdjusted,
IBCEN4 as DateLastSoldCenturyCode,
case IBCEN4 
when 0 then date(timestamp_format(char(IBALD4+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBALD4,6,0)),''YYMMDD'') end as DateLastSold,
IBCEN5 as DateOutStockCenturyCode,
case IBCEN5 
when 0 then date(timestamp_format(char(IBALD5+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBALD5,6,0)),''YYMMDD'') end as DateOutStock,
IBAVGC as AverageCost,
IBQLRC as QtyLastReceived,
IBAVOH as AvgOHatWkEnd,
IBAVRT as AvgUnitRtlWkend,
IBAVCS as AvgUnitCostWkend,
IBOSCR as CurrWkOutOfStock,
IBOS01 as Week01OutofStock,
IBOS02 as Week02OutofStock,
IBOS03 as Week03OutofStock,
IBOS04 as Week04OutofStock,
IBOS05 as Week05OutofStock,
IBOS06 as Week06OutofStock,
IBOS07 as Week07OutofStock,
IBOS08 as Week08OutofStock,
IBDEPT as Department,
IBSDPT as SubDepartment,
IBCLAS as Class,
IBSCLS as SubClass,
IBFRCN as DateFirstRecCenturyCode,
case IBFRCN 
when 0 then date(timestamp_format(char(IBFRDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(IBFRDT,6,0)),''YYMMDD'') end as DateFirstReceived,
IBVNDR as VendorNumber,
IBSTYL as StyleNumber,
IBPOOQ as POOnOrderQty,
IBTOOQ as TrfOnOrderQty,
IBINTQ as InTransitQty,
IBMASU as MovingAnnualSalesUnit,
IBMASD as MovingAnnualSalesRtl,
IBMASV as MovingAnnualSalesVAT,
IBMASC as MovingAnnualSalesCost,
IBLAVC as LandedAverageCost,
IBARQT as AllocateReserveQuantity,
IBNSQT as NonSellableInventoryQty 
from MM4R4LIB.INVBAL')

create table INVCBL (
SkuNumber int,
OnhandBOY int,
OnhandBOP int,
Onhand int,
Turns DECIMAL	(4,1),
GMROI DECIMAL	(4,1),
CurrentWkSls int,
WeeklySales01 int,
WeeklySales02 int,
WeeklySales03 int,
WeeklySales04 int,
WeeklySales05 int,
WeeklySales06 int,
WeeklySales07 int,
WeeklySales08 int,
RegSlsUnitsPTD int,
RegSlsUnitsYTD int,
RegSlsAmtPTD DECIMAL	(11,2),
RegSlsAmtYTD DECIMAL	(11,2),
RegSlsVATAmtPTD DECIMAL	(11,2),
RegSlsVATAmtYTD DECIMAL	(11,2),
RegCstAmtTD DECIMAL	(11,2),
RegCstAmtYTD DECIMAL	(11,2),
AdSlsUnitsPTD int,
AdSlsUnitsYTD int,
AdSlsAmtPTD DECIMAL	(11,2),
AdSlsAmtYTD DECIMAL	(11,2),
AdSlsVATAmtPTD DECIMAL	(11,2),
AdSlsVATAmtYTD DECIMAL	(11,2),
AdCstAmtPTD DECIMAL	(11,2),
AdCstAmtYTD DECIMAL	(11,2),
RetSlsUnitsYTD int,
ReceiptUnitsPTD int,
ReceiptUnitsYTD int,
ReceiptAmtPTD DECIMAL	(11,2),
ReceiptAmtYTD DECIMAL	(11,2),
TrninUnitsPTD int,
TrninUnitsYTD int,
TrnoutUnitsPTD int,
TrnoutUnitsYTD int,
TrnsfrsAmtPTD DECIMAL	(11,2),
TrnsfrsAmtYTD DECIMAL	(11,2),
RTVUnitsPTD int,
RTVUnitsYTD int,
RTVAmtPTD DECIMAL	(11,2),
RTVAmtYTD DECIMAL	(11,2),
AdjUnitsPTD int,
AdjUnitsYTD int,
AdjAmtPTD DECIMAL	(11,2),
AdjAmtYTD DECIMAL	(11,2),
PhyAdjUnitsPTD int,
PhyAdjUnitsYTD int,
PhyAdjAmtPTD DECIMAL	(11,2),
PhyAdjAmtYTD DECIMAL	(11,2),
AverageUnitCost DECIMAL	(11,4),
AvgInvOH int,
AvgInvRtl DECIMAL	(11,2),
AvgInvCost DECIMAL	(11,3),
Department int,
SubDepartment 	int,
Class int,
SubClass int,
VendorNumber int,
StyleNumber CHAR (15) NULL,
POOnOrderQty int,
TrfOnOrderQty int,
InTransitQty int,
MovingAnnualSalesUnit int,
MovingAnnualSalesRtl DECIMAL (11,2),
MovingAnnualSalesVAT DECIMAL (11,2),
MovingAnnualSalesCost DECIMAL (11,2),
LandedAverageCost DECIMAL	(11,4),
AllocateReserveQuantity int,
NonSellableInventoryQty int
)

insert into INVCBL (
SkuNumber,
OnhandBOY,
OnhandBOP,
Onhand,
Turns,
GMROI,
CurrentWkSls,
WeeklySales01,
WeeklySales02,
WeeklySales03,
WeeklySales04,
WeeklySales05,
WeeklySales06,
WeeklySales07,
WeeklySales08,
RegSlsUnitsPTD,
RegSlsUnitsYTD,
RegSlsAmtPTD,
RegSlsAmtYTD,
RegSlsVATAmtPTD,
RegSlsVATAmtYTD,
RegCstAmtTD,
RegCstAmtYTD,
AdSlsUnitsPTD,
AdSlsUnitsYTD,
AdSlsAmtPTD,
AdSlsAmtYTD,
AdSlsVATAmtPTD,
AdSlsVATAmtYTD,
AdCstAmtPTD,
AdCstAmtYTD,
RetSlsUnitsYTD,
ReceiptUnitsPTD,
ReceiptUnitsYTD,
ReceiptAmtPTD,
ReceiptAmtYTD,
TrninUnitsPTD,
TrninUnitsYTD,
TrnoutUnitsPTD,
TrnoutUnitsYTD,
TrnsfrsAmtPTD,
TrnsfrsAmtYTD,
RTVUnitsPTD,
RTVUnitsYTD,
RTVAmtPTD,
RTVAmtYTD,
AdjUnitsPTD,
AdjUnitsYTD,
AdjAmtPTD,
AdjAmtYTD,
PhyAdjUnitsPTD,
PhyAdjUnitsYTD,
PhyAdjAmtPTD,
PhyAdjAmtYTD,
AverageUnitCost,
AvgInvOH,
AvgInvRtl,
AvgInvCost,
Department,
SubDepartment,
Class,
SubClass,
VendorNumber,
StyleNumber,
POOnOrderQty,
TrfOnOrderQty,
InTransitQty,
MovingAnnualSalesUnit,
MovingAnnualSalesRtl,
MovingAnnualSalesVAT,
MovingAnnualSalesCost,
LandedAverageCost,
AllocateReserveQuantity,
NonSellableInventoryQty 
)
select TOP 10
SkuNumber,
OnhandBOY,
OnhandBOP,
Onhand,
Turns,
GMROI,
CurrentWkSls,
WeeklySales01,
WeeklySales02,
WeeklySales03,
WeeklySales04,
WeeklySales05,
WeeklySales06,
WeeklySales07,
WeeklySales08,
RegSlsUnitsPTD,
RegSlsUnitsYTD,
RegSlsAmtPTD,
RegSlsAmtYTD,
RegSlsVATAmtPTD,
RegSlsVATAmtYTD,
RegCstAmtTD,
RegCstAmtYTD,
AdSlsUnitsPTD,
AdSlsUnitsYTD,
AdSlsAmtPTD,
AdSlsAmtYTD,
AdSlsVATAmtPTD,
AdSlsVATAmtYTD,
AdCstAmtPTD,
AdCstAmtYTD,
RetSlsUnitsYTD,
ReceiptUnitsPTD,
ReceiptUnitsYTD,
ReceiptAmtPTD,
ReceiptAmtYTD,
TrninUnitsPTD,
TrninUnitsYTD,
TrnoutUnitsPTD,
TrnoutUnitsYTD,
TrnsfrsAmtPTD,
TrnsfrsAmtYTD,
RTVUnitsPTD,
RTVUnitsYTD,
RTVAmtPTD,
RTVAmtYTD,
AdjUnitsPTD,
AdjUnitsYTD,
AdjAmtPTD,
AdjAmtYTD,
PhyAdjUnitsPTD,
PhyAdjUnitsYTD,
PhyAdjAmtPTD,
PhyAdjAmtYTD,
AverageUnitCost,
AvgInvOH,
AvgInvRtl,
AvgInvCost,
Department,
SubDepartment,
Class,
SubClass,
VendorNumber,
StyleNumber,
POOnOrderQty,
TrfOnOrderQty,
InTransitQty,
MovingAnnualSalesUnit,
MovingAnnualSalesRtl,
MovingAnnualSalesVAT,
MovingAnnualSalesCost,
LandedAverageCost,
AllocateReserveQuantity,
NonSellableInventoryQty 
from openquery (bkl400, 
'select 
INUMBR as SkuNumber,
CBHBOY as OnhandBOY,
CBHBOP as OnhandBOP,
CBHAND as Onhand,
CBTRNS as Turns,
CBGMRI as GMROI,
CBWKCR as CurrentWkSls,
CBWK01 as WeeklySales01,
CBWK02 as WeeklySales02,
CBWK03 as WeeklySales03,
CBWK04 as WeeklySales04,
CBWK05 as WeeklySales05,
CBWK06 as WeeklySales06,
CBWK07 as WeeklySales07,
CBWK08 as WeeklySales08,
CBRSUP as RegSlsUnitsPTD,
CBRSUY as RegSlsUnitsYTD,
CBRSDP as RegSlsAmtPTD,
CBRSDY as RegSlsAmtYTD,
CBVRSP as RegSlsVATAmtPTD,
CBVRSY as RegSlsVATAmtYTD,
CBRCSP as RegCstAmtTD,
CBRCSY as RegCstAmtYTD,
CBASUP as AdSlsUnitsPTD,
CBASUY as AdSlsUnitsYTD,
CBASDP as AdSlsAmtPTD,
CBASDY as AdSlsAmtYTD,
CBVASP as AdSlsVATAmtPTD,
CBVASY as AdSlsVATAmtYTD,
CBACSP as AdCstAmtPTD,
CBACSY as AdCstAmtYTD,
CBRETS as RetSlsUnitsYTD,
CBRCUP as ReceiptUnitsPTD,
CBRCUY as ReceiptUnitsYTD,
CBRCDP as ReceiptAmtPTD,
CBRCDY as ReceiptAmtYTD,
CBTIUP as TrninUnitsPTD,
CBTIUY as TrninUnitsYTD,
CBTOUP as TrnoutUnitsPTD,
CBTOUY as TrnoutUnitsYTD,
CBTFDP as TrnsfrsAmtPTD,
CBTFDY as TrnsfrsAmtYTD,
CBRVUP as RTVUnitsPTD,
CBRVUY as RTVUnitsYTD,
CBRVDP as RTVAmtPTD,
CBRVDY as RTVAmtYTD,
CBAJUP as AdjUnitsPTD,
CBAJUY as AdjUnitsYTD,
CBAJDP as AdjAmtPTD,
CBAJDY as AdjAmtYTD,
CBPHUP as PhyAdjUnitsPTD,
CBPHUY as PhyAdjUnitsYTD,
CBPHDP as PhyAdjAmtPTD,
CBPHDY as PhyAdjAmtYTD,
CBAVGC as AverageUnitCost,
CBAVOH as AvgInvOH,
CBAVRT as AvgInvRtl,
CBAVCS as AvgInvCost,
CBDEPT as Department,
CBSDPT as SubDepartment,
CBCLAS as Class,
CBSCLS as SubClass,
CBVNDR as VendorNumber,
CBSTYL as StyleNumber,
CBPOOQ as POOnOrderQty,
CBTOOQ as TrfOnOrderQty,
CBINTQ as InTransitQty,
CBMASU as MovingAnnualSalesUnit,
CBMASD as MovingAnnualSalesRtl,
CBMASV as MovingAnnualSalesVAT,
CBMASC as MovingAnnualSalesCost,
CBLAVC as LandedAverageCost,
CBARQT as AllocateReserveQuantity,
CBNSQT as NonSellableInventoryQty 
from MM4R4LIB.INVCBL')

create table INVMST (
SkuNumber 	int,
CheckDigit 	int,
ItemDescription 	varchar(30),
StatusCode 	varchar(1),
ShortDescription 	varchar(10),
StyleNumber 	varchar(15),
VendorNumber 	int,
VendorsNumber 	varchar(15),
ManufNumber 	int,
ManufsNumber 	varchar(15),
Department 	int,
SubDepartment 	int,
Class 	int,
SubClass 	int,
Buyer 	varchar(3),
AdSpace 	int,
MercuryDistro 	varchar(1),
BuyCodeCS 	varchar(1),
SetCode 	varchar(1),
MultVendorInd 	varchar(1),
PricePrompt 	varchar(1),
ExcldPOSdwnld 	varchar(1),
TicketTypeReg 	varchar(1),
TicketTypeAd 	varchar(1),
NoTicketsItem 	int,
LabelTypeReg 	varchar(1),
LabelTypeAd 	varchar(1),
MerchGrpNumber 	varchar(5),
ProfileNumber 	varchar(5),
ModuleNumber 	varchar(5),
SkuType 	varchar(2),
ColorCode 	int,
Size 	varchar(4),
HazardousCode 	varchar(2),
Merchandiser 	varchar(3),
SubstituteSKU 	int,
CoreSKU 	int,
ReplacementSKU 	int,
SellingUM 	varchar(3),
SellBuyConFct 	DECIMAL	(10,5),
BuyUM 	varchar(3),
InnerPack 	int,
CasePack 	int,
HoldOrder 	varchar(1),
MinOrderQty 	int,
Orderat 	int,
MaximumAnytime 	int,
ModelStock 	int,
MinDisplayQty 	int,
StockinMult 	int,
ReplenishmentCode 	varchar(1),
ManufList 	 DECIMAL	(9,2),
HomeCost 	 DECIMAL	(9,3),
LastVendorCost 	 DECIMAL	(9,3),
LastCostDate 	date,
LastCostCentury 	int,
NextVendorCost 	 DECIMAL	(9,3),
NextCostDate 	date,
NextCostCentury 	int,
Weight 	 DECIMAL	(7,3),
Cube 	 DECIMAL	(9,3),
Length 	 DECIMAL	(5,1),
Width 	 DECIMAL	(5,1),
Height 	 DECIMAL	(5,1),
DateLastMaint 	date,
CenturyLastMaint 	int,
VndrPalletTiQty 	int,
VndrPalletHiQty 	int,
ShipPointNumber 	int,
DistributionMethod 	varchar(1),
HoldWholesaleOrder 	varchar(1),
InventoryGroup 	int,
Dimension 	varchar(4),
fieldnotused 	varchar(2),
VendorCost 	 DECIMAL	(9,3),
FiveSignedNumericZeroDec 	int,
VelocityRankCode1 	varchar(1),
VelocityRankCode2 	varchar(1),
VelocityRankCode3 	varchar(1),
VelocityRankCode4 	varchar(1),
ReplenStartCent 	int,
ReplenStartDate 	date,
SeasonCode 	varchar(3),
CenturyDeadDate 	int,
DeadDate 	date,
InitialRetail 	 DECIMAL	(9,2),
InitialHomeCost 	 DECIMAL	(9,3),
HandlingCode 	varchar(1),
Attribute1 	varchar(2),
Attribute2 	varchar(2),
Attribute3 	varchar(2),
Attribute4 	varchar(2),
Attribute5 	varchar(2),
ChainPrice 	varchar(1),
ZonePrice 	varchar(1),
StorePrice 	varchar(1),
StyleVendor 	int,
CoordinateGroupNumber 	varchar(5),
SKULeadTime 	int
)

insert into INVMST (
SkuNumber,
CheckDigit,
ItemDescription,
StatusCode,
ShortDescription,
StyleNumber,
VendorNumber,
VendorsNumber,
ManufNumber,
ManufsNumber,
Department,
SubDepartment,
Class,
SubClass,
Buyer,
AdSpace,
MercuryDistro,
BuyCodeCS,
SetCode,
MultVendorInd,
PricePrompt,
ExcldPOSdwnld,
TicketTypeReg,
TicketTypeAd,
NoTicketsItem,
LabelTypeReg,
LabelTypeAd,
MerchGrpNumber,
ProfileNumber,
ModuleNumber,
SkuType,
ColorCode,
Size,
HazardousCode,
Merchandiser,
SubstituteSKU,
CoreSKU,
ReplacementSKU,
SellingUM,
SellBuyConFct,
BuyUM,
InnerPack,
CasePack,
HoldOrder,
MinOrderQty,
Orderat,
MaximumAnytime,
ModelStock,
MinDisplayQty,
StockinMult,
ReplenishmentCode,
ManufList,
HomeCost,
LastVendorCost,
LastCostDate,
LastCostCentury,
NextVendorCost,
NextCostDate,
NextCostCentury,
Weight,
Cube,
Length,
Width,
Height,
DateLastMaint,
CenturyLastMaint,
VndrPalletTiQty,
VndrPalletHiQty,
ShipPointNumber,
DistributionMethod,
HoldWholesaleOrder,
InventoryGroup,
Dimension,
fieldnotused,
VendorCost,
FiveSignedNumericZeroDec,
VelocityRankCode1,
VelocityRankCode2,
VelocityRankCode3,
VelocityRankCode4,
ReplenStartCent,
ReplenStartDate,
SeasonCode,
CenturyDeadDate,
DeadDate,
InitialRetail,
InitialHomeCost,
HandlingCode,
Attribute1,
Attribute2,
Attribute3,
Attribute4,
Attribute5,
ChainPrice,
ZonePrice,
StorePrice,
StyleVendor,
CoordinateGroupNumber,
SKULeadTime 
)

select TOP 10 
SkuNumber,
CheckDigit,
ItemDescription,
StatusCode,
ShortDescription,
StyleNumber,
VendorNumber,
VendorsNumber,
ManufNumber,
ManufsNumber,
Department,
SubDepartment,
Class,
SubClass,
Buyer,
AdSpace,
MercuryDistro,
BuyCodeCS,
SetCode,
MultVendorInd,
PricePrompt,
ExcldPOSdwnld,
TicketTypeReg,
TicketTypeAd,
NoTicketsItem,
LabelTypeReg,
LabelTypeAd,
MerchGrpNumber,
ProfileNumber,
ModuleNumber,
SkuType,
ColorCode,
Size,
HazardousCode,
Merchandiser,
SubstituteSKU,
CoreSKU,
ReplacementSKU,
SellingUM,
SellBuyConFct,
BuyUM,
InnerPack,
CasePack,
HoldOrder,
MinOrderQty,
Orderat,
MaximumAnytime,
ModelStock,
MinDisplayQty,
StockinMult,
ReplenishmentCode,
ManufList,
HomeCost,
LastVendorCost,
LastCostDate,
LastCostCentury,
NextVendorCost,
NextCostDate,
NextCostCentury,
Weight,
Cube,
Length,
Width,
Height,
DateLastMaint,
CenturyLastMaint,
VndrPalletTiQty,
VndrPalletHiQty,
ShipPointNumber,
DistributionMethod,
HoldWholesaleOrder,
InventoryGroup,
Dimension,
fieldnotused,
VendorCost,
FiveSignedNumericZeroDec,
VelocityRankCode1,
VelocityRankCode2,
VelocityRankCode3,
VelocityRankCode4,
ReplenStartCent,
ReplenStartDate,
SeasonCode,
CenturyDeadDate,
DeadDate,
InitialRetail,
InitialHomeCost,
HandlingCode,
Attribute1,
Attribute2,
Attribute3,
Attribute4,
Attribute5,
ChainPrice,
ZonePrice,
StorePrice,
StyleVendor,
CoordinateGroupNumber,
SKULeadTime 
from openquery (bkl400, 
'select 
INUMBR as SkuNumber,
ICHECK as CheckDigit,
IDESCR as ItemDescription,
IDSCCD as StatusCode,
ISORT  as ShortDescription,
ISTYL# as StyleNumber,
ASNUM  as VendorNumber,
IVNDP# as VendorsNumber,
IMFGR  as ManufNumber,
IMFGNO as ManufsNumber,
IDEPT  as Department,
ISDEPT as SubDepartment,
ICLAS  as Class,
ISCLAS as SubClass,
BYRNUM as Buyer,
IASPAC as AdSpace,
IADVYN as MercuryDistro,
IBUYCD as BuyCodeCS,
ISET   as SetCode,
IWARNT as MultVendorInd,
IPRMPT as PricePrompt,
IPRVNT as ExcldPOSdwnld,
ITKTTR as TicketTypeReg,
ITKTTA as TicketTypeAd,
ITKT#  as NoTicketsItem,
ILBLTR as LabelTypeReg,
ILBLTA as LabelTypeAd,
IFINLN as MerchGrpNumber,
IPROFL as ProfileNumber,
IMODUL as ModuleNumber,
ISTYPE as SkuType,
ISCOLR as ColorCode,
ISSIZE as Size,
IHAZCD as HazardousCode,
MCHNUM as Merchandiser,
ISUBST as SubstituteSKU,
ICORE  as CoreSKU,
IREPL  as ReplacementSKU,
ISLUM  as SellingUM,
IUMCV2 as SellBuyConFct,
IBYUM  as BuyUM,
IMINPK as InnerPack,
ISTDPK as CasePack,
IHLDOR as HoldOrder,
IMOQTY as MinOrderQty,
IMNSTK as Orderat,
IMXSTK as MaximumAnytime,
IMDSTK as ModelStock,
IDSPLY as MinDisplayQty,
IOMULT as StockinMult,
IRPLCD as ReplenishmentCode,
IMFPRC as ManufList,
ICUCST as HomeCost,
ILSCST as LastVendorCost,
case ILSCCN 
when 0 then varchar_format(timestamp_format(char(ILSCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(ILSCDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastCostDate,
ILSCCN as LastCostCentury,
INXCST as NextVendorCost,
case INXCCN 
when 0 then varchar_format(timestamp_format(char(INXCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(INXCDT,6,0)),''YYMMDD''),''YYMMDD'') end as NextCostDate,
INXCCN as NextCostCentury,
IWGHT  as Weight,
ICUBE  as Cube,
IDLGTH as Length,
IDWDTH as Width,
IDHGHT as Height,
case IMCENT 
when 0 then varchar_format(timestamp_format(char(IMDATE+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IMDATE,6,0)),''YYMMDD''),''YYMMDD'') end as DateLastMaint,
IMCENT as CenturyLastMaint, 
IVPLTI as VndrPalletTiQty,
IVPLHI as VndrPalletHiQty,
SHPNUM as ShipPointNumber,
IDISTM as DistributionMethod,
IHLDWO as HoldWholesaleOrder,
IIGNUM as InventoryGroup,
ISDIM  as Dimension,
IVATCD as fieldnotused,
IFCCST as VendorCost,
IPLAN  as FiveSignedNumericZeroDec,
IVLRK1 as VelocityRankCode1,
IVLRK2 as VelocityRankCode2,
IVLRK3 as VelocityRankCode3,
IVLRK4 as VelocityRankCode4,
IRPLCN as ReplenStartCent,
case IRPLCN 
when 0 then varchar_format(timestamp_format(char(IRPLDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IRPLDT,6,0)),''YYMMDD''),''YYMMDD'') end as ReplenStartDate,
ISEASN as SeasonCode,
IDEADC as CenturyDeadDate,
case IDEADC 
when 0 then varchar_format(timestamp_format(char(IDEADD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IDEADD,6,0)),''YYMMDD''),''YYMMDD'') end as DeadDate,
INLRTL as InitialRetail,
INLCST as InitialHomeCost,
IHANDL as HandlingCode,
IATRB1 as Attribute1,
IATRB2 as Attribute2,
IATRB3 as Attribute3,
IATRB4 as Attribute4,
IATRB5 as Attribute5,
IPRCCH as ChainPrice,
IPRCZN as ZonePrice,
IPRCST as StorePrice,
IASNUM as StyleVendor,
ICORGP as CoordinateGroupNumber,
ILEAD  as SKULeadTime 
from MM4R4LIB.INVMST')

create table INVMSTE (
StyleVendor	int,
StyleNumber	varchar(15),
SkuNumber	int,
FirstActivityCentury	int,
FirstActivityDate	date,
BackStockPct	 DECIMAL	(5,2),
BackStockQty	int,
ChainOrder	int,
PublisherRunQty	int,
OutofPrintTitleFlag	varchar(1),
PrivateLabelFlag	varchar(1),
SellDownActivityCode	varchar(1),
ImportFlag	varchar(1),
Method	varchar(1),
MethodPercent	decimal(10,5),
PublisherCost	DECIMAL	(9,3),
PublisherCostPercent	decimal(10,5),
DWItemnumber	varchar(20),
Converteditem	varchar(1),
StatusChangeCentury	int,
StatusChangeDate	date,
TypeChangeCentury	int,
TypeChangeDate	date,
ItemEntryCentury	int,
ItemEntryDate	date,
GroupDist	int,
LimitAddGroup	varchar(1),
LOFLAG	varchar(1),
LOGRPOFGRPS	int,
LOSTORE	int,
InitialOrderQuantity	int,
ExpectedReceiptCentury	int,
ExpectdReceiptDate	date,
InitialAllocQuantity	int,
InitialStrength	varchar(2),
InitialStockto	int,
LastMaintainedby 	varchar(10)
)

insert into INVMSTE (
StyleVendor,
StyleNumber,
SkuNumber,
FirstActivityCentury,
FirstActivityDate,
BackStockPct,
BackStockQty,
ChainOrder,
PublisherRunQty,
OutofPrintTitleFlag,
PrivateLabelFlag,
SellDownActivityCode,
ImportFlag,
Method,
MethodPercent,
PublisherCost,
PublisherCostPercent,
DWItemnumber,
Converteditem,
StatusChangeCentury,
StatusChangeDate,
TypeChangeCentury,
TypeChangeDate,
ItemEntryCentury,
ItemEntryDate,
GroupDist,
LimitAddGroup,
LOFLAG,
LOGRPOFGRPS,
LOSTORE,
InitialOrderQuantity,
ExpectedReceiptCentury,
ExpectdReceiptDate,
InitialAllocQuantity,
InitialStrength,
InitialStockto,
LastMaintainedby 
)

select TOP 10 
StyleVendor,
StyleNumber,
SkuNumber,
FirstActivityCentury,
FirstActivityDate,
BackStockPct,
BackStockQty,
ChainOrder,
PublisherRunQty,
OutofPrintTitleFlag,
PrivateLabelFlag,
SellDownActivityCode,
ImportFlag,
Method,
MethodPercent,
PublisherCost,
PublisherCostPercent,
DWItemnumber,
Converteditem,
StatusChangeCentury,
StatusChangeDate,
TypeChangeCentury,
TypeChangeDate,
ItemEntryCentury,
ItemEntryDate,
GroupDist,
LimitAddGroup,
LOFLAG,
LOGRPOFGRPS,
LOSTORE,
InitialOrderQuantity,
ExpectedReceiptCentury,
ExpectdReceiptDate,
InitialAllocQuantity,
InitialStrength,
InitialStockto,
LastMaintainedby 
from openquery (bkl400, 
'select 
IASNUM AS StyleVendor,
ISTYL# AS StyleNumber,
INUMBR AS SkuNumber,
ICENT  AS FirstActivityCentury,
case ICENT 
when 0 then varchar_format(timestamp_format(char(IDATE+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IDATE,6,0)),''YYMMDD''),''YYMMDD'') end  AS FirstActivityDate,
IBSPCT AS BackStockPct,
IBSQTY AS BackStockQty,
ICHORD AS ChainOrder,
IPRQTY AS PublisherRunQty,
IOPFLG AS OutofPrintTitleFlag,
IPLFLG AS PrivateLabelFlag,
ISDCDE AS SellDownActivityCode,
IMPFLG AS ImportFlag,
IMTH   AS Method,
IMTHPC AS MethodPercent,
IPUBC  AS PublisherCost,
IPBPCT AS PublisherCostPercent,
ITMDW  AS DWItemnumber,
ITMCVT AS Converteditem,
ISTSCN AS StatusChangeCentury,
case ISTSCN 
when 0 then varchar_format(timestamp_format(char(ISTSDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(ISTSDT,6,0)),''YYMMDD''),''YYMMDD'') end AS StatusChangeDate,
ITYPCN AS TypeChangeCentury,
case ITYPCN 
when 0 then varchar_format(timestamp_format(char(ITYPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(ITYPDT,6,0)),''YYMMDD''),''YYMMDD'') end AS TypeChangeDate,
IENTCN AS ItemEntryCentury,
case IENTCN 
when 0 then varchar_format(timestamp_format(char(IENTDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IENTDT,6,0)),''YYMMDD''),''YYMMDD'') end AS ItemEntryDate,
IMGRUP AS GroupDist,
IMLTAD AS LimitAddGroup,
IMLOTP AS LOFLAG,
IMLOGG AS LOGRPOFGRPS,
IMLOST AS LOSTORE,
INLORD AS InitialOrderQuantity,
IEXRCN AS ExpectedReceiptCentury,
case IEXRCN 
when 0 then varchar_format(timestamp_format(char(IEXRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(IEXRDT,6,0)),''YYMMDD''),''YYMMDD'') end AS ExpectdReceiptDate,
INLALC AS InitialAllocQuantity,
INLSTR AS InitialStrength,
INLSTK AS InitialStockto,
IMNTBY AS LastMaintainedby
from MM4R4LIB.INVMSTE')

create table INVDPT (
DepartmentNo	int,
SubDeptNo	int,
ProductClass	int,
SubClass	int,
Name	varchar(25),
ShortName	varchar(8),
CommisionPlan	int,
Buyer	varchar(3),
ResponsibleLevel	varchar(3),
SummaryLevel	varchar(1),
SummaryFrequency	varchar(1),
DailyRetention	int,
WeeklyRetention	int,
PeriodRetention	int,
YearlyRetention	int,
ArthurSubclass 	int
)

insert into INVDPT (
DepartmentNo,
SubDeptNo,
ProductClass,
SubClass,
Name,
ShortName,
CommisionPlan,
Buyer,
ResponsibleLevel,
SummaryLevel,
SummaryFrequency,
DailyRetention,
WeeklyRetention,
PeriodRetention,
YearlyRetention,
ArthurSubclass 
)
select
DepartmentNo,
SubDeptNo,
ProductClass,
SubClass,
Name,
ShortName,
CommisionPlan,
Buyer,
ResponsibleLevel,
SummaryLevel,
SummaryFrequency,
DailyRetention,
WeeklyRetention,
PeriodRetention,
YearlyRetention,
ArthurSubclass 
from openquery (bkl400, 
'select 
IDEPT  as DepartmentNo,
ISDEPT as SubDeptNo,
ICLAS  as ProductClass,
ISCLAS as SubClass,
DPTNAM as Name,
DPTSHT as ShortName,
IDPLAN as CommisionPlan,
IDBUYR as Buyer,
IDRESP as ResponsibleLevel,
IDSLVL as SummaryLevel,
IDSFRQ as SummaryFrequency,
IDSRTD as DailyRetention,
IDSRTW as WeeklyRetention,
IDSRTP as PeriodRetention,
IDSRTY as YearlyRetention,
ARTSCL as ArthurSubclass 
from MM4R4LIB.INVDPT')

create table CURPRC (
StoreNumber	int,
SkuNumber	int,
ISBN	varchar(17),
Department	int,
SubDepartment	int,
Class	int,
SubClass	int,
CurRegUnitPrice	 DECIMAL	(9,2),
RegularMult	int,
CurPOSUnitPrice	 DECIMAL	(9,2),
POSMultiple	int,
CurrentCost 	 DECIMAL	(9,3)
)

insert into CURPRC (
StoreNumber,
SkuNumber,
ISBN,
Department,
SubDepartment,
Class,
SubClass,
CurRegUnitPrice,
RegularMult,
CurPOSUnitPrice,
POSMultiple,
CurrentCost 
)

select TOP 10 
StoreNumber,
SkuNumber,
ISBN,
Department,
SubDepartment,
Class,
SubClass,
CurRegUnitPrice,
RegularMult,
CurPOSUnitPrice,
POSMultiple,
CurrentCost 
from openquery (bkl400, 
'select 
STORE# as StoreNumber,
INUMBR as SkuNumber,
ISBN   as ISBN,
IDEPT  as Department,
ISDEPT as SubDepartment,
ICLAS  as Class,
ISCLAS as SubClass,
CURREG as CurRegUnitPrice,
CURRML as RegularMult,
CURPOS as CurPOSUnitPrice,
CURPML as POSMultiple,
CURCST as CurrentCost 
from MM4R4LIB.CURPRC')

create table INVUPCP (
UPCNumber	            varchar(27),
UPCType	            varchar(1),
SkuNumber	            int,
StyleNumber	            varchar(15),
StyleVendor	            int,
VendorPartNo	      varchar(15),
Vendor	            int,
PrepricedAmount	      DECIMAL(9,2),
PrepricedPercentOff	DECIMAL(5,2),
PrepricedAmtOff 	      DECIMAL(9,2)
)

insert into INVUPCP (
UPCNumber,
UPCType,
SkuNumber,
StyleNumber,
StyleVendor,
VendorPartNo,
Vendor,
PrepricedAmount,
PrepricedPercentOff,
PrepricedAmtOff 
)

select TOP 10 
UPCNumber,
UPCType,
SkuNumber,
StyleNumber,
StyleVendor,
VendorPartNo,
Vendor,
PrepricedAmount,
PrepricedPercentOff,
PrepricedAmtOff 
from openquery (bkl400, 
'select 
IUPC   as UPCNumber,
IUPCCD as UPCType,
INUMBR as SkuNumber,
IUSTYL as StyleNumber,
IUASN  as StyleVendor,
IUPRT# as VendorPartNo,
IUVND  as Vendor,
IUPPDA as PrepricedAmount,
IUPPPO as PrepricedPercentOff,
IUPPDO as PrepricedAmtOff 
from MM4R4LIB.INVUPCP')

create table INVATR (
SkuNumber	int,
Attribute	varchar	(20),	
Value	varchar	(80)
)

insert into INVATR (
SkuNumber,
Attribute,
Value 
)

select TOP 10 
SkuNumber,
Attribute,
Value 
from openquery (bkl400, 
'select 
INUMBR as SkuNumber,
IATR as Attribute,
IVAL as Value 
from MM4R4LIB.INVATR')

create table INVNRI (
ReasonCode	varchar(6),
SkuNumber	int,
DWItemNumber	varchar(20),
ActiveFlag	varchar(1),
ProgramName	varchar(10),
[User]	varchar(10),
LastUpdateCentury	int,
LastUpdateDate	date,
LastUpdateTime 	time
)

insert into INVNRI (
ReasonCode,
SkuNumber,
DWItemNumber,
ActiveFlag,
ProgramName,
[User],
LastUpdateCentury,
LastUpdateDate,
LastUpdateTime 
)

select TOP 10 
ReasonCode,
SkuNumber,
DWItemNumber,
ActiveFlag,
ProgramName,
User,
LastUpdateCentury,
LastUpdateDate,
LastUpdateTime 
from openquery (bkl400, 
'select 
NIREAS as ReasonCode,
INUMBR as SkuNumber,
ITMDW  as DWItemNumber,
NIACTV as ActiveFlag,
NIPGMN as ProgramName,
NIUSER as User,
NICENT as LastUpdateCentury,
case NICENT 
when 0 then varchar_format(timestamp_format(char(NIDATE+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(NIDATE,6,0)),''YYMMDD''),''YYMMDD'') end as LastUpdateDate,
time(to_date(digits(cast(NITIME as dec(6,0))),''HH24MISS'')) as LastUpdateTime 
from MM4R4LIB.INVNRI')

create table POMHDR (
PONumber	int,
BackOrderNumber	int,
VendorNumber	int,
TermsCode	int,
DatingCalcFrom	varchar(1),
Status	varchar(1),
Type	varchar(1),
Destination	varchar(1),
StoreIfStoreOrder	int,
ADPO	varchar(1),
DistMethod	varchar(1),
AllowBackorder	varchar(1),
Confirmed	varchar(1),
PhoneOrder	varchar(1),
BuyerNumber	varchar(3),
DepartmentNo	int,
SubDeptNo	int,
OtherVendor	int,
FrtPolicyCode	varchar(1),
FOB	varchar(20),
ShipVia1	varchar(20),
ShipVia2	varchar(20),
ShippingPoint	varchar(20),
ShippingComments	varchar(20),
EntryDateCenturyCode	int,
EntryDate	date,
ShipDateCenturyCode	int,
ShipDate	date,
CancelDateCenturyCode	int,
CancelDate	date,
ReceiptDateCenturyCode	int,
ReceiptDate	date,
LastChangeDateCenturyCode	int,
LastChangeDate	date,
ReviewFreqDays	int,
PlanLeadDays	int,
PointofOrigin	varchar(20),
PONote1	varchar(50),
PONote2	varchar(50),
PONote3	varchar(50),
TotalPOCost	 DECIMAL	(9,2),
TotalPOVat	 DECIMAL	(9,2),
TotalPORetail	 DECIMAL	(9,2),
TotalPOCases	int,
TotalPOUnits	int,
TotalPOWeight	 DECIMAL	(9,2),
TarpCharge	 DECIMAL	(5,2),
StopoverCharge	 DECIMAL	(5,2),
SkidCharge	 DECIMAL	(5,2),
OtherChgAmt	 DECIMAL	(5,2),
OtherChgPercent	DECIMAL	(5,3),
BatchCount	int,
AmountRecRetail	 DECIMAL	(9,2),
AmountRecVat	 DECIMAL	(9,2),
AmountRecCost	 DECIMAL	(9,2),
TotalPallets	int,
TotalCube	 DECIMAL	(13,3),
PushDownDateCenturyCode	int,
PushDownDate	date,
ShipPointNumber	int,
PayDateDateCenturyCode	int,
PayDate	date,
UMType	varchar(1),
TotSkuLevelAlw	 DECIMAL	(9,2),
TotVendorLevelAlw	 DECIMAL	(9,2),
MasterPONumber	int,
MasterBONumber	int,
POLoadNumber	int,
ConversionRate	 DECIMAL	(12,5),
RateEffectiveCentury	int,
RateEffectiveDate	date,
QuickEntryFlag	varchar(1),
MultLoType	varchar(1),
CreateEDI850	varchar(1),
CreateEDI860	varchar(1),
ImportDomestic	varchar(1),
Publisher 	varchar(3)
)

insert into POMHDR (
PONumber,
BackOrderNumber,
VendorNumber,
TermsCode,
DatingCalcFrom,
Status,
Type,
Destination,
StoreIfStoreOrder,
ADPO,
DistMethod,
AllowBackorder,
Confirmed,
PhoneOrder,
BuyerNumber,
DepartmentNo,
SubDeptNo,
OtherVendor,
FrtPolicyCode,
FOB,
ShipVia1,
ShipVia2,
ShippingPoint,
ShippingComments,
EntryDateCenturyCode,
EntryDate,
ShipDateCenturyCode,
ShipDate,
CancelDateCenturyCode,
CancelDate,
ReceiptDateCenturyCode,
ReceiptDate,
LastChangeDateCenturyCode,
LastChangeDate,
ReviewFreqDays,
PlanLeadDays,
PointofOrigin,
PONote1,
PONote2,
PONote3,
TotalPOCost,
TotalPOVat,
TotalPORetail,
TotalPOCases,
TotalPOUnits,
TotalPOWeight,
TarpCharge,
StopoverCharge,
SkidCharge,
OtherChgAmt,
OtherChgPercent,
BatchCount,
AmountRecRetail,
AmountRecVat,
AmountRecCost,
TotalPallets,
TotalCube,
PushDownDateCenturyCode,
PushDownDate,
ShipPointNumber,
PayDateDateCenturyCode,
PayDate,
UMType,
TotSkuLevelAlw,
TotVendorLevelAlw,
MasterPONumber,
MasterBONumber,
POLoadNumber,
ConversionRate,
RateEffectiveCentury,
RateEffectiveDate,
QuickEntryFlag,
MultLoType,
CreateEDI850,
CreateEDI860,
ImportDomestic,
Publisher 
)

select TOP 10 
PONumber,
BackOrderNumber,
VendorNumber,
TermsCode,
DatingCalcFrom,
Status,
Type,
Destination,
StoreIfStoreOrder,
ADPO,
DistMethod,
AllowBackorder,
Confirmed,
PhoneOrder,
BuyerNumber,
DepartmentNo,
SubDeptNo,
OtherVendor,
FrtPolicyCode,
FOB,
ShipVia1,
ShipVia2,
ShippingPoint,
ShippingComments,
EntryDateCenturyCode,
EntryDate,
ShipDateCenturyCode,
ShipDate,
CancelDateCenturyCode,
CancelDate,
ReceiptDateCenturyCode,
ReceiptDate,
LastChangeDateCenturyCode,
LastChangeDate,
ReviewFreqDays,
PlanLeadDays,
PointofOrigin,
PONote1,
PONote2,
PONote3,
TotalPOCost,
TotalPOVat,
TotalPORetail,
TotalPOCases,
TotalPOUnits,
TotalPOWeight,
TarpCharge,
StopoverCharge,
SkidCharge,
OtherChgAmt,
OtherChgPercent,
BatchCount,
AmountRecRetail,
AmountRecVat,
AmountRecCost,
TotalPallets,
TotalCube,
PushDownDateCenturyCode,
PushDownDate,
ShipPointNumber,
PayDateDateCenturyCode,
PayDate,
UMType,
TotSkuLevelAlw,
TotVendorLevelAlw,
MasterPONumber,
MasterBONumber,
POLoadNumber,
ConversionRate,
RateEffectiveCentury,
RateEffectiveDate,
QuickEntryFlag,
MultLoType,
CreateEDI850,
CreateEDI860,
ImportDomestic,
Publisher 
from openquery (bkl400, 
'select 
PONUMB as PONumber,
POBO#  as BackOrderNumber,
POVNUM as VendorNumber,
POTRMS as TermsCode,
POTIND as DatingCalcFrom,
POSTAT as Status,
POTYPE as Type,
PODEST as Destination,
POSTOR as StoreIfStoreOrder,
POADYN as ADPO,
PODMTH as DistMethod,
POALBO as AllowBackorder,
POCONF as Confirmed,
POPHON as PhoneOrder,
POBUYR as BuyerNumber,
PODPT  as DepartmentNo,
POSDPT as SubDeptNo,
POTHER as OtherVendor,
POFPCD as FrtPolicyCode,
POFOB  as FOB,
POSHP1 as ShipVia1,
POSHP2 as ShipVia2,
POSHPP as ShippingPoint,
POSHPC as ShippingComments,
POECEN as EntryDateCenturyCode,
case POECEN 
when 0 then date(timestamp_format(char(POEDAT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POEDAT,6,0)),''YYMMDD'') end as EntryDate,
POSCEN as ShipDateCenturyCode,
case POSCEN 
when 0 then date(timestamp_format(char(POSDAT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POSDAT,6,0)),''YYMMDD'') end as ShipDate,
POCCEN as CancelDateCenturyCode,
case POCCEN 
when 0 then date(timestamp_format(char(POCDAT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POCDAT,6,0)),''YYMMDD'') end as CancelDate,
PORCEN as ReceiptDateCenturyCode,
case PORCEN 
when 0 then date(timestamp_format(char(PORDAT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(PORDAT,6,0)),''YYMMDD'') end as ReceiptDate,
POLCCN as LastChangeDateCenturyCode,
case POLCCN 
when 0 then date(timestamp_format(char(POLCHG+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POLCHG,6,0)),''YYMMDD'') end as LastChangeDate,
PORFRQ as ReviewFreqDays,
POLEAD as PlanLeadDays,
POORIG as PointofOrigin,
PONOT1 as PONote1,
PONOT2 as PONote2,
PONOT3 as PONote3,
POCOST as TotalPOCost,
POVAT  as TotalPOVat,
PORETL as TotalPORetail,
POCASE as TotalPOCases,
POUNTS as TotalPOUnits,
POWGHT as TotalPOWeight,
POTARP as TarpCharge,
POSTOP as StopoverCharge,
POSKID as SkidCharge,
POOTH$ as OtherChgAmt,
POOTHP as OtherChgPercent,
POBTCH as BatchCount,
PORRET as AmountRecRetail,
PORVAT as AmountRecVat,
PORCST as AmountRecCost,
POTPLT as TotalPallets,
POCUBE as TotalCube,
POPDCN as PushDownDateCenturyCode,
case POPDCN 
when 0 then date(timestamp_format(char(POPDWN+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POPDWN,6,0)),''YYMMDD'') end as PushDownDate,
SHPNUM as ShipPointNumber,
POPYCN as PayDateDateCenturyCode,
case POPYCN 
when 0 then date(timestamp_format(char(POPYDT+19000000), ''YYYYMMDD'')) 
when 1 then to_date(char(LPAD(POPYDT,6,0)),''YYMMDD'') end as PayDate,
POBYTP as UMType,
POMALS as TotSkuLevelAlw,
POMALV as TotVendorLevelAlw,
POMSPO as MasterPONumber,
POMSBO as MasterBONumber,
POLOAD as POLoadNumber,
POMCRT as ConversionRate,
POMCCN as RateEffectiveCentury,
case POMCCN 
when 0 then varchar_format(timestamp_format(char(POMCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(POMCDT,6,0)),''YYMMDD''),''YYMMDD'') end as RateEffectiveDate,
POQCKE as QuickEntryFlag,
POMTYP as MultLoType,
PO850F as CreateEDI850,
PO860F as CreateEDI860,
POTPID as ImportDomestic,
POPUB  as Publisher
from MM4R4LIB.POMHDR')

create table APSUPP (
VendorNumber	int,
VendorName	varchar(35),
AdditionalAddresses	varchar(1),
AlphaSearchCode	varchar(6),
PayStatus	varchar(1),
SupplierType	varchar(1),
BO	varchar(1),
AutoDistCode	varchar(1),
CoOpAdCustNo	int,
ClerkNumber	int,
DefaultAccountNo	int,
DefaultStore	int,
FactorAgent	int,
BuyerNumber	varchar(3),
VendorsCustomerNo	varchar(8),
CenturyBroughtOn	int,
DateBroughtOn	int,
CenturyLastPaid	int,
DateLastPaid	int,
AmountLastPaid	 DECIMAL	(9,2),
CheckLastPaid	int,
APBalance	 DECIMAL	(9,2),
APCreditTotal	 DECIMAL	(9,2),
PONote1	varchar(50),
PONote2	varchar(50),
PONote3	varchar(50),
RecNote1	varchar(50),
RecNote2	varchar(50),
RecNote3	varchar(50),
ByrNote1	varchar(50),
ByrNote2	varchar(50),
ByrNote3	varchar(50),
ReviewFreqDays	int,
PlanLeadDays	int,
NumberofPOs	int,
TotalLeadDays	int,
TermsCode	int,
DatingCalcFrom	varchar(1),
PushDiscDays	int,
AlwaysTakeDisc	varchar(1),
FrtPolicyCode	varchar(1),
FrtAllowPercent	 DECIMAL	(5,3),
FrtAllowAmt	 DECIMAL	(6,2),
FOBCode	varchar(1),
ShipVia1	varchar(20),
ShipVia2	varchar(20),
ShippingPoint	varchar(20),
ShippingComments	varchar(20),
MinShipCode	varchar(1),
MinShipAmount	int,
TruckAllowPercent	 DECIMAL	(5,3),
TruckAllowAmt	 DECIMAL	(6,2),
TarpCharge	 DECIMAL	(5,2),
StopOverCharge	 DECIMAL	(5,2),
SkidCharge	 DECIMAL	(5,2),
OtherChgAmt	 DECIMAL	(5,2),
OtherChgPercent	 DECIMAL	(5,3),
ReturnsPolicyCode	varchar(1),
VolumePercent	 DECIMAL	(5,3),
VolumeAmt	 DECIMAL	(6,2),
RebatePercent	 DECIMAL	(5,3),
RebateAmt	 DECIMAL	(6,2),
OtherAllowPercent	 DECIMAL	(5,3),
OtherAllowAmt	 DECIMAL	(6,2),
RecPurYTDRetl	 DECIMAL	(10,2),
RecPurYTDCost	 DECIMAL	(10,2),
OpenOrdersRetl	 DECIMAL	(10,2),
OpenOrdersCost	 DECIMAL	(10,2),
CreditMemosRetl	 DECIMAL	(10,2),
CreditMemosCost	 DECIMAL	(10,2),
Markups	 DECIMAL	(10,2),
Markdowns	 DECIMAL	(10,2),
FreightCost	 DECIMAL	(10,2),
FreightAllow	 DECIMAL	(10,2),
CashDiscounts	 DECIMAL	(10,2),
OtherAllowances	 DECIMAL	(10,2),
OtherCosts	 DECIMAL	(10,2),
GrossMarginPercent	 DECIMAL	(5,1),
VendorGMROI	 DECIMAL	(5,1),
Turns	 DECIMAL	(5,1),
AverageOnHand	 DECIMAL	(10,2),
POsBackordered	int,
POsUndershipped	int,
NoofLatePOs	int,
LYNoPos	int,
LYToteLeadDays	int,
LYUnitsRecieved	int,
LYUnitsOrdered	int,
TYNoPos	int,
TYToteLeadDays	int,
TYUnitsRecieved	int,
TYUnitsOrdered	int,
LostDiscThisYr	 DECIMAL	(9,2),
LostDiscLastYr	 DECIMAL	(9,2),
TaxIDNumber1099	varchar(9),
PersonCorpPC	varchar(1),
OtherName	varchar(35),
PrintRA	varchar(1),
CurrencyCode	varchar(3),
VendorTaxCode	varchar(1),
SendtoStore	varchar(1),
APCostTolerancePercentRangeToteInv	 DECIMAL	(4,2),
APCostTolerancePercentRangeToteDescription	varchar(10),
APUnitTolerancePercentRangeToteInv	 DECIMAL	(4,2),
APUnitTolerancePercentRangeToteDescription	varchar(10),
APCostTolerancePercentRangeLineItem	 DECIMAL	(4,2),
APCostTolerancePercentRangeLineItemDescription	varchar(10),
APUnitTolerancePercentRangeLineItem	 DECIMAL	(4,2),
APUnitTolerancePercentRangeLineItemDescription	varchar(10),
LineItemMatching	varchar(1),
APCostToleranceAmountRangeTote	 DECIMAL	(9,2),
APCostToleranceAmountRangeToteDescription	varchar(10),
TaxRegistered	varchar(1),
TaxNo	varchar(20),
NetTaxAmountYTD	 DECIMAL	(10,2),
NotUsed1	 DECIMAL	(10,2),
AlwaysBillforFreight	varchar(1),
NotUsed2	varchar(1),
ShowPOAllowancesasSeparateLineonInvoice	varchar(1),
VendorUseHashQuantities	varchar(1),
LineMatchatNetorGross	varchar(1),
LineMatchatUnitorExtendedCost	varchar(1),
LineMatchatSKUorVendorPartNumber	varchar(1),
MatchingActive	varchar(1),
CreditAuthorizationRequired	varchar(1),
TaxAmountsSubjecttoDiscount	varchar(1),
DefaultAllocation 	varchar(5)
)

insert into APSUPP (
VendorNumber,
VendorName,
AdditionalAddresses,
AlphaSearchCode,
PayStatus,
SupplierType,
BO,
AutoDistCode,
CoOpAdCustNo,
ClerkNumber,
DefaultAccountNo,
DefaultStore,
FactorAgent,
BuyerNumber,
VendorsCustomerNo,
CenturyBroughtOn,
DateBroughtOn,
CenturyLastPaid,
DateLastPaid,
AmountLastPaid,
CheckLastPaid,
APBalance,
APCreditTotal,
PONote1,
PONote2,
PONote3,
RecNote1,
RecNote2,
RecNote3,
ByrNote1,
ByrNote2,
ByrNote3,
ReviewFreqDays,
PlanLeadDays,
NumberofPOs,
TotalLeadDays,
TermsCode,
DatingCalcFrom,
PushDiscDays,
AlwaysTakeDisc,
FrtPolicyCode,
FrtAllowPercent,
FrtAllowAmt,
FOBCode,
ShipVia1,
ShipVia2,
ShippingPoint,
ShippingComments,
MinShipCode,
MinShipAmount,
TruckAllowPercent,
TruckAllowAmt,
TarpCharge,
StopOverCharge,
SkidCharge,
OtherChgAmt,
OtherChgPercent,
ReturnsPolicyCode,
VolumePercent,
VolumeAmt,
RebatePercent,
RebateAmt,
OtherAllowPercent,
OtherAllowAmt,
RecPurYTDRetl,
RecPurYTDCost,
OpenOrdersRetl,
OpenOrdersCost,
CreditMemosRetl,
CreditMemosCost,
Markups,
Markdowns,
FreightCost,
FreightAllow,
CashDiscounts,
OtherAllowances,
OtherCosts,
GrossMarginPercent,
VendorGMROI,
Turns,
AverageOnHand,
POsBackordered,
POsUndershipped,
NoofLatePOs,
LYNoPos,
LYToteLeadDays,
LYUnitsRecieved,
LYUnitsOrdered,
TYNoPos,
TYToteLeadDays,
TYUnitsRecieved,
TYUnitsOrdered,
LostDiscThisYr,
LostDiscLastYr,
TaxIDNumber1099,
PersonCorpPC,
OtherName,
PrintRA,
CurrencyCode,
VendorTaxCode,
SendtoStore,
APCostTolerancePercentRangeToteInv,
APCostTolerancePercentRangeToteDescription,
APUnitTolerancePercentRangeToteInv,
APUnitTolerancePercentRangeToteDescription,
APCostTolerancePercentRangeLineItem,
APCostTolerancePercentRangeLineItemDescription,
APUnitTolerancePercentRangeLineItem,
APUnitTolerancePercentRangeLineItemDescription,
LineItemMatching,
APCostToleranceAmountRangeTote,
APCostToleranceAmountRangeToteDescription,
TaxRegistered,
TaxNo,
NetTaxAmountYTD,
NotUsed1,
AlwaysBillforFreight,
NotUsed2,
ShowPOAllowancesasSeparateLineonInvoice,
VendorUseHashQuantities,
LineMatchatNetorGross,
LineMatchatUnitorExtendedCost,
LineMatchatSKUorVendorPartNumber,
MatchingActive,
CreditAuthorizationRequired,
TaxAmountsSubjecttoDiscount,
DefaultAllocation 
)
select TOP 10 
VendorNumber,
VendorName,
AdditionalAddresses,
AlphaSearchCode,
PayStatus,
SupplierType,
BO,
AutoDistCode,
CoOpAdCustNo,
ClerkNumber,
DefaultAccountNo,
DefaultStore,
FactorAgent,
BuyerNumber,
VendorsCustomerNo,
CenturyBroughtOn,
DateBroughtOn,
CenturyLastPaid,
DateLastPaid,
AmountLastPaid,
CheckLastPaid,
APBalance,
APCreditTotal,
PONote1,
PONote2,
PONote3,
RecNote1,
RecNote2,
RecNote3,
ByrNote1,
ByrNote2,
ByrNote3,
ReviewFreqDays,
PlanLeadDays,
NumberofPOs,
TotalLeadDays,
TermsCode,
DatingCalcFrom,
PushDiscDays,
AlwaysTakeDisc,
FrtPolicyCode,
FrtAllowPercent,
FrtAllowAmt,
FOBCode,
ShipVia1,
ShipVia2,
ShippingPoint,
ShippingComments,
MinShipCode,
MinShipAmount,
TruckAllowPercent,
TruckAllowAmt,
TarpCharge,
StopOverCharge,
SkidCharge,
OtherChgAmt,
OtherChgPercent,
ReturnsPolicyCode,
VolumePercent,
VolumeAmt,
RebatePercent,
RebateAmt,
OtherAllowPercent,
OtherAllowAmt,
RecPurYTDRetl,
RecPurYTDCost,
OpenOrdersRetl,
OpenOrdersCost,
CreditMemosRetl,
CreditMemosCost,
Markups,
Markdowns,
FreightCost,
FreightAllow,
CashDiscounts,
OtherAllowances,
OtherCosts,
GrossMarginPercent,
VendorGMROI,
Turns,
AverageOnHand,
POsBackordered,
POsUndershipped,
NoofLatePOs,
LYNoPos,
LYToteLeadDays,
LYUnitsRecieved,
LYUnitsOrdered,
TYNoPos,
TYToteLeadDays,
TYUnitsRecieved,
TYUnitsOrdered,
LostDiscThisYr,
LostDiscLastYr,
TaxIDNumber1099,
PersonCorpPC,
OtherName,
PrintRA,
CurrencyCode,
VendorTaxCode,
SendtoStore,
APCostTolerancePercentRangeToteInv,
APCostTolerancePercentRangeToteDescription,
APUnitTolerancePercentRangeToteInv,
APUnitTolerancePercentRangeToteDescription,
APCostTolerancePercentRangeLineItem,
APCostTolerancePercentRangeLineItemDescription,
APUnitTolerancePercentRangeLineItem,
APUnitTolerancePercentRangeLineItemDescription,
LineItemMatching,
APCostToleranceAmountRangeTote,
APCostToleranceAmountRangeToteDescription,
TaxRegistered,
TaxNo,
NetTaxAmountYTD,
NotUsed1,
AlwaysBillforFreight,
NotUsed2,
ShowPOAllowancesasSeparateLineonInvoice,
VendorUseHashQuantities,
LineMatchatNetorGross,
LineMatchatUnitorExtendedCost,
LineMatchatSKUorVendorPartNumber,
MatchingActive,
CreditAuthorizationRequired,
TaxAmountsSubjecttoDiscount,
DefaultAllocation 
from openquery (bkl400, 
'select 
ASNUM  as VendorNumber,
ASNAME as VendorName,
ASADAD as AdditionalAddresses,
ASALPH as AlphaSearchCode,
ASSTAT as PayStatus,
ASTYPE as SupplierType,
ASBOYN as BO,
ASAUTO as AutoDistCode,
ASCNUM as CoOpAdCustNo,
ASCLRK as ClerkNumber,
ASDFAC as DefaultAccountNo,
ASSTR  as DefaultStore,
ASVOTH as FactorAgent,
ASBUYR as BuyerNumber,
ASCUST as VendorsCustomerNo,
ASCNIN as CenturyBroughtOn,
case ASCNIN 
when 0 then varchar_format(timestamp_format(char(ASDTIN+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(ASDTIN,6,0)),''YYMMDD''),''YYMMDD'') end as DateBroughtOn,
ASCNLP as CenturyLastPaid,
case ASCNLP 
when 0 then varchar_format(timestamp_format(char(ASDTLP+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(ASDTLP,6,0)),''YYMMDD''),''YYMMDD'') end as DateLastPaid,
ASAMLP as AmountLastPaid,
ASCKLP as CheckLastPaid,
ASBAL1 as APBalance,
ASBAL2 as APCreditTotal,
PONOT1 as PONote1,
PONOT2 as PONote2,
PONOT3 as PONote3,
RCNOT1 as RecNote1,
RCNOT2 as RecNote2,
RCNOT3 as RecNote3,
BYNOT1 as ByrNote1,
BYNOT2 as ByrNote2,
BYNOT3 as ByrNote3,
ASRVFR as ReviewFreqDays,
ASLEAD as PlanLeadDays,
ASTPO  as NumberofPOs,
ASTLT  as TotalLeadDays,
ASTRMS as TermsCode,
ASTIND as DatingCalcFrom,
ASPUSH as PushDiscDays,
ASTDSC as AlwaysTakeDisc,
ASFPCD as FrtPolicyCode,
ASFALP as FrtAllowPercent,
ASFAL$ as FrtAllowAmt,
ASFOBC as FOBCode,
ASSHP1 as ShipVia1,
ASSHP2 as ShipVia2,
ASSHPP as ShippingPoint,
ASSHPC as ShippingComments,
ASMINC as MinShipCode,
ASMINA as MinShipAmount,
ASTRKP as TruckAllowPercent,
ASTRKA as TruckAllowAmt,
ASTARP as TarpCharge,
ASSTOP as StopOverCharge,
ASSKID as SkidCharge,
ASOTH$ as OtherChgAmt,
ASOTHP as OtherChgPercent,
ASRTCD as ReturnsPolicyCode,
ASVOLP as VolumePercent,
ASVOL$ as VolumeAmt,
ASREBP as RebatePercent,
ASREB$ as RebateAmt,
ASALLP as OtherAllowPercent,
ASALL$ as OtherAllowAmt,
APPR01 as RecPurYTDRetl,
APPR02 as RecPurYTDCost,
APPR03 as OpenOrdersRetl,
APPR04 as OpenOrdersCost,
APPR05 as CreditMemosRetl,
APPR06 as CreditMemosCost,
APPR07 as Markups,
APPR08 as Markdowns,
APPR09 as FreightCost,
APPR10 as FreightAllow,
APPR11 as CashDiscounts,
APPR12 as OtherAllowances,
APPR13 as OtherCosts,
APMRGP as GrossMarginPercent,
AGMROI as VendorGMROI,
APTRNS as Turns,
APAVOH as AverageOnHand,
APPOBO as POsBackordered,
APPOSS as POsUndershipped,
APPOLT as NoofLatePOs,
APLY01 as LYNoPos,
APLY02 as LYToteLeadDays,
APLY03 as LYUnitsRecieved,
APLY04 as LYUnitsOrdered,
APTY01 as TYNoPos,
APTY02 as TYToteLeadDays,
APTY03 as TYUnitsRecieved,
APTY04 as TYUnitsOrdered,
ASLST1 as LostDiscThisYr,
ASLST2 as LostDiscLastYr,
AS1099 as TaxIDNumber1099,
ASPCCD as PersonCorpPC,
ASOTHN as OtherName,
ASRAYN as PrintRA,
ASCURC as CurrencyCode,
ASTAXC as VendorTaxCode,
ASSTYN as SendtoStore,
ASTTPC as APCostTolerancePercentRangeToteInv,
ASTTDC as APCostTolerancePercentRangeToteDescription,
ASTTPU as APUnitTolerancePercentRangeToteInv,
ASTTDU as APUnitTolerancePercentRangeToteDescription,
ASTLPC as APCostTolerancePercentRangeLineItem,
ASTLDC as APCostTolerancePercentRangeLineItemDescription,
ASTLPU as APUnitTolerancePercentRangeLineItem,
ASTLDU as APUnitTolerancePercentRangeLineItemDescription,
ASLINM as LineItemMatching,
ASTT$C as APCostToleranceAmountRangeTote,
ASTT$D as APCostToleranceAmountRangeToteDescription,
ASGSTR as TaxRegistered,
ASGSTN as TaxNo,
ASGST1 as NetTaxAmountYTD,
ASGST2 as NotUsed1,
ASFRTF as AlwaysBillforFreight,
ASMSCF as NotUsed2,
ASALWF as ShowPOAllowancesasSeparateLineonInvoice,
ASHSHQ as VendorUseHashQuantities,
ASLNOG as LineMatchatNetorGross,
ASLUOE as LineMatchatUnitorExtendedCost,
ASLSOP as LineMatchatSKUorVendorPartNumber,
ASMTCH as MatchingActive,
ASCAUT as CreditAuthorizationRequired,
ASTAXD as TaxAmountsSubjecttoDiscount,
ASALLC as DefaultAllocation 
from MM4R4LIB.APSUPP')

create table RDI010(
StoreNumber	int,
SkuNumber	int,
PrimaryISBN	varchar(20),
DWItemNumber	varchar(20),
StockToQty	int,
OnHandQty	int,
SkuStatusCode	varchar(1),
SkuTypeCode	varchar(2),
SkuReplenCode	varchar(1),
DateCreated	Date, /*Num8*/
Dept	int,
SubDept	int,
Class	int,
SubClass int,
)

insert into RDI010 (
StoreNumber,
SkuNumber,
PrimaryISBN,
DWItemNumber,
StockToQty,
OnHandQty,
SkuStatusCode,
SkuTypeCode,
SkuReplenCode,
DateCreated,
Dept,
SubDept,
Class,
SubClass 
)

select TOP 10 
StoreNumber,
SkuNumber,
PrimaryISBN,
DWItemNumber,
StockToQty,
OnHandQty,
SkuStatusCode,
SkuTypeCode,
SkuReplenCode,
DateCreated,
Dept,
SubDept,
Class,
SubClass 
from openquery (bkl400, 
'select 
RSSTR  as STORENUMBER,
RSSKU  as SKUNUMBER,
RSISBN as PRIMARYISBN,
RSDWIN as DWITEMNUMBER,
RSQTY1 as STOCKTOQTY,
RSQTY2 as ONHANDQTY,
RSSTAT as SKUSTATUSCODE,
RSTYPE as SKUTYPECODE,
RSRPCD as SKUREPLENCODE,
to_date(CHAR(RSCDAT), ''YYYYMMDD'') as DATECREATED,
RSDEPT as DEPT,
RSSDPT as SUBDEPT,
RSCLAS as CLASS,
RSSCLS as SUBCLASS 
from MM4R4LIB.RDI010')

create table PORCTRK (
StoreNumber	int,
PickDay	int,
DeliveryDay	int,
BSPickDay	int,
LayoutCode	varchar(6),
FixtureCode 	varchar(6)
)

insert into PORCTRK (
StoreNumber,
PickDay,
DeliveryDay,
BSPickDay,
LayoutCode,
FixtureCode 
)

select TOP 10 
StoreNumber,
PickDay,
DeliveryDay,
BSPickDay,
LayoutCode,
FixtureCode 
from openquery (bkl400, 
'select 
PTSTOR# as STORENUMBER,
PTPDAY  as PICKDAY,
PTDDAY  as DELIVERYDAY,
PTBDAY  as BSPICKDAY,
PTLAYO  as LAYOUTCODE,
PTFC    as FIXTURECODE 
from MM4R4LIB.PORCTRK')

create table RPLPRF(
SkuNumber	int,
StoreNumber	int,
ProductStartDateCenturyCode	int,
ProdStartYear	int,
ProdStartMonth int,
DateStoreOpenedCenturyCode	int,
StoreOpenYear	int,
StoreOpenMonth int,
Profile	varchar(5),
RPLCalc	varchar(1),
VendorNumber	int,
ShipPointNum	int,
ItemStatusCode	varchar(1),
ReplacementSKU	int,
Options	varchar(1),
MaxStockOrdTo	int,
DisplayMinOrdTo	int,
ModelStockCode	varchar(4),
StoreWarehouse	int,
ManFcatDropDateCenturyCode	int,
DropManFcatYear	int,
DropManFcatMonth	int,
SameasStoreNumber	int,
SameasSkuNumber	int,
SafetyStockWks	int,
BaseSales	int,
CalcdTrend	 DECIMAL	(5,3),
ActualTrend	 DECIMAL	(5,3),
CurYrFCastUnits	int,
OrderPercentWeeks	 DECIMAL	(4,1),
OrderNumberWeeks	 DECIMAL	(4,1),
VendorLeadTime	int,
ModelStock	int,
MinimumStock	int,
ModelStockRatio	 DECIMAL	(3,1),
AdjPerRatio	 DECIMAL	(3,1),
AdjPerRatioPercent	 DECIMAL	(3,1),
AdjOrderUpTo	int,
AdjOrderAt	int,
AvgSalesPrevious	 DECIMAL	(7,2),
AvgSalesNew	int,
AvgSalesHistoric	 DECIMAL	(7,2),
AvgSalesForecast	 DECIMAL	(7,2),
ReviewPeriodDays	int,
StoreAllocMax	int,
SkuRating1	 DECIMAL	(3,2),
SkuRankng1	varchar(1),
SkuRating2	 DECIMAL	(3,2),
SkuRankng2	varchar(1),
SkuRating3	 DECIMAL	(3,2),
SkuRankng3	varchar(1),
SkuRating4	 DECIMAL	(3,2),
SkuRankng4	varchar(1),
MaxSafetyStock	int,
SafetyStockDays	int,
SafetyStockUnits	int,
TotalRank	 DECIMAL	(9,2),
TotalStores	int,
SameasStoreDropDateCenturyCode	int,
SameasStoreDropYear	int,
SameasStoreDropMonth	int,
SameasStoreForecastUnits	int,
Department	int,
SubDepartment	int,
Class	int,
SubClass	int,
CurWksWghtngFactor	 DECIMAL	(3,2),
HistWksWghtngFactor	 DECIMAL	(3,2),
PreviousRunsAvgSlsHist  	 DECIMAL	(7,2)
)

insert into RPLPRF(
SkuNumber,
StoreNumber,
ProductStartDateCenturyCode,
ProdStartYear,
ProdStartMonth,
DateStoreOpenedCenturyCode,
StoreOpenYear,
StoreOpenMonth,
Profile,
RPLCalc,
VendorNumber,
ShipPointNum,
ItemStatusCode,
ReplacementSKU,
Options,
MaxStockOrdTo,
DisplayMinOrdTo,
ModelStockCode,
StoreWarehouse,
ManFcatDropDateCenturyCode,
DropManFcatYear,
DropManFcatMonth,
SameasStoreNumber,
SameasSkuNumber,
SafetyStockWks,
BaseSales,
CalcdTrend,
ActualTrend,
CurYrFCastUnits,
OrderPercentWeeks,
OrderNumberWeeks,
VendorLeadTime,
ModelStock,
MinimumStock,
ModelStockRatio,
AdjPerRatio,
AdjPerRatioPercent,
AdjOrderUpTo,
AdjOrderAt,
AvgSalesPrevious,
AvgSalesNew,
AvgSalesHistoric,
AvgSalesForecast,
ReviewPeriodDays,
StoreAllocMax,
SkuRating1,
SkuRankng1,
SkuRating2,
SkuRankng2,
SkuRating3,
SkuRankng3,
SkuRating4,
SkuRankng4,
MaxSafetyStock,
SafetyStockDays,
SafetyStockUnits,
TotalRank,
TotalStores,
SameasStoreDropDateCenturyCode,
SameasStoreDropYear,
SameasStoreDropMonth,
SameasStoreForecastUnits,
Department,
SubDepartment,
Class,
SubClass,
CurWksWghtngFactor,
HistWksWghtngFactor,
PreviousRunsAvgSlsHist  
)
select TOP 10 
SkuNumber,
StoreNumber,
ProductStartDateCenturyCode,
ProdStartYear,
ProdStartMonth,
DateStoreOpenedCenturyCode,
StoreOpenYear,
StoreOpenMonth,
Profile,
RPLCalc,
VendorNumber,
ShipPointNum,
ItemStatusCode,
ReplacementSKU,
Options,
MaxStockOrdTo,
DisplayMinOrdTo,
ModelStockCode,
StoreWarehouse,
ManFcatDropDateCenturyCode,
DropManFcatYear,
DropManFcatMonth,
SameasStoreNumber,
SameasSkuNumber,
SafetyStockWks,
BaseSales,
CalcdTrend,
ActualTrend,
CurYrFCastUnits,
OrderPercentWeeks,
OrderNumberWeeks,
VendorLeadTime,
ModelStock,
MinimumStock,
ModelStockRatio,
AdjPerRatio,
AdjPerRatioPercent,
AdjOrderUpTo,
AdjOrderAt,
AvgSalesPrevious,
AvgSalesNew,
AvgSalesHistoric,
AvgSalesForecast,
ReviewPeriodDays,
StoreAllocMax,
SkuRating1,
SkuRankng1,
SkuRating2,
SkuRankng2,
SkuRating3,
SkuRankng3,
SkuRating4,
SkuRankng4,
MaxSafetyStock,
SafetyStockDays,
SafetyStockUnits,
TotalRank,
TotalStores,
SameasStoreDropDateCenturyCode,
SameasStoreDropYear,
SameasStoreDropMonth,
SameasStoreForecastUnits,
Department,
SubDepartment,
Class,
SubClass,
CurWksWghtngFactor,
HistWksWghtngFactor,
PreviousRunsAvgSlsHist  
from openquery (bkl400, 
'select 
INUMBR as SkuNumber,
ISTORE as StoreNumber,
RFSTCN as ProductStartDateCenturyCode,
substr(char(LPAD(RFSTDT,4,0)),1,2) as ProdStartYear,
substr(char(LPAD(RFSTDT,4,0)),3,4) as ProdStartMonth,
RFOPCN as DateStoreOpenedCenturyCode,
substr(char(LPAD(RFOPDT,4,0)),1,2) as StoreOpenYear,
substr(char(LPAD(RFOPDT,4,0)),3,4) as StoreOpenMonth,
RFPROF as Profile,
RFRPCD as RPLCalc,
RFANUM as VendorNumber,
RFSNUM as ShipPointNum,
RFDSCD as ItemStatusCode,
RFREPL as ReplacementSKU,
RFDIST as Options,
RFMSTK as MaxStockOrdTo,
RFDSPY as DisplayMinOrdTo,
RFMCOD as ModelStockCode,
RFWHSE as StoreWarehouse,
RFFDCN as ManFcatDropDateCenturyCode,
substr(char(LPAD(RFFDDT,4,0)),1,2) as DropManFcatYear,
substr(char(LPAD(RFFDDT,4,0)),3,4) as DropManFcatMonth,
RFSSTR as SameasStoreNumber,
RFSSKU as SameasSkuNumber,
RFVWKS as SafetyStockWks,
RFBSLS as BaseSales,
RFTRND as CalcdTrend,
RFATRN as ActualTrend,
RFFCUN as CurYrFCastUnits,
RFLPWS as OrderPercentWeeks,
RFL#WS as OrderNumberWeeks,
RFLEAD as VendorLeadTime,
RFMAXS as ModelStock,
RFMINS as MinimumStock,
RFMRAT as ModelStockRatio,
RFPRAT as AdjPerRatio,
RFPPCT as AdjPerRatioPercent,
RFMAX  as AdjOrderUpTo,
RFMIN  as AdjOrderAt,
RFASWP as AvgSalesPrevious,
RFASWN as AvgSalesNew,
RFASWH as AvgSalesHistoric,
RFASWF as AvgSalesForecast,
RFRVPR as ReviewPeriodDays,
RFSAM  as StoreAllocMax,
RFRAT1 as SkuRating1,
RFRNK1 as SkuRankng1,
RFRAT2 as SkuRating2,
RFRNK2 as SkuRankng2,
RFRAT3 as SkuRating3,
RFRNK3 as SkuRankng3,
RFRAT4 as SkuRating4,
RFRNK4 as SkuRankng4,
RFMXSS as MaxSafetyStock,
RFSSDY as SafetyStockDays,
RFSSUN as SafetyStockUnits,
RFRATT as TotalRank,
RFSTRT as TotalStores,
RFSDCN as SameasStoreDropDateCenturyCode,
substr(char(LPAD(RFFDDT,4,0)),1,2) as SameasStoreDropYear,
substr(char(LPAD(RFFDDT,4,0)),3,4) as SameasStoreDropMonth,
RFSCUN as SameasStoreForecastUnits,
RFDEPT as Department,
RFSDPT as SubDepartment,
RFCLAS as Class,
RFSCLS as SubClass,
RFWFC1 as CurWksWghtngFactor,
RFWFC2 as HistWksWghtngFactor,
RFPSWH as PreviousRunsAvgSlsHist 
from MM4R4LIB.RPLPRF')

create table RTVTRN(
DebitNumber	int,
StoreNumber	int,
VendorNumber	int,
ScanCode	varchar(20),
SkuNumber	int,
Dept	int,
MMSOnHand	int,
SKUStatus	varchar(1),
SkuType	varchar(2),
StoreQtyReturned	int,
QuantityReturned	int,
DateReturned	Date,
TimeReturned	time,
StatusFlag	varchar(2),
CreateDate	Date,
CreateUser	varchar(10),
CreateProgram	varchar(10),
ChangeDate	Date,
ChangeUser	varchar(10),
ChangeProgram	varchar(10),
StatementField	varchar(50),
ReconciledDate Date,
LastRecvQty	int
)

insert into RTVTRN (
DebitNumber,
StoreNumber,
VendorNumber,
ScanCode,
SkuNumber,
Dept,
MMSOnHand,
SKUStatus,
SkuType,
StoreQtyReturned,
QuantityReturned,
DateReturned,
TimeReturned,
StatusFlag,
CreateDate,
CreateUser,
CreateProgram,
ChangeDate,
ChangeUser,
ChangeProgram,
StatementField,
ReconciledDate,
LastRecvQty
)

select TOP 10 
DebitNumber,
StoreNumber,
VendorNumber,
ScanCode,
SkuNumber,
Dept,
MMSOnHand,
SKUStatus,
SkuType,
StoreQtyReturned,
QuantityReturned,
DateReturned,
TimeReturned,
StatusFlag,
CreateDate,
CreateUser,
CreateProgram,
ChangeDate,
ChangeUser,
ChangeProgram,
StatementField,
ReconciledDate,
LastRecvQty
from openquery (bkl400, 
'select 
DEBNBR	as DebitNumber,
STRNBR	as StoreNumber,
VNDNBR	as VendorNumber,
SCANID	as ScanCode,
SKUNBR	as SkuNumber,
DEPTKY	as Dept,
ONHDKY	as MMSOnHand,
STATKY	as SKUStatus,
TYPEKY	as SkuType,
STRQTY	as StoreQtyReturned,
RTNQTY	as QuantityReturned,
varchar_format(timestamp_format(char(LPAD(RTNDATE,8,0)),''YYYYMMDD''),''YYYYMMDD'') as DateReturned,
time(to_date(digits(cast(RTNTIME as dec(6,0))),''HH24MISS'')) as TimeReturned,
STATUS	as StatusFlag,
varchar_format(timestamp_format(char(LPAD(CRTDAT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as CreateDate,
CRTUSR	as CreateUser,
CRTPGM	as CreateProgram,
varchar_format(timestamp_format(char(LPAD(CHGDAT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as ChangeDate,
CHGUSR	as ChangeUser,
CHGPGM	as ChangeProgram,
STATMNT	as StatementField,
varchar_format(timestamp_format(char(LPAD(RCDAT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as ReconciledDate,
LRCVQTY	as LastRecvQty 
from MM4R4LIB.RTVTRN')

select TOP 10 
DebitNbr,
StoreNbr,
ReturnTo,
Scanned,
UserID,
Dept,
ReasonforRtn,
StoreBoxes,
StoreQty,
StoreRetail,
StoreCost,
ScannedDate,
MMSBoxes,
MMSQty,
MMSErrors,
MMSStatus,
MMSPostDate,
MMSPostPgm,
MMSPostUser,
DWBoxes,
DWQty,
DWErrors,
DWStatus,
DWPostDate,
DWPostPgm,
DWPostUser,
StatementField,
ReconciledDate,
RAnumber 
from openquery (bkl400, 
'select 
DEBNBR	 as DebitNbr,
STRNBR	 as StoreNbr,
RTNTO	 as ReturnTo,
SCNCODE	 as Scanned,
ASSOCID	 as UserID,
DEPTNBR	 as Dept,
REASON	 as ReasonforRtn,
TOTBOXS	 as StoreBoxes,
TOTITMS	 as StoreQty,
TOTRETL	 as StoreRetail,
TOTCOST	 as StoreCost,
SCNDAT	 as ScannedDate,
MMSBOXS	 as MMSBoxes,
MMSITMS	 as MMSQty,
MMSERRS	 as MMSErrors,
MMSSTAT	 as MMSStatus,
MMSDAT	 as MMSPostDate,
MMSPGM	 as MMSPostPgm,
MMSUSER	 as MMSPostUser,
DWBOXS	 as DWBoxes,
DWITMS	 as DWQty,
DWERRS	 as DWErrors,
DWSTAT	 as DWStatus,
DWDAT	 as DWPostDate,
DWPGM	 as DWPostPgm,
DWUSER	 as DWPostUser,
STATMNT	 as StatementField,
RCDAT	 as ReconciledDate,
RA#	     as RAnumber 
from MM4R4LIB.RTVTRNH')

create table TBLBYR(
BuyerNumber	varchar(3),
BuyerName	varchar(20),
StartDateCenturyCode	int,
StartDate	date,
TelExtension	varchar(4),
DWInit	varchar(3),
SrBuyerCode	varchar(3),
SrBuyerEmail	varchar(50),
AsstBuyerCode	varchar(3),
AsstBuyerEmail 	varchar(100)
)

insert into TBLBYR (
BuyerNumber,
BuyerName,
StartDateCenturyCode,
StartDate,
TelExtension,
DWInit,
SrBuyerCode,
SrBuyerEmail,
AsstBuyerCode,
AsstBuyerEmail 
)

select TOP 10 
BuyerNumber,
BuyerName,
StartDateCenturyCode,
StartDate,
TelExtension,
DWInit,
SrBuyerCode,
SrBuyerEmail,
AsstBuyerCode,
AsstBuyerEmail 
from openquery (bkl400, 
'select 
BYRNUM as BuyerNumber,
BYRNAM as BuyerName,
BYRSCN as StartDateCenturyCode,
varchar_format(timestamp_format(char(LPAD(BYRSDT,6,0)),''YYMMDD''),''YYMMDD'') as StartDate,
BYREXT as TelExtension,
BYRDWI as DWInit,
BYRSBC as SrBuyerCode,
BYRSEM as SrBuyerEmail,
BYRASC as AsstBuyerCode,
BYRASM as AsstBuyerEmail 
from MM4R4LIB.TBLBYR')

create table INVCAL (
CalendarCentury	int,
Calendardate Date,
MerchandisingPeriod int,
WeeksintheMerchPd int,
WeeksintheMerchYr int,
MerchandisingYear	int,
DayofMerchandisingYear	int,
DayofMerchandisingWeek	int,
LiteralDateDescription	varchar(35),
MerchandisingCentury 	int
)

insert into INVCAL (
CalendarCentury,
Calendardate,--YMD
MerchandisingPeriod, --(01-13)
WeeksintheMerchPd, --(1-4)
WeeksintheMerchYr, --(1-52)
MerchandisingYear,
DayofMerchandisingYear,
DayofMerchandisingWeek,
LiteralDateDescription,
MerchandisingCentury 
)

select TOP 10 
CalendarCentury,
Calendardate,--YMD
MerchandisingPeriod, --(01-13)
WeeksintheMerchPd, --(1-4)
WeeksintheMerchYr, --(1-52)
MerchandisingYear,
DayofMerchandisingYear,
DayofMerchandisingWeek,
LiteralDateDescription,
MerchandisingCentury 
from openquery (bkl400, 
'select 
DATCEN	as CalendarCentury,
varchar_format(timestamp_format(char(LPAD(DATBAK,6,0)),''YYMMDD''),''YYMMDD'')  as Calendardate,
DATPER	as MerchandisingPeriod,
DATWKP	as WeeksintheMerchPd,
DATWKY	as WeeksintheMerchYr,
DATCYR	as MerchandisingYear,
DATCDY	as DayofMerchandisingYear,
DATDAY	as DayofMerchandisingWeek,
DATLIT	as LiteralDateDescription,
DATCCN	as MerchandisingCentury 
from MM4R4LIB.INVCAL')

create table PIE022(
CountIDNumber	int,
StoreNumber	int,
SkuNumber	int,
QtyCounted	int,
JDADepartment	int,
JDASubDepartment	int,
JDAClass	int,
JDASubClass	int,
BamDepartment	varchar(4),
BamCategory	varchar(4),
DateCounted	Date,
StockToQty	int,
OnHandQty	int,
RollBackOnHandQty	int,
AdjustmentQty	int,
DatePosted	Date,
TimePosted	Time,
PostedBy	varchar(10),
CurrentPrice	 DECIMAL	(9,2),
SkuType	varchar (2),
SkuStatus 	varchar (1)
)

insert into PIE022 (
CountIDNumber,
StoreNumber,
SkuNumber,
QtyCounted,
JDADepartment,
JDASubDepartment,
JDAClass,
JDASubClass,
BamDepartment,
BamCategory,
DateCounted,
StockToQty,
OnHandQty,
RollBackOnHandQty,
AdjustmentQty,
DatePosted,
TimePosted,
PostedBy,
CurrentPrice,
SkuType,
SkuStatus 
)

select TOP 10 
CountIDNumber,
StoreNumber,
SkuNumber,
QtyCounted,
JDADepartment,
JDASubDepartment,
JDAClass,
JDASubClass,
BamDepartment,
BamCategory,
DateCounted,
StockToQty,
OnHandQty,
RollBackOnHandQty,
AdjustmentQty,
DatePosted,
TimePosted,
PostedBy,
CurrentPrice,
SkuType,
SkuStatus 
from openquery (bkl400, 
'select 
CBCID	as COUNTIDNUMBER,
CBSTR	as STORENUMBER,
CBSKU	as SKUNUMBER,
CBQCNT	as QTYCOUNTED,
CBDEPT	as JDADEPARTMENT,
CBSDPT	as JDASUBDEPARTMENT,
CBCLAS	as JDACLASS,
CBSCLS	as JDASUBCLASS,
CBBDPT	as BAMDEPARTMENT,
CBBCTG	as BAMCATEGORY,
to_date(CHAR(CBXDAT), ''YYYYMMDD'') as DATECOUNTED,
CBSQTY	as STOCKTOQTY,
CBOQTY	as ONHANDQTY,
CBRQTY	as ROLLBACKONHANDQTY,
CBAQTY	as ADJUSTMENTQTY,
to_date(CHAR(CBPDAT), ''YYYYMMDD'') as DATEPOSTED,
time(to_date(digits(cast(CBPTIM as dec(6,0))),''HH24MISS'')) as TIMEPOSTED,
CBPBY	as POSTEDBY,
CBCPRC	as CURRENTPRICE,
CBTYPE	as SKUTYPE,
CBSTAT	as SKUSTATUS 
from MM4R4LIB.PIE022')

create table PRCPLN(
ItemNumber	int,
ChangeCodeLevel	varchar(1),
StoreNumber	int,
VendorNumber	int,
StyleNumber	varchar(15),
StartDateCentCode	int,
TheEffectiveDatePriceChange	Date,
ThePriceEventType 	int, --from field EVTPRD INVETP
ISCurrentStatus 	int, --Flag to give this records current status
PriceEventNo	int,
NewPrice	 DECIMAL	(9,2),
PriceMultiple	int,
MixMatchGroup	int,
BuyQuantity	int,
BuyValue	 DECIMAL	(5,2),
BuyValueType	varchar(1),
QtyEndValue	int,
QuantityBreak	varchar(1),
EndDateCentCode	int,
EndingDatePricingRecord	Date,
RecordType	int,
IsProcessed	varchar(1),
IsHistory	varchar(1),
NotifyStartCentCode	int,
NotifyStartDate	Date,
NotifyEndEndCent	int,
NotifyEndDate	Date,
ApplyCSDOverAD	varchar(1),
ApplyLocOverrideAD 	varchar(1)
)

insert into PRCPLN (
ItemNumber,
ChangeCodeLevel,
StoreNumber,
VendorNumber,
StyleNumber,
StartDateCentCode,
TheEffectiveDatePriceChange,
ThePriceEventType, --from field EVTPRD INVETP
ISCurrentStatus, --Flag to give this records current status
PriceEventNo,
NewPrice,
PriceMultiple,
MixMatchGroup,
BuyQuantity,
BuyValue,
BuyValueType,
QtyEndValue,
QuantityBreak,
EndDateCentCode,
EndingDatePricingRecord,
RecordType,
IsProcessed,
IsHistory,
NotifyStartCentCode,
NotifyStartDate,
NotifyEndEndCent,
NotifyEndDate,
ApplyCSDOverAD,
ApplyLocOverrideAD 
)
select TOP 10 
ItemNumber,
ChangeCodeLevel,
StoreNumber,
VendorNumber,
StyleNumber,
StartDateCentCode,
TheEffectiveDatePriceChange,
ThePriceEventType, --from field EVTPRD INVETP
ISCurrentStatus, --Flag to give this records current status
PriceEventNo,
NewPrice,
PriceMultiple,
MixMatchGroup,
BuyQuantity,
BuyValue,
BuyValueType,
QtyEndValue,
QuantityBreak,
EndDateCentCode,
EndingDatePricingRecord,
RecordType,
IsProcessed,
IsHistory,
NotifyStartCentCode,
NotifyStartDate,
NotifyEndEndCent,
NotifyEndDate,
ApplyCSDOverAD,
ApplyLocOverrideAD 
from openquery (bkl400, 
'select 
PLNITM	as ItemNumber,
PLNLVL	as ChangeCodeLevel,
PLNSTR	as StoreNumber,
PLNVND	as VendorNumber,
PLNSTY	as StyleNumber,
PLNCCN	as StartDateCentCode,
case PLNCCN 
when 0 then varchar_format(timestamp_format(char(PLNCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(PLNCDT,6,0)),''YYMMDD''),''YYMMDD'') end as TheEffectiveDatePriceChange,
PLNTYP	as ThePriceEventType,
PLNFLG	as ISCurrentStatus,
PLNEVT	as PriceEventNo,
PLNAMT	as NewPrice,
PLNMLT	as PriceMultiple,
PLNMXM	as MixMatchGroup,
PLNQTY	as BuyQuantity,
PLNQTV	as BuyValue,
PLNQTT	as BuyValueType,
PLNQND	as QtyEndValue,
PLNEQM	as QuantityBreak,
PLNACN	as EndDateCentCode,
case PLNACN 
when 0 then varchar_format(timestamp_format(char(PLNADT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(PLNADT,6,0)),''YYMMDD''),''YYMMDD'') end as EndingDatePricingRecord,
PLNREC	as RecordType,
PLNPYN	as IsProcessed,
PLNHST	as IsHistory,
PLNNCN	as NotifyStartCentCode,
case PLNNCN 
when 0 then varchar_format(timestamp_format(char(PLNNDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(PLNNDT,6,0)),''YYMMDD''),''YYMMDD'') end as NotifyStartDate,
PLNECN	as NotifyEndEndCent,
case PLNECN 
when 0 then varchar_format(timestamp_format(char(PLNEDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(PLNEDT,6,0)),''YYMMDD''),''YYMMDD'') end as NotifyEndDate,
PLNCOV	as ApplyCSDOverAD,
PLNLOV	as ApplyLocOverrideAD 
from MM4R4LIB.PRCPLN')

create table TBLSTR(
StoreNumber	int,
StoreName	varchar(30),
AddressLine1	varchar(35),
AddressLine2	varchar(35),
AddressLine3	varchar(35),
City	varchar(20),
ProvinceStateCode	varchar(4),
County	varchar(20),
Country	varchar(3),
Zip	varchar(10),
StorePhoneNo	varchar(18),
StoreFaxNo	varchar(18),
ShortName	varchar(8),
RegionNumber	int,
ManagersName	varchar(20),
CenturyCodeOpened	int,
DateOpened	Date,
RetailSqFtMtr	int,
OnInterface	varchar(1),
OpenSunday	varchar(1),
StoreOffice	varchar(1),
StoreBankAccount1	int,
WarehouseNumber	int,
DistrictNumber	int,
NCNewORComp	varchar(1),
StoreType	varchar(1),
PrintQueue	varchar(10),
GLCompanyNo	int,
CountryCode	varchar(3),
ActiveonGL	varchar(1),
ActiveonAP	varchar(1),
ActiveonAR	varchar(1),
LastMerchCountNumber	int,
ZoneNumber	int,
CostingMethod	varchar(1),
SalesAuditClerk	varchar(3),
ModelStoreCode	varchar(4),
AllowAPAllocation	varchar(1),
APAllocationFactor	 DECIMAL	(4,2),
ReplenishmentZne	int,
PromoMdlStKCde	varchar(4),
ReplenishmentOn	varchar(1),
CenturyCodeClosed	int,
DateClosed	Date,
FinancialAccount	int,
StoreBankAccount2	int,
SanNumber 	int
)

insert into TBLSTR (
StoreNumber,
StoreName,
AddressLine1,
AddressLine2,
AddressLine3,
City,
ProvinceStateCode,
County,
Country,
Zip,
StorePhoneNo,
StoreFaxNo,
ShortName,
RegionNumber,
ManagersName,
CenturyCodeOpened,
DateOpened,
RetailSqFtMtr,
OnInterface,
OpenSunday,
StoreOffice,
StoreBankAccount1,
WarehouseNumber,
DistrictNumber,
NCNewORComp,
StoreType,
PrintQueue,
GLCompanyNo,
CountryCode,
ActiveonGL,
ActiveonAP,
ActiveonAR,
LastMerchCountNumber,
ZoneNumber,
CostingMethod,
SalesAuditClerk,
ModelStoreCode,
AllowAPAllocation,
APAllocationFactor,
ReplenishmentZne,
PromoMdlStKCde,
ReplenishmentOn,
CenturyCodeClosed,
DateClosed,
FinancialAccount,
StoreBankAccount2,
SanNumber 
)
select TOP 10 
StoreNumber,
StoreName,
AddressLine1,
AddressLine2,
AddressLine3,
City,
ProvinceStateCode,
County,
Country,
Zip,
StorePhoneNo,
StoreFaxNo,
ShortName,
RegionNumber,
ManagersName,
CenturyCodeOpened,
DateOpened,
RetailSqFtMtr,
OnInterface,
OpenSunday,
StoreOffice,
StoreBankAccount1,
WarehouseNumber,
DistrictNumber,
NCNewORComp,
StoreType,
PrintQueue,
GLCompanyNo,
CountryCode,
ActiveonGL,
ActiveonAP,
ActiveonAR,
LastMerchCountNumber,
ZoneNumber,
CostingMethod,
SalesAuditClerk,
ModelStoreCode,
AllowAPAllocation,
APAllocationFactor,
ReplenishmentZne,
PromoMdlStKCde,
ReplenishmentOn,
CenturyCodeClosed,
DateClosed,
FinancialAccount,
StoreBankAccount2,
SanNumber 
from openquery (bkl400, 
'select 
STRNUM	as StoreNumber,
STRNAM	as StoreName,
STADD1	as AddressLine1,
STADD2	as AddressLine2,
STADD3	as AddressLine3,
STCITY	as City,
STPVST	as ProvinceStateCode,
STCNTY	as County,
STCTRY	as Country,
STZIP	as Zip,
STPHON	as StorePhoneNo,
STFAXN	as StoreFaxNo,
STSHRT	as ShortName,
REGNUM	as RegionNumber,
STMNGR	as ManagersName,
STSCEN	as CenturyCodeOpened,
case STSCEN 
when 0 then varchar_format(timestamp_format(char(STSDAT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(STSDAT,6,0)),''YYMMDD''),''YYMMDD'') end as DateOpened,
STRETL	as RetailSqFtMtr,
STPOLL	as OnInterface,
STSNDY	as OpenSunday,
STRHDO	as StoreOffice,
STBACT	as StoreBankAccount1,
STRWHS	as WarehouseNumber,
STRDST	as DistrictNumber,
STRCMP	as NCNewORComp,
STRTYP	as StoreType,
STOUTQ	as PrintQueue,
STCOMP	as GLCompanyNo,
STCNTR	as CountryCode,
STGLYN	as ActiveonGL,
STAPYN	as ActiveonAP,
STARYN	as ActiveonAR,
STLCN#	as LastMerchCountNumber,
ZONNUM	as ZoneNumber,
STAVGC	as CostingMethod,
STSCLK	as SalesAuditClerk,
STMSTK	as ModelStoreCode,
STAYES	as AllowAPAllocation,
STAFCT	as APAllocationFactor,
RPLZN	as ReplenishmentZne,
STPRMS	as PromoMdlStKCde,
STRPON	as ReplenishmentOn,
STCLCN	as CenturyCodeClosed,
case STCLCN 
when 0 then varchar_format(timestamp_format(char(STCLDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(STCLDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateClosed,
STFACT	as FinancialAccount,
STBANK	as StoreBankAccount2,
SAN#	as SanNumber
from MM4R4LIB.TBLSTR')

Create table TBLSTRA (
StoreNumber	int,
AttributeCode	varchar(25),
AttributeValue1	varchar(35),
AttributeValue2	varchar(35),
AttributeValue3	varchar(35),
AttributeValue4	varchar(35),
AttributeValue5	varchar(35),
AttributeValue6	varchar(35),
AttributeValue7	varchar(35),
EffectiveDate	Date,
EndDate 	Date
)

insert into TBLSTRA (
StoreNumber,
AttributeCode,
AttributeValue1,
AttributeValue2,
AttributeValue3,
AttributeValue4,
AttributeValue5,
AttributeValue6,
AttributeValue7,
EffectiveDate,
EndDate 
)

select TOP 10 
StoreNumber,
AttributeCode,
AttributeValue1,
AttributeValue2,
AttributeValue3,
AttributeValue4,
AttributeValue5,
AttributeValue6,
AttributeValue7,
EffectiveDate,
EndDate 
from openquery (bkl400, 
'select 
STRNUM	as StoreNumber,
STRATT	as AttributeCode,
STRA01	as AttributeValue1,
STRA02	as AttributeValue2,
STRA03	as AttributeValue3,
STRA04	as AttributeValue4,
STRA05	as AttributeValue5,
STRA06	as AttributeValue6,
STRA07	as AttributeValue7,
varchar_format(timestamp_format(char(LPAD(STEFDT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as EffectiveDate,
varchar_format(timestamp_format(char(LPAD(STENDT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as EndDate 
from MM4R4LIB.TBLSTRA')

CREATE TABLE TBLSTRE (
CompStoreNumber int,
CenturyCodeComp int,
CompDate date
)

INSERT INTO TBLSTRE (
CompStoreNumber,
CenturyCodeComp,
CompDate 
)

select TOP 10 
CompStoreNumber,
CenturyCodeComp,
CompDate 
from openquery (bkl400, 
'select 
CMPNUM as CompStoreNumber,
CMPCEN as CenturyCodeComp,
case CMPCEN 
when 0 then varchar_format(timestamp_format(char(CMPDAT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(CMPDAT,6,0)),''YYMMDD''),''YYMMDD'') end as CompDate 
from MM4R4LIB.TBLSTRE')

create table PIESCH (
StoreNumber	int,
Countdate	date,
TypeCode	varchar(1),
CountID	int,
Polled	varchar(1),
Posted	varchar(1),
ErrorFlag	varchar(1),
ChangedbyUserId varchar(10),
ChangedDate	date,
SummaryFlag	varchar(1),
FinalReportSent 	varchar(1)
)

insert into PIESCH (
StoreNumber,
Countdate,
TypeCode,
CountID,
Polled,
Posted,
ErrorFlag,
ChangedbyUserId,
ChangedDate,
SummaryFlag,
FinalReportSent 
)

select TOP 10 
StoreNumber,
Countdate,
TypeCode,
CountID,
Polled,
Posted,
ErrorFlag,
ChangedbyUserId,
ChangedDate,
SummaryFlag,
FinalReportSent 
from openquery (bkl400, 
'select 
STRNUM	as StoreNumber,
varchar_format(timestamp_format(char(LPAD(CNTDAT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as Countdate,
TCODE	as TypeCode,
CNTID	as CountID,
POLLED	as Polled,
POSTED	as Posted,
ERRFLG	as ErrorFlag,
USERID	as ChangedbyUserId,
varchar_format(timestamp_format(char(LPAD(CHGDTE,8,0)),''YYYYMMDD''),''YYYYMMDD'') as ChangedDate,
SUMFLG	as SummaryFlag,
FINRPT	as FinalReportSent 
from MM4R4LIB.PIESCH')

create table APLUS2FAW.VENDR(
VendorNumber	varchar(6),
VendorName	varchar(30),
VendorAddressLine1	varchar(30),
VendorAddressLine2	varchar(30),
VendorCity	varchar(20),
VendorStateProvince	varchar(30),
VendorZipCode	varchar(10),
TelephoneNumber	varchar(12),
VendorContact	varchar(25),
Terms	varchar(20),
StandardShipVia	varchar(20),
StandardFOB	varchar(20),
MinimumOrderValue	 DECIMAL	(9,2),
MinimumWeight	 DECIMAL	(13,4),
OrderCycleCode	varchar(2),
Century	int,
LastPODate	Date,
LeadTime	time,
SafetyStockPercent	 DECIMAL	(5,3),
Assignee	varchar(6),
StandardDiscountPercent	 DECIMAL	(4,2),
BuyerInitial	varchar(3),
PayDays	int,
AllowPOs	varchar(1),
CharacterFillerField3	varchar(3),
OurItemorMfgItemorBoth	varchar(1),
InUseWS	varchar(8),
CharacterUserArea15	varchar(15),
ReservedArea30Character	varchar(30),
MinimumCubes	 DECIMAL	(13,5),
VendorAddressLine3	varchar(30),
CountryCode	varchar(3),
CountryId	varchar(3),
TradingCurrencyFlag	varchar(1),
RebateMethod	varchar(1),
TradingPartnerId	varchar(15),
EDIPO	varchar(1),
PrintPO	varchar(1),
HoldEDIPO	varchar(1),
FaxCountryCode	varchar(3),
FaxAreaCode	int,
FaxPhoneNumber int,
FaxPhoneExtension	int,
NickName	varchar(10),
FaxPurchaseOrders	varchar(1),
UserField1	varchar(5),
UserField2	varchar(5),
UserField3	varchar(5),
UserField4	varchar(5),
UserField5	varchar(5),
UserField6	varchar(5),
LeadTimeFlag	varchar(1),
UpdatePriceCatalog	varchar(1),
AllowMultiShiptoPOs	varchar(1),
FreightTermsCode	varchar(1),
VolumeDiscCalcMethod	varchar(1),
MinimumUnits	 DECIMAL	(10,3),
OrderingFrequency	 DECIMAL	(3,1),
FaxRFQ	varchar(1),
PrintVendorRFQ	varchar(1),
VendorAddressLine4	varchar(30),
PhoneNumber	varchar(20),
VendFaxPhoneNumber	varchar(20),
FOBCode	varchar(5),
PhoneExtension	int,
ReceiptValidation810	varchar(1),
EmailPurchaseOrders	varchar(1),
EmailRFQ	varchar(1),
ModeofTransport  	varchar(2)
)

insert into APLUS2FAW.VENDR(
VendorNumber,
VendorName,
VendorAddressLine1,
VendorAddressLine2,
VendorCity,
VendorStateProvince,
VendorZipCode,
TelephoneNumber,
VendorContact,
Terms,
StandardShipVia,
StandardFOB,
MinimumOrderValue,
MinimumWeight,
OrderCycleCode,
Century,
LastPODate,
LeadTime,
SafetyStockPercent,
Assignee,
StandardDiscountPercent,
BuyerInitial,
PayDays,
AllowPOs,
CharacterFillerField3,
OurItemorMfgItemorBoth,
InUseWS,
CharacterUserArea15,
ReservedArea30Character,
MinimumCubes,
VendorAddressLine3,
CountryCode,
CountryId,
TradingCurrencyFlag,
RebateMethod,
TradingPartnerId,
EDIPO,
PrintPO,
HoldEDIPO,
FaxCountryCode,
FaxAreaCode,
FaxPhoneNumber,
FaxPhoneExtension,
NickName,
FaxPurchaseOrders,
UserField1,
UserField2,
UserField3,
UserField4,
UserField5,
UserField6,
LeadTimeFlag,
UpdatePriceCatalog,
AllowMultiShiptoPOs,
FreightTermsCode,
VolumeDiscCalcMethod,
MinimumUnits,
OrderingFrequency,
FaxRFQ,
PrintVendorRFQ,
VendorAddressLine4,
PhoneNumber,
VendFaxPhoneNumber,
FOBCode,
PhoneExtension,
ReceiptValidation810,
EmailPurchaseOrders,
EmailRFQ,
ModeofTransport  
)

select 
VendorNumber,
VendorName,
VendorAddressLine1,
VendorAddressLine2,
VendorCity,
VendorStateProvince,
VendorZipCode,
TelephoneNumber,
VendorContact,
Terms,
StandardShipVia,
StandardFOB,
MinimumOrderValue,
MinimumWeight,
OrderCycleCode,
Century,
LastPODate,
LeadTime,
SafetyStockPercent,
Assignee,
StandardDiscountPercent,
BuyerInitial,
PayDays,
AllowPOs,
CharacterFillerField3,
OurItemorMfgItemorBoth,
InUseWS,
CharacterUserArea15,
ReservedArea30Character,
MinimumCubes,
VendorAddressLine3,
CountryCode,
CountryId,
TradingCurrencyFlag,
RebateMethod,
TradingPartnerId,
EDIPO,
PrintPO,
HoldEDIPO,
FaxCountryCode,
FaxAreaCode,
FaxPhoneNumber,
FaxPhoneExtension,
NickName,
FaxPurchaseOrders,
UserField1,
UserField2,
UserField3,
UserField4,
UserField5,
UserField6,
LeadTimeFlag,
UpdatePriceCatalog,
AllowMultiShiptoPOs,
FreightTermsCode,
VolumeDiscCalcMethod,
MinimumUnits,
OrderingFrequency,
FaxRFQ,
PrintVendorRFQ,
VendorAddressLine4,
PhoneNumber,
VendFaxPhoneNumber,
FOBCode,
PhoneExtension,
ReceiptValidation810,
EmailPurchaseOrders,
EmailRFQ,
ModeofTransport  
from openquery (bkl400, 
'select 
PVVNNO	as VendorNumber,
PVVNNM	as VendorName,
PVVAD1	as VendorAddressLine1,
PVVAD2	as VendorAddressLine2,
PVVCTY	as VendorCity,
PVVNST	as VendorStateProvince,
PVVZIP	as VendorZipCode,
PVPH12	as TelephoneNumber,
PVVCNT	as VendorContact,
PVTERM	as Terms,
PVSSVI	as StandardShipVia,
PVSTFB	as StandardFOB,
PVMOVL	as MinimumOrderValue,
PVMNWT	as MinimumWeight,
PVCYCL	as OrderCycleCode,
PVLPCC	as Century,
case PVLPCC 
when 19 then varchar_format(timestamp_format(char(PVLPOD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PVLPOD,6,0)),''YYMMDD''),''YYMMDD'') end as LastPODate,
time(to_date(digits(cast(PVLDTM as dec(6,0))),''HH24MISS'')) 	as LeadTime,
PVSSTP	as SafetyStockPercent,
PVASGN	as Assignee,
PVSTDS	as StandardDiscountPercent,
PVBUYR	as BuyerInitial,
PVPAYD	as PayDays,
PVALPO	as AllowPOs,
PVFL03	as CharacterFillerField3,
PVITMP	as OurItemorMfgItemorBoth,
PVINUS	as InUseWS,
PVUS15	as CharacterUserArea15,
PVRS30	as ReservedArea30Character,
PVMNCB	as MinimumCubes,
PVVAD3	as VendorAddressLine3,
PVCTCD	as CountryCode,
PVCTID	as CountryId,
PVTRFG	as TradingCurrencyFlag,
PVRBMT	as RebateMethod,
PVTPID	as TradingPartnerId,
PVEIPO	as EDIPO,
PVPRPO	as PrintPO,
PVEIPH	as HoldEDIPO,
PVFXCN	as FaxCountryCode,
PVFXAC	as FaxAreaCode,
PVFXPH	as FaxPhoneNumber,
PVFXEX	as FaxPhoneExtension,
PVNKNM	as NickName,
PVFXPO	as FaxPurchaseOrders,
PVUS5A	as UserField1,
PVUS5B	as UserField2,
PVUS5C	as UserField3,
PVUS5D	as UserField4,
PVUS5E	as UserField5,
PVUS5F	as UserField6,
PVLDFG	as LeadTimeFlag,
PVUPCT	as UpdatePriceCatalog,
PVAMSP	as AllowMultiShiptoPOs,
PVFTCD	as FreightTermsCode,
PVVDMT	as VolumeDiscCalcMethod,
PVMNUN	as MinimumUnits,
PVORFR	as OrderingFrequency,
PVFXRQ	as FaxRFQ,
PVPRRQ	as PrintVendorRFQ,
PVVAD4	as VendorAddressLine4,
PVPHNO	as PhoneNumber,
PVFAX   as VendFaxPhoneNumber,
PVFOBC	as FOBCode,
PVPHEX  as PhoneExtension,
PVRVYN	as ReceiptValidation810,
PVEMPO	as EmailPurchaseOrders,
PVEMRQ	as EmailRFQ,
PVMDTP	as ModeofTransport 
from APLUS2FAW.VENDR')

create table APLUS2FAW.CSRSV(
CompanyNumber	int,
CustomerNumber	int,
WarehouseID	varchar(2),
ItemNumber	varchar(27),
QuantityReserved	 DECIMAL	(10,3),
UnitofMeasure	varchar(3),
ExpireDateCnty	int,
ExpireDate	Date,
LastMaintDateCnty	int,
LastMaintDate	Date,
LastMaintUser	varchar(10),
LastMaintTime 	time
)

insert into APLUS2FAW.CSRSV(
CompanyNumber,
CustomerNumber,
WarehouseID,
ItemNumber,
QuantityReserved,
UnitofMeasure,
ExpireDateCnty,
ExpireDate,
LastMaintDateCnty,
LastMaintDate,
LastMaintUser,
LastMaintTime 
)

select 
CompanyNumber,
CustomerNumber,
WarehouseID,
ItemNumber,
QuantityReserved,
UnitofMeasure,
ExpireDateCnty,
ExpireDate,
LastMaintDateCnty,
LastMaintDate,
LastMaintUser,
LastMaintTime 
from openquery (bkl400, 
'select 
RVCONO	as CompanyNumber,
RVCSNO	as CustomerNumber,
RVWHID	as WarehouseID,
RVITNO	as ItemNumber,
RVRSQT	as QuantityReserved,
RVUNMS	as UnitofMeasure,
RVRVCC	as ExpireDateCnty,
case RVRVCC 
when 19 then varchar_format(timestamp_format(char(RVRVDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(RVRVDT,6,0)),''YYMMDD''),''YYMMDD'') end as ExpireDate,
RVLMCC	as LastMaintDateCnty,
case RVLMCC 
when 19 then varchar_format(timestamp_format(char(RVLMDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(RVLMDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastMaintDate,
ltrim(rtrim(RVCGUS))	as LastMaintUser,
time(to_date(digits(cast(RVCHTM as dec(6,0))),''HH24MISS'')) as LastMaintTime 
from APLUS2FAW.CSRSV')

create table APLUS2FAW.HSDET(
CompanyNumber	int,
CustomerNumber	int,
OrderNumber	varchar(5),
OrderGenerationNumber	int,
HistorySequenceNumber	int,
OrderSequenceNumber	int,
LineItemType	varchar(1),
ShipToNumber	varchar(7),
PrimarySalesmanNumber	int,
WarehouseID	varchar(2),
OrderType	varchar(1),
PriceList	int,
OrderHoldCode	varchar(2),
Century1	int,
RequestDate	date,
LotCode	varchar(10),
ItemNumber	varchar(27),
ItemDescription1	varchar(31),
ItemDescription2	varchar(31),
QuantityOrdered	 DECIMAL	(10,3),
QuantityShipped	 DECIMAL	(10,3),
QuantityBackordered	 DECIMAL	(10,3),
UnitofMeasure	varchar(3),
UMCode	varchar(1),
ItemClass	varchar(2),
ItemSubclass	varchar(2),
NonStockCode	varchar(1),
ListPrice	 DECIMAL	(11,5),
ItemDiscountPercent	 DECIMAL	(5,2),
FinalPriceOverrideCode	varchar(1),
QtyDscType 	varchar(1), --(I=ItemC=Classblank=none)
CharacterFillerField1	varchar(1),
AdditionalDiscountPercent	 DECIMAL	(5,2),
ActualSellPrice	 DECIMAL	(11,5),
TotalLineAmount	 DECIMAL	(9,2),
LotChargeCode	varchar(1),
SystemTotalLineAmount	 DECIMAL	(9,2),
Pricing	varchar(3),
TaxableCode	varchar(1),
TaxExemptCode	varchar(1),
ContainerCharge	 DECIMAL	(11,5),
FederalExciseTaxAmount	 DECIMAL	(7,2),
AllowCashDiscountCode	varchar(1),
WarehouseLocation	varchar(8),
CurrentAverageCost	 DECIMAL	(11,5),
OurPurchaseOrderNumber	varchar(6),
AllocatedCode	varchar(1),
LineValue	 DECIMAL	(9,2),
CostOverrideCode	varchar(1),
InvoiceCost	 DECIMAL	(9,2),
UnitWeight	 DECIMAL	(9,4),
ExtendedWeight	 DECIMAL	(11,4),
DropShipCode	varchar(1),
ReUsableCode	varchar(1),
KitBuildQuantity	 DECIMAL	(10,3),
GeneralLedgerAccountNumber	int,
QuantityBreakClass	varchar(3),
DiscountMarkupCode1	varchar(1),
OrderEntrySequence	int,
Century2	int,
InvoiceDate	Date,
PriceClass	int,
ContractCode	varchar(1),
CustomerSortWord	varchar(10),
ItemQuantityDiscount	 DECIMAL	(11,5),
UserArea	varchar(10),
BillofMaterialsCode	varchar(1),
ItemDescPrintCode	varchar(1),
ItemGLCode	varchar(2),
SpecialOrderSequence	varchar(5),
InsertInProgressFlag	varchar(1),
AssignedComplete	varchar(1),
WHMgmtCode	varchar(1),
CharacterFillerField2	varchar(2),
ParentOrderNumber	int,
EntrySequenceNumber	int,
OriginalQuantity	 DECIMAL	(10,3),
OriginalItemNumber	varchar(27),
ReplacementReasonCode	varchar(1),
OriginalWarehouse	varchar(2),
ReturnReasonCode	varchar(2),
InvoicePrintSequence	varchar(7),
ProcuctRestrictionCode	varchar(6),
CommissionCost	 DECIMAL	(11,5),
RebateId	varchar(10),
InventoryCost	 DECIMAL	(11,5),
RebateVendorNumber	varchar(6),
RebatePending	varchar(1),
CustomerOrder	varchar(3),
DocumentNumber	varchar(10),
EDILineReferenceNumber	varchar(11),
CustomerOrderQuantity	 DECIMAL	(10,3),
CustomerPricing	varchar(3),
OriginalParOrderNumber	int,
OriginalEntrySeqNmbr	int,
LineItemTaxAmount	 DECIMAL	(9,2),
OrderTaxAmount	 DECIMAL	(9,2),
ConsolidatedBillCode	varchar(2),
ConsolidatedInvControlNumber	int,
ConsolidatedInvPrtFlag	varchar(1),
ItemContractCode	varchar(4),
InventoryPostedFlag	varchar(1),
ReturntoVendorLogNumber	int,
DaysinProcessType 	varchar(1)
)

insert into APLUS2FAW.HSDET (
CompanyNumber,
CustomerNumber,
OrderNumber,
OrderGenerationNumber,
HistorySequenceNumber,
OrderSequenceNumber,
LineItemType,
ShipToNumber,
PrimarySalesmanNumber,
WarehouseID,
OrderType,
PriceList,
OrderHoldCode,
Century1,
RequestDate,
LotCode,
ItemNumber,
ItemDescription1,
ItemDescription2,
QuantityOrdered,
QuantityShipped,
QuantityBackordered,
UnitofMeasure,
UMCode,
ItemClass,
ItemSubclass,
NonStockCode,
ListPrice,
ItemDiscountPercent,
FinalPriceOverrideCode,
QtyDscType, --(I=Item,C=Class,blank=none)
CharacterFillerField1,
AdditionalDiscountPercent,
ActualSellPrice,
TotalLineAmount,
LotChargeCode,
SystemTotalLineAmount,
Pricing,
TaxableCode,
TaxExemptCode,
ContainerCharge,
FederalExciseTaxAmount,
AllowCashDiscountCode,
WarehouseLocation,
CurrentAverageCost,
OurPurchaseOrderNumber,
AllocatedCode,
LineValue,
CostOverrideCode,
InvoiceCost,
UnitWeight,
ExtendedWeight,
DropShipCode,
ReUsableCode,
KitBuildQuantity,
GeneralLedgerAccountNumber,
QuantityBreakClass,
DiscountMarkupCode1,
OrderEntrySequence,
Century2,
InvoiceDate,
PriceClass,
ContractCode,
CustomerSortWord,
ItemQuantityDiscount,
UserArea,
BillofMaterialsCode,
ItemDescPrintCode,
ItemGLCode,
SpecialOrderSequence,
InsertInProgressFlag,
AssignedComplete,
WHMgmtCode,
CharacterFillerField2,
ParentOrderNumber,
EntrySequenceNumber,
OriginalQuantity,
OriginalItemNumber,
ReplacementReasonCode,
OriginalWarehouse,
ReturnReasonCode,
InvoicePrintSequence,
ProcuctRestrictionCode,
CommissionCost,
RebateId,
InventoryCost,
RebateVendorNumber,
RebatePending,
CustomerOrder,
DocumentNumber,
EDILineReferenceNumber,
CustomerOrderQuantity,
CustomerPricing,
OriginalParOrderNumber,
OriginalEntrySeqNmbr,
LineItemTaxAmount,
OrderTaxAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
ItemContractCode,
InventoryPostedFlag,
ReturntoVendorLogNumber,
DaysinProcessType
)

select TOP 10 
CompanyNumber,
CustomerNumber,
OrderNumber,
OrderGenerationNumber,
HistorySequenceNumber,
OrderSequenceNumber,
LineItemType,
ShipToNumber,
PrimarySalesmanNumber,
WarehouseID,
OrderType,
PriceList,
OrderHoldCode,
Century1,
RequestDate,
LotCode,
ItemNumber,
ItemDescription1,
ItemDescription2,
QuantityOrdered,
QuantityShipped,
QuantityBackordered,
UnitofMeasure,
UMCode,
ItemClass,
ItemSubclass,
NonStockCode,
ListPrice,
ItemDiscountPercent,
FinalPriceOverrideCode,
QtyDscType, --(I=Item,C=Class,blank=none)
CharacterFillerField1,
AdditionalDiscountPercent,
ActualSellPrice,
TotalLineAmount,
LotChargeCode,
SystemTotalLineAmount,
Pricing,
TaxableCode,
TaxExemptCode,
ContainerCharge,
FederalExciseTaxAmount,
AllowCashDiscountCode,
WarehouseLocation,
CurrentAverageCost,
OurPurchaseOrderNumber,
AllocatedCode,
LineValue,
CostOverrideCode,
InvoiceCost,
UnitWeight,
ExtendedWeight,
DropShipCode,
ReUsableCode,
KitBuildQuantity,
GeneralLedgerAccountNumber,
QuantityBreakClass,
DiscountMarkupCode1,
OrderEntrySequence,
Century2,
InvoiceDate,
PriceClass,
ContractCode,
CustomerSortWord,
ItemQuantityDiscount,
UserArea,
BillofMaterialsCode,
ItemDescPrintCode,
ItemGLCode,
SpecialOrderSequence,
InsertInProgressFlag,
AssignedComplete,
WHMgmtCode,
CharacterFillerField2,
ParentOrderNumber,
EntrySequenceNumber,
OriginalQuantity,
OriginalItemNumber,
ReplacementReasonCode,
OriginalWarehouse,
ReturnReasonCode,
InvoicePrintSequence,
ProcuctRestrictionCode,
CommissionCost,
RebateId,
InventoryCost,
RebateVendorNumber,
RebatePending,
CustomerOrder,
DocumentNumber,
EDILineReferenceNumber,
CustomerOrderQuantity,
CustomerPricing,
OriginalParOrderNumber,
OriginalEntrySeqNmbr,
LineItemTaxAmount,
OrderTaxAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
ItemContractCode,
InventoryPostedFlag,
ReturntoVendorLogNumber,
DaysinProcessType 
from openquery (bkl400, 
'select 
OBCONO	as CompanyNumber,
OBCSNO	as CustomerNumber,
OBORNO	as OrderNumber,
OBORGN	as OrderGenerationNumber,
OBHSSQ	as HistorySequenceNumber,
OBORSQ	as OrderSequenceNumber,
OBLITP	as LineItemType,
OBSHP#	as ShipToNumber,
OBSLNO	as PrimarySalesmanNumber,
OBWHID	as WarehouseID,
OBORTP	as OrderType,
OBPRLS	as PriceList,
OBOHLD	as OrderHoldCode,
OBRQCC	as Century1,
case OBRQCC 
when 19 then varchar_format(timestamp_format(char(OBRQDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OBRQDT,6,0)),''YYMMDD''),''YYMMDD'') end as RequestDate,
OBLTCD	as LotCode,
OBITNO	as ItemNumber,
OBITD1	as ItemDescription1,
OBITD2	as ItemDescription2,
OBQTOR	as QuantityOrdered,
OBQTSH	as QuantityShipped,
OBBOQT	as QuantityBackordered,
OBUNMS	as UnitofMeasure,
OBUMCD	as UMCode,
OBITCL	as ItemClass,
OBITSC	as ItemSubclass,
OBNOST	as NonStockCode,
OBLSPR	as ListPrice,
OBDSCP	as ItemDiscountPercent,
OBFPOC	as FinalPriceOverrideCode,
OBQDST	as QtyDscType, --(I=Item,C=Class,blank=none)
OBFL01	as CharacterFillerField1,
OBADSP	as AdditionalDiscountPercent,
OBASLP	as ActualSellPrice,
OBLNAM	as TotalLineAmount,
OBLTCH	as LotChargeCode,
OBSYAM	as SystemTotalLineAmount,
OBPRUM	as Pricing,
OBTXCD	as TaxableCode,
OBEXMT	as TaxExemptCode,
OBCNCH	as ContainerCharge,
OBFETX	as FederalExciseTaxAmount,
OBACDC	as AllowCashDiscountCode,
OBWHLC	as WarehouseLocation,
OBCAVC	as CurrentAverageCost,
OBOUPR	as OurPurchaseOrderNumber,
OBALCD	as AllocatedCode,
OBLNVL	as LineValue,
OBCOVC	as CostOverrideCode,
OBCSTX	as InvoiceCost,
OBUNWT	as UnitWeight,
OBEXWT	as ExtendedWeight,
OBDRSH	as DropShipCode,
OBREUS	as ReUsableCode,
OBBLQT	as KitBuildQuantity,
OBACNO	as GeneralLedgerAccountNumber,
OBQBCL	as QuantityBreakClass,
OBDSMR	as DiscountMarkupCode1,
OBENSQ	as OrderEntrySequence,
OBIVCC	as Century2,
case OBIVCC 
when 19 then varchar_format(timestamp_format(char(OBIVDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OBIVDT,6,0)),''YYMMDD''),''YYMMDD'') end as InvoiceDate,
OBPRCL	as PriceClass,
OBCNCD	as ContractCode,
OBCSRT	as CustomerSortWord,
OBIQDS	as ItemQuantityDiscount,
OBUS10	as UserArea,
OBBMCD	as BillofMaterialsCode,
OBITDP	as ItemDescPrintCode,
OBITGL	as ItemGLCode,
OBSOSQ	as SpecialOrderSequence,
OBIIPG	as InsertInProgressFlag,
OBASCM	as AssignedComplete,
OBWMCD	as WHMgmtCode,
OBFL02	as CharacterFillerField2,
OBPROR	as ParentOrderNumber,
OBETSQ	as EntrySequenceNumber,
OBOGQT	as OriginalQuantity,
OBORIT	as OriginalItemNumber,
OBRRCD	as ReplacementReasonCode,
OBORWH	as OriginalWarehouse,
OBRTRC	as ReturnReasonCode,
OBIPSQ	as InvoicePrintSequence,
OBRSCD	as ProcuctRestrictionCode,
OBCMCS	as CommissionCost,
OBRBID	as RebateId,
OBINCS	as InventoryCost,
OBRBVN	as RebateVendorNumber,
OBRBPN	as RebatePending,
OBCOUM	as CustomerOrder,
OBDOCN	as DocumentNumber,
OBELR#	as EDILineReferenceNumber,
OBCQTO	as CustomerOrderQuantity,
OBCPUM	as CustomerPricing,
OBOPAR	as OriginalParOrderNumber,
OBOESQ	as OriginalEntrySeqNmbr,
OBLTXA	as LineItemTaxAmount,
OBOTXA	as OrderTaxAmount,
OBCBCD	as ConsolidatedBillCode,
OBCICT	as ConsolidatedInvControlNumber,
OBCIPF	as ConsolidatedInvPrtFlag,
OBITCT	as ItemContractCode,
OBINVP	as InventoryPostedFlag,
OBRTVL	as ReturntoVendorLogNumber,
OBDIPT	as DaysinProcessType
from APLUS2FAW.HSDET')

create table APLUS2FAW.HSHED(
HistorySequenceNumber	int,
CustomerNumber	int,
CompanyNumber	int,
OrderNumber	varchar(5),
OrderGenerationNumber	int,
OrderType	varchar(1),
ShipToNumber	varchar(7),
EntryDate	Date,
AcknowledgementPrintDate	Date,
PickSlipPrintDate	Date,
ShipConfirmDate	Date,
InvoicePrintDate	Date,
QuoteReviewDate	Date,
Route	varchar(4),
Stop	int,
CompleteShipCode	varchar(1),
BackorderCode	varchar(1),
PrintAcknowledgements	varchar(1),
RequestedShipDate	Date,
InvoiceDate	Date,
DueDate	Date,
NetDate	Date,
FutureDate	Date,
CustomerPurchaseOrderNumber	varchar(22),
ShippingInstructions	varchar(20),
CreditCardAuthorization	varchar(7),
CharacterFillerField4	varchar(4),
MiscellaneousNote	varchar(30),
PaymentTypeCode	varchar(2),
CreditCardNumber	varchar(18),
CCExpirationDateMonth int,
CCExpirationDateYear	int,
CashDiscountPercent	 DECIMAL	(5,3),
CashDiscountAmount	 DECIMAL	(9,2),
ARTermsCode	varchar(2),
InvoiceNumber	int,
OrderReferenceNumber	varchar(6),
ContractNumber	varchar(5),
CustomerPriceList	int,
PriceDiscountCode	int,
OverridePriceDiscountPercent	 DECIMAL	(5,2),
TradeDiscountPercent	 DECIMAL	(5,2),
WarehouseID	varchar(2),
AllocatedCode	varchar(1),
PrimarySalesman	int,
SecondSalesman	int,
ThirdSalesman	int,
CommissionPercentRepNumberOne	 DECIMAL	(5,3),
CommissionPercentRepNumberTwo	 DECIMAL	(5,3),
CommissionPercentRepNumberThree	 DECIMAL	(5,3),
HoldCode	varchar(2),
LastUsertoReleasethisOrder	varchar(8),
LastHoldCode	varchar(2),
PriorHoldCode	varchar(2),
OriginalUserId	varchar(8),
LastUserID	varchar(8),
NumberofItems	int,
NumberofSpecialCharges	int,
NumberofMessages	int,
ItemSalesAmount	 DECIMAL	(9,2),
TotalSpecialCharges	 DECIMAL	(9,2),
TradeDiscountAmount	 DECIMAL	(9,2),
SalesTaxAmount	 DECIMAL	(9,2),
FederalExciseAmount	 DECIMAL	(9,2),
TotalContainerCharge	 DECIMAL	(9,2),
InvoiceAmount	 DECIMAL	(9,2),
TaxBody	varchar(6),
SalesTaxPercent	 DECIMAL	(5,3),
ExemptCode	varchar(1),
FederalExciseTaxCode	varchar(1),
AmountSubjecttoTax	 DECIMAL	(9,2),
ItemExemptAmount1	 DECIMAL	(9,2),
ItemExemptAmount2	 DECIMAL	(9,2),
ItemExemptAmount3	 DECIMAL	(9,2),
DropShipAmount	 DECIMAL	(9,2),
DepositAmount	 DECIMAL	(9,2),
AccountsReceivableCustomerAmount	 DECIMAL	(9,2),
AmountTendered	 DECIMAL	(9,2),
TotalOrderValue	 DECIMAL	(9,2),
ExtendedOrderCost	 DECIMAL	(9,2),
NewOrderCode	varchar(1),
DropShipCode	varchar(1),
OrderSource	varchar(2),
CustomerGLCode	varchar(2),
ReturntoStock	varchar(1),
Territory	varchar(3),
CustomerClass	varchar(2),
CustomerSubclass	varchar(2),
AccountsReceivableCustomerNumber	int,
ShippedOrderWeight	 DECIMAL	(13,4),
UpdateAR	varchar(1),
CustomerSortWord	varchar(10),
CharacterUserArea15	varchar(15),
CharacterFillerField1	varchar(1),
ParentOrderNumber	int,
TotalCubesShipped	 DECIMAL	(9,3),
UpdateDemand	varchar(1),
CarrierCode	varchar(5),
PrintInvoices	varchar(1),
EDIOrderYorblank	varchar(1),
EDIInvoices	varchar(1),
EDIInvoiceStatus	varchar(1),
HoldEDIInvoices	varchar(1),
EDIInvoiceInUseWS	varchar(2),
EDIInvoiceCentury	int,
EDIInvoiceDateSent	Date,
EDIInvoiceTimeSent	Time,
EDIAcknowledgements	varchar(1),
EDIAcknowledgementStatus	varchar(1),
HoldEDIAcknwldgmnts	varchar(1),
EDIAckInUseWS	varchar(2),
EDIAcknowldgementCentury	int,
EDIAcknowldgementDateSent	Date,
EDIAcknowldgementTimeSent	Time,
EDIAdvanceShipnotice	varchar(1),
EDIASNStatus	varchar(1),
HoldEDIASN	varchar(1),
EDIASNInUseWS	varchar(2),
EDIASNCentury	int,
EDIASNDateSent	Date,
EDIASNTimeSent	Time,
EDIOrderCreateTime	Time,
FaxInvoices	varchar(1),
FaxAcknowledgements	varchar(1),
NickName	varchar(10),
CancelDateCent	int,
CancelDate	Date,
ShiptoGeoCode	 DECIMAL	(9,0),
GST	varchar(1),
GSTTaxPercent	 DECIMAL	(5,3),
GSTAmount	 DECIMAL	(9,2),
PSTYesNoCompounded	varchar(1),
PSTTaxPercent	 DECIMAL	(5,3),
PSTAmount	 DECIMAL	(9,2),
ConsolidatedBillCode	varchar(2),
ConsolidatedInvControlNumber	int,
ConsolidatedInvPrtFlag	varchar(1),
CustomerContractCode	varchar(4),
Century	int,
AllocationDate	Date,
ManualReleasedFutureOrder	varchar(1),
EntryTime	time,
EntryUser	varchar(10),
AcknowledgePrintTime	time,
AcknowledgePrintUser	varchar(10),
PickSlipPrintTime	Time,
PickSlipPrintUser	varchar(10),
ShipConfirmTime	time,
ShipConfirmUser	varchar(10),
InvoicePrintTime	time,
InvoicePrintUser	varchar(10),
PackerID	varchar(3),
PickerID	varchar(3),
DriverID	varchar(3),
FOBCode	varchar(5),
TaxExemptCertificateNumber	varchar(15),
ExpirationCentury	int,
ExpirationDate	Date,
ProNumber	varchar(20),
BillOfLadingNumber	varchar(20),
AllItemsBackOrderedFlag	varchar(1),
DaysinProcessCentry	int,
DaysinProcessDate	Date,
DaysinProcessTime	Time,
DayendCentry	int,
DayendDate	Date,
Department	varchar(5),
InternalVendorNumber	varchar(10),
EmailInvoices	varchar(1),
EmailAcknowledgements 	varchar(1)
)

insert into APLUS2FAW.HSHED (
HistorySequenceNumber,
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderType,
ShipToNumber,
EntryDate,
AcknowledgementPrintDate,
PickSlipPrintDate,
ShipConfirmDate,
InvoicePrintDate,
QuoteReviewDate,
Route,
Stop,
CompleteShipCode,
BackorderCode,
PrintAcknowledgements,
RequestedShipDate,
InvoiceDate,
DueDate,
NetDate,
FutureDate,
CustomerPurchaseOrderNumber,
ShippingInstructions,
CreditCardAuthorization,
CharacterFillerField4,
MiscellaneousNote,
PaymentTypeCode,
CreditCardNumber,
CCExpirationDateMonth,
CCExpirationDateYear,
CashDiscountPercent,
CashDiscountAmount,
ARTermsCode,
InvoiceNumber,
OrderReferenceNumber,
ContractNumber,
CustomerPriceList,
PriceDiscountCode,
OverridePriceDiscountPercent,
TradeDiscountPercent,
WarehouseID,
AllocatedCode,
PrimarySalesman,
SecondSalesman,
ThirdSalesman,
CommissionPercentRepNumberOne,
CommissionPercentRepNumberTwo,
CommissionPercentRepNumberThree,
HoldCode,
LastUsertoReleasethisOrder,
LastHoldCode,
PriorHoldCode,
OriginalUserId,
LastUserID,
NumberofItems,
NumberofSpecialCharges,
NumberofMessages,
ItemSalesAmount,
TotalSpecialCharges,
TradeDiscountAmount,
SalesTaxAmount,
FederalExciseAmount,
TotalContainerCharge,
InvoiceAmount,
TaxBody,
SalesTaxPercent,
ExemptCode,
FederalExciseTaxCode,
AmountSubjecttoTax,
ItemExemptAmount1,
ItemExemptAmount2,
ItemExemptAmount3,
DropShipAmount,
DepositAmount,
AccountsReceivableCustomerAmount,
AmountTendered,
TotalOrderValue,
ExtendedOrderCost,
NewOrderCode,
DropShipCode,
OrderSource,
CustomerGLCode,
ReturntoStock,
Territory,
CustomerClass,
CustomerSubclass,
AccountsReceivableCustomerNumber,
ShippedOrderWeight,
UpdateAR,
CustomerSortWord,
CharacterUserArea15,
CharacterFillerField1,
ParentOrderNumber,
TotalCubesShipped,
UpdateDemand,
CarrierCode,
PrintInvoices,
EDIOrderYorblank,
EDIInvoices,
EDIInvoiceStatus,
HoldEDIInvoices,
EDIInvoiceInUseWS,
EDIInvoiceCentury,
EDIInvoiceDateSent,
EDIInvoiceTimeSent,
EDIAcknowledgements,
EDIAcknowledgementStatus,
HoldEDIAcknwldgmnts,
EDIAckInUseWS,
EDIAcknowldgementCentury,
EDIAcknowldgementDateSent,
EDIAcknowldgementTimeSent,
EDIAdvanceShipnotice,
EDIASNStatus,
HoldEDIASN,
EDIASNInUseWS,
EDIASNCentury,
EDIASNDateSent,
EDIASNTimeSent,
EDIOrderCreateTime,
FaxInvoices,
FaxAcknowledgements,
NickName,
CancelDateCent,
CancelDate,
ShiptoGeoCode,
GST,
GSTTaxPercent,
GSTAmount,
PSTYesNoCompounded,
PSTTaxPercent,
PSTAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
CustomerContractCode,
Century,
AllocationDate,
ManualReleasedFutureOrder,
EntryTime,
EntryUser,
AcknowledgePrintTime,
AcknowledgePrintUser,
PickSlipPrintTime,
PickSlipPrintUser,
ShipConfirmTime,
ShipConfirmUser,
InvoicePrintTime,
InvoicePrintUser,
PackerID,
PickerID,
DriverID,
FOBCode,
TaxExemptCertificateNumber,
ExpirationCentury,
ExpirationDate,
ProNumber,
BillOfLadingNumber,
AllItemsBackOrderedFlag,
DaysinProcessCentry,
DaysinProcessDate,
DaysinProcessTime,
DayendCentry,
DayendDate,
Department,
InternalVendorNumber,
EmailInvoices,
EmailAcknowledgements 
)

select TOP 10 
HistorySequenceNumber,
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderType,
ShipToNumber,
EntryDate,
AcknowledgementPrintDate,
PickSlipPrintDate,
ShipConfirmDate,
InvoicePrintDate,
QuoteReviewDate,
Route,
Stop,
CompleteShipCode,
BackorderCode,
PrintAcknowledgements,
RequestedShipDate,
InvoiceDate,
DueDate,
NetDate,
FutureDate,
CustomerPurchaseOrderNumber,
ShippingInstructions,
CreditCardAuthorization,
CharacterFillerField4,
MiscellaneousNote,
PaymentTypeCode,
CreditCardNumber,
CCExpirationDateMonth,
CCExpirationDateYear,
CashDiscountPercent,
CashDiscountAmount,
ARTermsCode,
InvoiceNumber,
OrderReferenceNumber,
ContractNumber,
CustomerPriceList,
PriceDiscountCode,
OverridePriceDiscountPercent,
TradeDiscountPercent,
WarehouseID,
AllocatedCode,
PrimarySalesman,
SecondSalesman,
ThirdSalesman,
CommissionPercentRepNumberOne,
CommissionPercentRepNumberTwo,
CommissionPercentRepNumberThree,
HoldCode,
LastUsertoReleasethisOrder,
LastHoldCode,
PriorHoldCode,
OriginalUserId,
LastUserID,
NumberofItems,
NumberofSpecialCharges,
NumberofMessages,
ItemSalesAmount,
TotalSpecialCharges,
TradeDiscountAmount,
SalesTaxAmount,
FederalExciseAmount,
TotalContainerCharge,
InvoiceAmount,
TaxBody,
SalesTaxPercent,
ExemptCode,
FederalExciseTaxCode,
AmountSubjecttoTax,
ItemExemptAmount1,
ItemExemptAmount2,
ItemExemptAmount3,
DropShipAmount,
DepositAmount,
AccountsReceivableCustomerAmount,
AmountTendered,
TotalOrderValue,
ExtendedOrderCost,
NewOrderCode,
DropShipCode,
OrderSource,
CustomerGLCode,
ReturntoStock,
Territory,
CustomerClass,
CustomerSubclass,
AccountsReceivableCustomerNumber,
ShippedOrderWeight,
UpdateAR,
CustomerSortWord,
CharacterUserArea15,
CharacterFillerField1,
ParentOrderNumber,
TotalCubesShipped,
UpdateDemand,
CarrierCode,
PrintInvoices,
EDIOrderYorblank,
EDIInvoices,
EDIInvoiceStatus,
HoldEDIInvoices,
EDIInvoiceInUseWS,
EDIInvoiceCentury,
EDIInvoiceDateSent,
EDIInvoiceTimeSent,
EDIAcknowledgements,
EDIAcknowledgementStatus,
HoldEDIAcknwldgmnts,
EDIAckInUseWS,
EDIAcknowldgementCentury,
EDIAcknowldgementDateSent,
EDIAcknowldgementTimeSent,
EDIAdvanceShipnotice,
EDIASNStatus,
HoldEDIASN,
EDIASNInUseWS,
EDIASNCentury,
EDIASNDateSent,
EDIASNTimeSent,
EDIOrderCreateTime,
FaxInvoices,
FaxAcknowledgements,
NickName,
CancelDateCent,
CancelDate,
ShiptoGeoCode,
GST,
GSTTaxPercent,
GSTAmount,
PSTYesNoCompounded,
PSTTaxPercent,
PSTAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
CustomerContractCode,
Century,
AllocationDate,
ManualReleasedFutureOrder,
EntryTime,
EntryUser,
AcknowledgePrintTime,
AcknowledgePrintUser,
PickSlipPrintTime,
PickSlipPrintUser,
ShipConfirmTime,
ShipConfirmUser,
InvoicePrintTime,
InvoicePrintUser,
PackerID,
PickerID,
DriverID,
FOBCode,
TaxExemptCertificateNumber,
ExpirationCentury,
ExpirationDate,
ProNumber,
BillOfLadingNumber,
AllItemsBackOrderedFlag,
DaysinProcessCentry,
DaysinProcessDate,
DaysinProcessTime,
DayendCentry,
DayendDate,
Department,
InternalVendorNumber,
EmailInvoices,
EmailAcknowledgements 

from openquery (bkl400, 
'select 
OAHSSQ	as HistorySequenceNumber,
OACSNO	as CustomerNumber,
OACONO	as CompanyNumber,
OAORNO	as OrderNumber,
OAORGN	as OrderGenerationNumber,
OAORTP	as OrderType,
OASHP#	as ShipToNumber,
varchar_format(timestamp_format(char(LPAD(OAENTD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as EntryDate,
varchar_format(timestamp_format(char(LPAD(OAACDP,8,0)),''YYYYMMDD''),''YYYYMMDD'') as AcknowledgementPrintDate,
varchar_format(timestamp_format(char(LPAD(OAPSPD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as PickSlipPrintDate,
varchar_format(timestamp_format(char(LPAD(OASC9D,8,0)),''YYYYMMDD''),''YYYYMMDD'') as ShipConfirmDate,
varchar_format(timestamp_format(char(LPAD(OAINVD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as InvoicePrintDate,
varchar_format(timestamp_format(char(LPAD(OAQRVD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as QuoteReviewDate,
OAROUT	as Route,
OASTOP	as Stop,
OACSCD	as CompleteShipCode,
OABKCD	as BackorderCode,
OAPRAC	as PrintAcknowledgements,
varchar_format(timestamp_format(char(LPAD(OARQSD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as RequestedShipDate,
varchar_format(timestamp_format(char(LPAD(OAIPDT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as InvoiceDate,
varchar_format(timestamp_format(char(LPAD(OADEDT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as DueDate,
varchar_format(timestamp_format(char(LPAD(OANETD,8,0)),''YYYYMMDD''),''YYYYMMDD'') as NetDate,
varchar_format(timestamp_format(char(LPAD(OAFTDT,8,0)),''YYYYMMDD''),''YYYYMMDD'') as FutureDate,
OACSPO	as CustomerPurchaseOrderNumber,
OASPIN	as ShippingInstructions,
OACCAU	as CreditCardAuthorization,
OAFL04	as CharacterFillerField4,
OANOTE	as MiscellaneousNote,
OAPYTP	as PaymentTypeCode,
OACRCD	as CreditCardNumber,
substr(char(LPAD(OAEXPD,4,0)),1,2) as CCExpirationDateMonth,
substr(char(LPAD(OAEXPD,4,0)),3,4) as CCExpirationDateYear,
OACDSP	as CashDiscountPercent,
OACDAM	as CashDiscountAmount,
OATMCD	as ARTermsCode,
OAINNO	as InvoiceNumber,
OAORRF	as OrderReferenceNumber,
OACNNR	as ContractNumber,
OACPRL	as CustomerPriceList,
OACPRC	as PriceDiscountCode,
OAOVDP	as OverridePriceDiscountPercent,
OATDPC	as TradeDiscountPercent,
OAWHID	as WarehouseID,
OAALCD	as AllocatedCode,
OASLS1	as PrimarySalesman,
OASLS2	as SecondSalesman,
OASLS3	as ThirdSalesman,
OACPR1	as CommissionPercentRepNumberOne,
OACPR2	as CommissionPercentRepNumberTwo,
OACPR3	as CommissionPercentRepNumberThree,
OAHLCD	as HoldCode,
OALUSR	as LastUsertoReleasethisOrder,
OALSHL	as LastHoldCode,
OAPRHL	as PriorHoldCode,
OAORU8	as OriginalUserId,
OALUS8	as LastUserID,
OANOIT	as NumberofItems,
OANOSC	as NumberofSpecialCharges,
OANOMS	as NumberofMessages,
OAISAM	as ItemSalesAmount,
OASCAM	as TotalSpecialCharges,
OATDAM	as TradeDiscountAmount,
OATXAM	as SalesTaxAmount,
OAFEAM	as FederalExciseAmount,
OACNCT	as TotalContainerCharge,
OAINAM	as InvoiceAmount,
OATXBD	as TaxBody,
OATXPC	as SalesTaxPercent,
OAEXCD	as ExemptCode,
OAEXCS	as FederalExciseTaxCode,
OAASTX	as AmountSubjecttoTax,
OAEXM1	as ItemExemptAmount1,
OAEXM2	as ItemExemptAmount2,
OAEXM3	as ItemExemptAmount3,
OADSAM	as DropShipAmount,
OADPAM	as DepositAmount,
OAARC$	as AccountsReceivableCustomerAmount,
OATNAM	as AmountTendered,
OAORVL	as TotalOrderValue,
OAORCS	as ExtendedOrderCost,
OANWOR	as NewOrderCode,
OADRSH	as DropShipCode,
OAORSC	as OrderSource,
OACSGL	as CustomerGLCode,
OARTST	as ReturntoStock,
OATERT	as Territory,
OACSCL	as CustomerClass,
OACSSC	as CustomerSubclass,
OAARCN	as AccountsReceivableCustomerNumber,
OASHWT	as ShippedOrderWeight,
OAUPAR	as UpdateAR,
OACSRT	as CustomerSortWord,
OAUS15	as CharacterUserArea15,
OAFL01	as CharacterFillerField1,
OAPROR	as ParentOrderNumber,
OATCBS	as TotalCubesShipped,
OAUPDM	as UpdateDemand,
OACACD	as CarrierCode,
OAPRTI	as PrintInvoices,
OAEIOR	as EDIOrderYorblank,
OAEIIN	as EDIInvoices,
OAEINS	as EDIInvoiceStatus,
OAEIIH	as HoldEDIInvoices,
OAEIIW	as EDIInvoiceInUseWS,
OAEINC	as EDIInvoiceCentury,
case OAEINC 
when 0 then varchar_format(timestamp_format(char(OAEIND+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OAEIND,6,0)),''YYMMDD''),''YYMMDD'') end as EDIInvoiceDateSent,
time(to_date(digits(cast(OAEINT as dec(6,0))),''HH24MISS'')) as EDIInvoiceTimeSent,
OAEIAK	as EDIAcknowledgements,
OAEAKS	as EDIAcknowledgementStatus,
OAEIAH	as HoldEDIAcknwldgmnts,
OAEIAW	as EDIAckInUseWS,
OAEAKC	as EDIAcknowldgementCentury,
case OAEAKC 
when 0 then varchar_format(timestamp_format(char(OAEAKD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OAEAKD,6,0)),''YYMMDD''),''YYMMDD'') end as EDIAcknowldgementDateSent,
time(to_date(digits(cast(OAEAKT as dec(6,0))),''HH24MISS'')) as EDIAcknowldgementTimeSent,
OAEIAS	as EDIAdvanceShipnotice,
OAEASS	as EDIASNStatus,
OAEASH	as HoldEDIASN,
OAEISW	as EDIASNInUseWS,
OAEASC	as EDIASNCentury,
case OAEASC 
when 0 then varchar_format(timestamp_format(char(OAEASD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OAEASD,6,0)),''YYMMDD''),''YYMMDD'') end as EDIASNDateSent,
time(to_date(digits(cast(OAEAST as dec(6,0))),''HH24MISS'')) as EDIASNTimeSent,
time(to_date(digits(cast(OAEICT as dec(6,0))),''HH24MISS'')) as EDIOrderCreateTime,
OAFXIN	as FaxInvoices,
OAFXAK	as FaxAcknowledgements,
OANKNM	as NickName,
OACLCC	as CancelDateCent,
case OACLCC 
when 0 then varchar_format(timestamp_format(char(OACLDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OACLDT,6,0)),''YYMMDD''),''YYMMDD'') end as CancelDate,
OASGEO	as ShiptoGeoCode,
OAGTYN	as GST,
OAGTXP	as GSTTaxPercent,
OAGTXA	as GSTAmount,
OAPTYN	as PSTYesNoCompounded,
OAPTXP	as PSTTaxPercent,
OAPTXA	as PSTAmount,
OACBCD	as ConsolidatedBillCode,
OACICT	as ConsolidatedInvControlNumber,
OACIPF	as ConsolidatedInvPrtFlag,
OACSCT	as CustomerContractCode,
OAALCC	as Century,
case OAALCC 
when 0 then varchar_format(timestamp_format(char(OAALDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OAALDT,6,0)),''YYMMDD''),''YYMMDD'') end as AllocationDate,
OAMRLF	as ManualReleasedFutureOrder,
time(to_date(digits(cast(OAETTM as dec(6,0))),''HH24MISS'')) as EntryTime,
OAETUS	as EntryUser,
time(to_date(digits(cast(OAACTM as dec(6,0))),''HH24MISS'')) as AcknowledgePrintTime,
OAACUS	as AcknowledgePrintUser,
time(to_date(digits(cast(OAPPTM as dec(6,0))),''HH24MISS'')) as PickSlipPrintTime,
OAPPUS	as PickSlipPrintUser,
time(to_date(digits(cast(OASCTM as dec(6,0))),''HH24MISS'')) as ShipConfirmTime,
OASCUS	as ShipConfirmUser,
time(to_date(digits(cast(OAINTM as dec(6,0))),''HH24MISS'')) as InvoicePrintTime,
OAINUR	as InvoicePrintUser,
OAPACC	as PackerID,
OAPICC	as PickerID,
OADRVC	as DriverID,
OAFOBC	as FOBCode,
OAEXNO	as TaxExemptCertificateNumber,
OAEXCC	as ExpirationCentury,
case OAEXCC 
when 0 then varchar_format(timestamp_format(char(OAEXDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OAEXDT,6,0)),''YYMMDD''),''YYMMDD'') end as ExpirationDate,
OAPRON	as ProNumber,
OABOLN	as BillOfLadingNumber,
OAOBOF	as AllItemsBackOrderedFlag,
OADPCC	as DaysinProcessCentry,
case OADPCC 
when 0 then varchar_format(timestamp_format(char(OADPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 1 then varchar_format(timestamp_format(char(LPAD(OADPDT,6,0)),''YYMMDD''),''YYMMDD'') end as DaysinProcessDate,
time(to_date(digits(cast(OADPTM as dec(6,0))),''HH24MISS'')) as DaysinProcessTime,
OADNCC	as DayendCentry,
case OADNCC 
when 19 then varchar_format(timestamp_format(char(OADNDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OADNDT,6,0)),''YYMMDD''),''YYMMDD'') end as DayendDate,
OADEPT	as Department,
OAIAVN	as InternalVendorNumber,
OAEMIN	as EmailInvoices,
OAEMAK	as EmailAcknowledgements
from APLUS2FAW.HSHED')

create table APLUS2FAW.IAHST(
ItemNumber	varchar(27),
WarehouseID	varchar(2),
UnitofMeasure	varchar(3),
TransactionCentury	int,
TransactionDate	Date,
Time	Time,
SequenceNumber	int,
TransactionCode	varchar(1),
TransactionQuantity	DECIMAL	(11,3),
CostorExtension	DECIMAL	(11,5),
CostorExtensionCode	varchar(1),
QuantityonHandLastTransaction	DECIMAL	(11,3),
AverageCostLastTransaction	DECIMAL	(11,5),
ItemGLCode	varchar(2),
CompanyNumber	int,
GLPostingCentury	int,
GLPostingDate	Date,
InternalGLAcctNo1	int,
InternalGLAcctNo2	int,
InternalGLAcctNo3	int,
InternalGLAcctNo4	int,
InternalGLAcctNo5	int,
InternalGLAcctNo6	int,
InternalGLAcctNo7	int,
InternalGLAcctNo8	int,
InternalGLAcctNo9	int,
DebitorCreditCode1	varchar(1),
DebitorCreditCode2	varchar(1),
DebitorCreditCode3	varchar(1),
DebitorCreditCode4	varchar(1),
DebitorCreditCode5	varchar(1),
DebitorCreditCode6	varchar(1),
DebitorCreditCode7	varchar(1),
DebitorCreditCode8	varchar(1),
DebitorCreditCode9	varchar(1),
Amount1	 DECIMAL	(9,2),
Amount2	 DECIMAL	(9,2),
Amount3	 DECIMAL	(9,2),
Amount4	 DECIMAL	(9,2),
Amount5	 DECIMAL	(9,2),
Amount6	 DECIMAL	(9,2),
Amount7	 DECIMAL	(9,2),
Amount8	 DECIMAL	(9,2),
Amount9	 DECIMAL	(9,2),
JournalNumber	varchar(5),
RelativeRecordNumber	int,
RecordNumber	varchar(5),
OriginalUser	varchar(10),
IAHistoryAccountBucket2	varchar(2),
UpdateInventoryCode 	varchar(1)
)

insert into APLUS2FAW.IAHST (
ItemNumber,
WarehouseID,
UnitofMeasure,
TransactionCentury,
TransactionDate,
Time,
SequenceNumber,
TransactionCode,
TransactionQuantity,
CostorExtension,
CostorExtensionCode,
QuantityonHandLastTransaction,
AverageCostLastTransaction,
ItemGLCode,
CompanyNumber,
GLPostingCentury,
GLPostingDate,
InternalGLAcctNo1,
InternalGLAcctNo2,
InternalGLAcctNo3,
InternalGLAcctNo4,
InternalGLAcctNo5,
InternalGLAcctNo6,
InternalGLAcctNo7,
InternalGLAcctNo8,
InternalGLAcctNo9,
DebitorCreditCode1,
DebitorCreditCode2,
DebitorCreditCode3,
DebitorCreditCode4,
DebitorCreditCode5,
DebitorCreditCode6,
DebitorCreditCode7,
DebitorCreditCode8,
DebitorCreditCode9,
Amount1,
Amount2,
Amount3,
Amount4,
Amount5,
Amount6,
Amount7,
Amount8,
Amount9,
JournalNumber,
RelativeRecordNumber,
RecordNumber,
OriginalUser,
IAHistoryAccountBucket2,
UpdateInventoryCode 
)
select TOP 10 
ItemNumber,
WarehouseID,
UnitofMeasure,
TransactionCentury,
TransactionDate,
Time,
SequenceNumber,
TransactionCode,
TransactionQuantity,
CostorExtension,
CostorExtensionCode,
QuantityonHandLastTransaction,
AverageCostLastTransaction,
ItemGLCode,
CompanyNumber,
GLPostingCentury,
GLPostingDate,
InternalGLAcctNo1,
InternalGLAcctNo2,
InternalGLAcctNo3,
InternalGLAcctNo4,
InternalGLAcctNo5,
InternalGLAcctNo6,
InternalGLAcctNo7,
InternalGLAcctNo8,
InternalGLAcctNo9,
DebitorCreditCode1,
DebitorCreditCode2,
DebitorCreditCode3,
DebitorCreditCode4,
DebitorCreditCode5,
DebitorCreditCode6,
DebitorCreditCode7,
DebitorCreditCode8,
DebitorCreditCode9,
Amount1,
Amount2,
Amount3,
Amount4,
Amount5,
Amount6,
Amount7,
Amount8,
Amount9,
JournalNumber,
RelativeRecordNumber,
RecordNumber,
OriginalUser,
IAHistoryAccountBucket2,
UpdateInventoryCode 
from openquery (bkl400, 
'select 
IAITNO	as ItemNumber,
IAWHID	as WarehouseID,
IAUNMS	as UnitofMeasure,
IATRCC	as TransactionCentury,
case IATRCC 
when 19 then varchar_format(timestamp_format(char(IATRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IATRDT,6,0)),''YYMMDD''),''YYMMDD'') end as TransactionDate,
time(to_date(digits(cast(IATIME as dec(6,0))),''HH24MISS'')) as Time,
IASQ04	as SequenceNumber,
IATRCD	as TransactionCode,
IATRQT	as TransactionQuantity,
IACSEX	as CostorExtension,
IACECD	as CostorExtensionCode,
IAQOLT	as QuantityonHandLastTransaction,
IAACLT	as AverageCostLastTransaction,
IAITGL	as ItemGLCode,
IACONO	as CompanyNumber,
IAPOCC	as GLPostingCentury,
case IAPOCC 
when 19 then varchar_format(timestamp_format(char(IAPODT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IAPODT,6,0)),''YYMMDD''),''YYMMDD'') end as GLPostingDate,
IAIAC1	as InternalGLAcctNo1,
IAIAC2	as InternalGLAcctNo2,
IAIAC3	as InternalGLAcctNo3,
IAIAC4	as InternalGLAcctNo4,
IAIAC5	as InternalGLAcctNo5,
IAIAC6	as InternalGLAcctNo6,
IAIAC7	as InternalGLAcctNo7,
IAIAC8	as InternalGLAcctNo8,
IAIAC9	as InternalGLAcctNo9,
IADRC1	as DebitorCreditCode1,
IADRC2	as DebitorCreditCode2,
IADRC3	as DebitorCreditCode3,
IADRC4	as DebitorCreditCode4,
IADRC5	as DebitorCreditCode5,
IADRC6	as DebitorCreditCode6,
IADRC7	as DebitorCreditCode7,
IADRC8	as DebitorCreditCode8,
IADRC9	as DebitorCreditCode9,
IAGLA1	as Amount1,
IAGLA2	as Amount2,
IAGLA3	as Amount3,
IAGLA4	as Amount4,
IAGLA5	as Amount5,
IAGLA6	as Amount6,
IAGLA7	as Amount7,
IAGLA8	as Amount8,
IAGLA9	as Amount9,
IAJRNL	as JournalNumber,
IARRNO	as RelativeRecordNumber,
IAREC#	as RecordNumber,
IAORUS	as OriginalUser,
IAIAB2	as IAHistoryAccountBucket2,
IAUPIN	as UpdateInventoryCode 
from APLUS2FAW.IAHST')

create table APLUS2FAW.ITMST(
ItemNumber	varchar(27),
ItemDescription1	varchar(31),
ItemDescription2	varchar(31),
UnitofMeasure1	varchar(3),
UnitofMeasure2	varchar(3),
UnitofMeasure3	varchar(3),
UMConversion1	 DECIMAL	(11,5),
UMConversion2	 DECIMAL	(11,5),
DefaultUMCode	int,
PricingUM	varchar(3),
PricingUnitofMeasureConversion	 DECIMAL	(11,5),
UnitofMeasureSurcharge1	 DECIMAL	(5,2),
UnitofMeasureSurcharge2	 DECIMAL	(5,2),
UnitofMeasureSurcharge3	 DECIMAL	(5,2),
SurchargeCode1	varchar(1),
SurchargeCode2	varchar(1),
SurchargeCode3	varchar(1),
UnitWeightUM1	 DECIMAL	(9,4),
UnitWeightUM2	 DECIMAL	(9,4),
UnitWeightUM3	 DECIMAL	(9,4),
ItemClass	varchar(2),
ItemSubclass	varchar(2),
PriceClass	int,
QuantityBreakClass	varchar(3),
ManufacturersItemNumber	varchar(27),
ContainerCharge1	 DECIMAL	(7,2),
ContainerCharge2	 DECIMAL	(7,2),
ContainerCharge3	 DECIMAL	(7,2),
ListPrice1	 DECIMAL	(11,5),
ListPrice2	 DECIMAL	(11,5),
ListPrice3	 DECIMAL	(11,5),
ListPrice4	 DECIMAL	(11,5),
ListPrice5	 DECIMAL	(11,5),
TaxableCode	varchar(1),
ReuseCode	varchar(1),
BackorderCode	varchar(1),
AllowCashDiscountCode	varchar(1),
AllowTradeDiscountCode	varchar(1),
SuspendCode	varchar(1),
MiscellaneousCode1	varchar(3),
MiscellaneousCode2	varchar(3),
MiscellaneousCode3	varchar(3),
CompanyNumber	int,
UpdateInventoryCode	varchar(1),
RankingCode	varchar(1),
DateAddedCentury	int,
DateAdded	Date,
DateOfLastMaintCentury	int,
DateOfLastMaint	Date,
CatchWeightCode	varchar(1),
ItemGLCode	varchar(2),
LocationClassCode	varchar(2),
CharacterFillerField2	varchar(2),
InUseWS	varchar(8),
FederalExciseTaxAmount	 DECIMAL	(7,2),
VendorNumber	varchar(6),
BillofMaterialType	varchar(1),
NumberofDecimals	varchar(1),
LocationSize1	 DECIMAL	(9,5),
LocationSize2	 DECIMAL	(9,5),
LocationSize3	 DECIMAL	(9,5),
WHMgmtCode	varchar(1),
ExpirationDateReqdFlag	varchar(1),
ShowLotSerialonInvoice	varchar(1),
CharacterUserArea15	varchar(15),
ProcuctRestrictionCode	varchar(6),
MSDSCentury	int,
MSDSDate	Date,
ItemTaxClass	varchar(5),
RebateClass	varchar(5),
UserField1	varchar(5),
UserField2	varchar(5),
UserField3	varchar(5),
UserField4	varchar(5),
UserField5	varchar(5),
UserField6	varchar(5),
InquiryUM	varchar(3),
ReportingUM	varchar(3),
ItemEIDGroup	varchar(5),
ExtendedDescriptionFlag	varchar(1),
ProductID	varchar(15),
ItemContractCode	varchar(4),
BuyerItemClass	varchar(2),
BuyerItemSubClass	varchar(2),
ItemCommitmentCode	int,
SkipMRPProcessing	varchar(1),
HarmonizeTariffCode	int,
CommodityCode	int,
UniqueLots 	varchar(1)
)

insert into APLUS2FAW.ITMST(
ItemNumber,
ItemDescription1,
ItemDescription2,
UnitofMeasure1,
UnitofMeasure2,
UnitofMeasure3,
UMConversion1,
UMConversion2,
DefaultUMCode,
PricingUM,
PricingUnitofMeasureConversion,
UnitofMeasureSurcharge1,
UnitofMeasureSurcharge2,
UnitofMeasureSurcharge3,
SurchargeCode1,
SurchargeCode2,
SurchargeCode3,
UnitWeightUM1,
UnitWeightUM2,
UnitWeightUM3,
ItemClass,
ItemSubclass,
PriceClass,
QuantityBreakClass,
ManufacturersItemNumber,
ContainerCharge1,
ContainerCharge2,
ContainerCharge3,
ListPrice1,
ListPrice2,
ListPrice3,
ListPrice4,
ListPrice5,
TaxableCode,
ReuseCode,
BackorderCode,
AllowCashDiscountCode,
AllowTradeDiscountCode,
SuspendCode,
MiscellaneousCode1,
MiscellaneousCode2,
MiscellaneousCode3,
CompanyNumber,
UpdateInventoryCode,
RankingCode,
DateAddedCentury,
DateAdded,
DateOfLastMaintCentury,
DateOfLastMaint,
CatchWeightCode,
ItemGLCode,
LocationClassCode,
CharacterFillerField2,
InUseWS,
FederalExciseTaxAmount,
VendorNumber,
BillofMaterialType,
NumberofDecimals,
LocationSize1,
LocationSize2,
LocationSize3,
WHMgmtCode,
ExpirationDateReqdFlag,
ShowLotSerialonInvoice,
CharacterUserArea15,
ProcuctRestrictionCode,
MSDSCentury,
MSDSDate,
ItemTaxClass,
RebateClass,
UserField1,
UserField2,
UserField3,
UserField4,
UserField5,
UserField6,
InquiryUM,
ReportingUM,
ItemEIDGroup,
ExtendedDescriptionFlag,
ProductID,
ItemContractCode,
BuyerItemClass,
BuyerItemSubClass,
ItemCommitmentCode,
SkipMRPProcessing,
HarmonizeTariffCode,
CommodityCode,
UniqueLots 
)

select TOP 10 
ItemNumber,
ItemDescription1,
ItemDescription2,
UnitofMeasure1,
UnitofMeasure2,
UnitofMeasure3,
UMConversion1,
UMConversion2,
DefaultUMCode,
PricingUM,
PricingUnitofMeasureConversion,
UnitofMeasureSurcharge1,
UnitofMeasureSurcharge2,
UnitofMeasureSurcharge3,
SurchargeCode1,
SurchargeCode2,
SurchargeCode3,
UnitWeightUM1,
UnitWeightUM2,
UnitWeightUM3,
ItemClass,
ItemSubclass,
PriceClass,
QuantityBreakClass,
ManufacturersItemNumber,
ContainerCharge1,
ContainerCharge2,
ContainerCharge3,
ListPrice1,
ListPrice2,
ListPrice3,
ListPrice4,
ListPrice5,
TaxableCode,
ReuseCode,
BackorderCode,
AllowCashDiscountCode,
AllowTradeDiscountCode,
SuspendCode,
MiscellaneousCode1,
MiscellaneousCode2,
MiscellaneousCode3,
CompanyNumber,
UpdateInventoryCode,
RankingCode,
DateAddedCentury,
DateAdded,
DateOfLastMaintCentury,
DateOfLastMaint,
CatchWeightCode,
ItemGLCode,
LocationClassCode,
CharacterFillerField2,
InUseWS,
FederalExciseTaxAmount,
VendorNumber,
BillofMaterialType,
NumberofDecimals,
LocationSize1,
LocationSize2,
LocationSize3,
WHMgmtCode,
ExpirationDateReqdFlag,
ShowLotSerialonInvoice,
CharacterUserArea15,
ProcuctRestrictionCode,
MSDSCentury,
MSDSDate,
ItemTaxClass,
RebateClass,
UserField1,
UserField2,
UserField3,
UserField4,
UserField5,
UserField6,
InquiryUM,
ReportingUM,
ItemEIDGroup,
ExtendedDescriptionFlag,
ProductID,
ItemContractCode,
BuyerItemClass,
BuyerItemSubClass,
ItemCommitmentCode,
SkipMRPProcessing,
HarmonizeTariffCode,
CommodityCode,
UniqueLots 
from openquery (bkl400, 
'select 
IMITNO	as ItemNumber,
IMITD1	as ItemDescription1,
IMITD2	as ItemDescription2,
IMUNM1	as UnitofMeasure1,
IMUNM2	as UnitofMeasure2,
IMUNM3	as UnitofMeasure3,
IMUMC1	as UMConversion1,
IMUMC2	as UMConversion2,
IMDUMC	as DefaultUMCode,
IMPRUM	as PricingUM,
IMPUMC	as PricingUnitofMeasureConversion,
IMSCH1	as UnitofMeasureSurcharge1,
IMSCH2	as UnitofMeasureSurcharge2,
IMSCH3	as UnitofMeasureSurcharge3,
IMSCC1	as SurchargeCode1,
IMSCC2	as SurchargeCode2,
IMSCC3	as SurchargeCode3,
IMUWT1	as UnitWeightUM1,
IMUWT2	as UnitWeightUM2,
IMUWT3	as UnitWeightUM3,
IMITCL	as ItemClass,
IMITSC	as ItemSubclass,
IMPRCL	as PriceClass,
IMQBCL	as QuantityBreakClass,
IMMFNO	as ManufacturersItemNumber,
IMCCH1	as ContainerCharge1,
IMCCH2	as ContainerCharge2,
IMCCH3	as ContainerCharge3,
IMLPR1	as ListPrice1,
IMLPR2	as ListPrice2,
IMLPR3	as ListPrice3,
IMLPR4	as ListPrice4,
IMLPR5	as ListPrice5,
IMTXCD	as TaxableCode,
IMREVS	as ReuseCode,
IMBOCD	as BackorderCode,
IMCDCD	as AllowCashDiscountCode,
IMTDSC	as AllowTradeDiscountCode,
IMSUSP	as SuspendCode,
IMMC01	as MiscellaneousCode1,
IMMC02	as MiscellaneousCode2,
IMMC03	as MiscellaneousCode3,
IMCONO	as CompanyNumber,
IMUPIN	as UpdateInventoryCode,
IMRKCD	as RankingCode,
IMADCC	as DateAddedCentury,
case IMADCC 
when 19 then varchar_format(timestamp_format(char(IMADDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IMADDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateAdded,
IMLMCC	as DateOfLastMaintCentury,
case IMLMCC 
when 19 then varchar_format(timestamp_format(char(IMLMDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IMLMDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateOfLastMaint,
IMCTWT	as CatchWeightCode,
IMITGL	as ItemGLCode,
IMLCCL	as LocationClassCode,
IMFL02	as CharacterFillerField2,
IMINUS	as InUseWS,
IMFETX	as FederalExciseTaxAmount,
IMVNNO	as VendorNumber,
IMBMTP	as BillofMaterialType,
IMNODC	as NumberofDecimals,
IMLOS1	as LocationSize1,
IMLOS2	as LocationSize2,
IMLOS3	as LocationSize3,
IMWMCD	as WHMgmtCode,
IMEXDR	as ExpirationDateReqdFlag,
IMLSIV	as ShowLotSerialonInvoice,
IMUS15	as CharacterUserArea15,
IMRSCD	as ProcuctRestrictionCode,
IMMSCC	as MSDSCentury,
case IMMSCC 
when 19 then varchar_format(timestamp_format(char(IMMSDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IMMSDT,6,0)),''YYMMDD''),''YYMMDD'') end as MSDSDate,
IMITXC	as ItemTaxClass,
IMRBCL	as RebateClass,
IMUS5A	as UserField1,
IMUS5B	as UserField2,
IMUS5C	as UserField3,
IMUS5D	as UserField4,
IMUS5E	as UserField5,
IMUS5F	as UserField6,
IMSAUM	as InquiryUM,
IMRPUM	as ReportingUM,
IMIGID	as ItemEIDGroup,
IMEXDF	as ExtendedDescriptionFlag,
IMPDID	as ProductID,
IMITCT	as ItemContractCode,
IMBYCL	as BuyerItemClass,
IMBYSC	as BuyerItemSubClass,
IMITCM	as ItemCommitmentCode,
IMMRSK	as SkipMRPProcessing,
IMHRTC	as HarmonizeTariffCode,
IMCMOD	as CommodityCode,
IMUNLT	as UniqueLots 
from APLUS2FAW.ITMST')

Create table APLUS2FAW.ITBAL(
ItemNumber	varchar(27),
WarehouseID	varchar(2),
ItemClass	varchar(2),
ItemSubclass	varchar(2),
SuspendCode	varchar(1),
VendorNumber	varchar(6),
PrimaryLocation	varchar(8),
SecondaryLocation	varchar(8),
CycleCountCode	varchar(1),
PhysicalInventoryCode	varchar(1),
SalesAnalysisFlag	varchar(1),
StandardCost	 DECIMAL	(11,5),
UserCost	 DECIMAL	(11,5),
AverageCost	 DECIMAL	(11,5),
LastCost	 DECIMAL	(11,5),
LastCostCentury	int,
LastCostDate	Date,
DateOfLastSaleCentury	int,
DateofLastSale	Date,
DateLastCountedCentury	int,
DateLastCounted	Date,
MaximumOnHandQtyUM1	 DECIMAL	(11,3),
MaximumOnHandQtyUM2	 DECIMAL	(11,3),
MaximumOnHandQtyUM3	 DECIMAL	(11,3),
MinimumOnHandQtyUM1	 DECIMAL	(11,3),
MinimumOnHandQtyUM2	 DECIMAL	(11,3),
MinimumOnHandQtyUM3	 DECIMAL	(11,3),
PhysicalOnHandQtyatCountUM1	 DECIMAL	(11,3),
PhysicalOnHandQtyatCountUM2	 DECIMAL	(11,3),
PhysicalOnHandQtyatCountUM3	 DECIMAL	(11,3),
QtyOnHandUM1	 DECIMAL	(11,3),
QtyOnHandUM2	 DECIMAL	(11,3),
QtyOnHandUM3	 DECIMAL	(11,3),
QtyAllocatedUM1	 DECIMAL	(11,3),
QtyAllocatedUM2	 DECIMAL	(11,3),
QtyAllocatedUM3	 DECIMAL	(11,3),
QtyonBackorderUM1	 DECIMAL	(11,3),
QtyonBackorderUM2	 DECIMAL	(11,3),
QtyonBackorderUM3	 DECIMAL	(11,3),
QtyonPurchaseOrderUM1	 DECIMAL	(11,3),
QtyonPurchaseOrderUM2	 DECIMAL	(11,3),
QtyonPurchaseOrderUM3	 DECIMAL	(11,3),
InventoryQtyUnpostedUM1	 DECIMAL	(11,3),
InventoryQtyUnpostedUM2	 DECIMAL	(11,3),
InventoryQtyUnpostedUM3	 DECIMAL	(11,3),
ReceiptsMTDUM1	 DECIMAL	(11,3),
ReceiptsMTDUM2	 DECIMAL	(11,3),
ReceiptsMTDUM3	 DECIMAL	(11,3),
ReceiptsYTDUM1	 DECIMAL	(11,3),
ReceiptsYTDUM2	 DECIMAL	(11,3),
ReceiptsYTDUM3	 DECIMAL	(11,3),
IssuesMTDUM1	 DECIMAL	(11,3),
IssuesMTDUM2	 DECIMAL	(11,3),
IssuesMTDUM3	 DECIMAL	(11,3),
IssuesYTDUM1	 DECIMAL	(11,3),
IssuesYTDUM2	 DECIMAL	(11,3),
IssuesYTDUM3	 DECIMAL	(11,3),
AdjustmentsMTDUM1	 DECIMAL	(11,3),
AdjustmentsMTDUM2	 DECIMAL	(11,3),
AdjustmentsMTDUM3	 DECIMAL	(11,3),
AdjustmentsYTDUM1	 DECIMAL	(11,3),
AdjustmentsYTDUM2	 DECIMAL	(11,3),
AdjustmentsYTDUM3	 DECIMAL	(11,3),
MovesMTDUM1	 DECIMAL	(11,3),
MovesMTDUM2	 DECIMAL	(11,3),
MovesMTDUM3	 DECIMAL	(11,3),
MovesYTDUM1	 DECIMAL	(11,3),
MovesYTDUM2	 DECIMAL	(11,3),
MovesYTDUM3	 DECIMAL	(11,3),
StockoutsMTDUM1	int,
StockoutsMTDUM2	int,
StockoutsMTDUM3	int,
StockoutsYTDUM1	int,
StockoutsYTDUM2	int,
StockoutsYTDUM3	int,
MonthEndOnHandBalance	 DECIMAL	(11,3),
TotalMonthEndBalanceYTD	 DECIMAL	(11,3),
TotalMonthEndBalanceLY	 DECIMAL	(11,3),
NumberofMonthsTY	int,
NumberofMonthsLY	int,
QtySoldMTD	 DECIMAL	(13,3),
QtySoldYTD	 DECIMAL	(13,3),
QtySoldLY	 DECIMAL	(13,3),
ItemSalesAmountMTD	 DECIMAL	(9,2),
ItemSalesAmountYTD	 DECIMAL	(11,2),
ItemSalesAmountLY	 DECIMAL	(11,2),
CostsMTD	 DECIMAL	(9,2),
CostsYTD	 DECIMAL	(11,2),
CostsLY	 DECIMAL	(11,2),
DropShipQtyMTD	 DECIMAL	(13,3),
DropShipQtyYTD	 DECIMAL	(13,3),
DropShipQtyLY	 DECIMAL	(13,3),
DropShipSalesMTD	 DECIMAL	(9,2),
DropShipSalesYTD	 DECIMAL	(11,2),
DropShipSalesLY	 DECIMAL	(11,2),
DropShipCostsMTD	 DECIMAL	(9,2),
DropShipCostYTD	 DECIMAL	(11,2),
DropShipCostsLY	 DECIMAL	(11,2),
NumberofOrdersMTD	int,
NumberofOrdersYTD	int,
NumberofOrdersLY	int,
NumberofPicksMTD	int,
NumberofPicksYTD	int,
NumberofPicksLY	int,
InUseWS	varchar(8),
InventoryTransactionID	int,
SalesAnalysisTransactionID	int,
QtyCommittedUnitofMeasure1	 DECIMAL	(11,3),
QtyCommittedUnitofMeasure2	 DECIMAL	(11,3),
QtyCommittedUnitofMeasure3	 DECIMAL	(11,3),
Forecast	varchar(1),
SpecialOrderCode	varchar(1),
WHMgmtInUseWorkstation	varchar(2),
CharacterFillerField15	varchar(15),
UserArea	varchar(20),
ListPrice1	 DECIMAL	(11,5),
ListPrice2	 DECIMAL	(11,5),
ListPrice3	 DECIMAL	(11,5),
ListPrice4	 DECIMAL	(11,5),
ListPrice5	 DECIMAL	(11,5),
ListPriceCode	varchar(1),
ABCCode	varchar(1),
PriceClass	int,
QtyBreakClass	varchar(3),
AllowCashDiscountCode	varchar(1),
TradeDiscountCode	varchar(1),
DefaultOrderingUM	varchar(3),
TransactionID1	int,
TransactionID2	int,
TransactionID3	int,
TransactionID4	int,
DateOfLastMaintCentury	int,
DateOfLastMaint	Date,
TimePhasedItem	varchar(1),
CommissionCostCode	varchar(1),
CommissionCost	 DECIMAL	(11,5),
ItemContractCode	varchar(4),
EconomicOrderQty	 DECIMAL	(10,3),
ItemCommitmentCode	int,
BuyerReviewReqd	varchar(1),
PlantID	varchar(2),
QuotedLeadTime	 DECIMAL	(8,4),
CountryofOrigin1	varchar(3),
CountryofOrigin2	varchar(3),
TaxableCode	varchar(1),
ReuseCode	varchar(1),
ItemTaxClass 	varchar (5)
)

insert into APLUS2FAW.ITBAL(
ItemNumber,
WarehouseID,
ItemClass,
ItemSubclass,
SuspendCode,
VendorNumber,
PrimaryLocation,
SecondaryLocation,
CycleCountCode,
PhysicalInventoryCode,
SalesAnalysisFlag,
StandardCost,
UserCost,
AverageCost,
LastCost,
LastCostCentury,
LastCostDate,
DateOfLastSaleCentury,
DateofLastSale,
DateLastCountedCentury,
DateLastCounted,
MaximumOnHandQtyUM1,
MaximumOnHandQtyUM2,
MaximumOnHandQtyUM3,
MinimumOnHandQtyUM1,
MinimumOnHandQtyUM2,
MinimumOnHandQtyUM3,
PhysicalOnHandQtyatCountUM1,
PhysicalOnHandQtyatCountUM2,
PhysicalOnHandQtyatCountUM3,
QtyOnHandUM1,
QtyOnHandUM2,
QtyOnHandUM3,
QtyAllocatedUM1,
QtyAllocatedUM2,
QtyAllocatedUM3,
QtyonBackorderUM1,
QtyonBackorderUM2,
QtyonBackorderUM3,
QtyonPurchaseOrderUM1,
QtyonPurchaseOrderUM2,
QtyonPurchaseOrderUM3,
InventoryQtyUnpostedUM1,
InventoryQtyUnpostedUM2,
InventoryQtyUnpostedUM3,
ReceiptsMTDUM1,
ReceiptsMTDUM2,
ReceiptsMTDUM3,
ReceiptsYTDUM1,
ReceiptsYTDUM2,
ReceiptsYTDUM3,
IssuesMTDUM1,
IssuesMTDUM2,
IssuesMTDUM3,
IssuesYTDUM1,
IssuesYTDUM2,
IssuesYTDUM3,
AdjustmentsMTDUM1,
AdjustmentsMTDUM2,
AdjustmentsMTDUM3,
AdjustmentsYTDUM1,
AdjustmentsYTDUM2,
AdjustmentsYTDUM3,
MovesMTDUM1,
MovesMTDUM2,
MovesMTDUM3,
MovesYTDUM1,
MovesYTDUM2,
MovesYTDUM3,
StockoutsMTDUM1,
StockoutsMTDUM2,
StockoutsMTDUM3,
StockoutsYTDUM1,
StockoutsYTDUM2,
StockoutsYTDUM3,
MonthEndOnHandBalance,
TotalMonthEndBalanceYTD,
TotalMonthEndBalanceLY,
NumberofMonthsTY,
NumberofMonthsLY,
QtySoldMTD,
QtySoldYTD,
QtySoldLY,
ItemSalesAmountMTD,
ItemSalesAmountYTD,
ItemSalesAmountLY,
CostsMTD,
CostsYTD,
CostsLY,
DropShipQtyMTD,
DropShipQtyYTD,
DropShipQtyLY,
DropShipSalesMTD,
DropShipSalesYTD,
DropShipSalesLY,
DropShipCostsMTD,
DropShipCostYTD,
DropShipCostsLY,
NumberofOrdersMTD,
NumberofOrdersYTD,
NumberofOrdersLY,
NumberofPicksMTD,
NumberofPicksYTD,
NumberofPicksLY,
InUseWS,
InventoryTransactionID,
SalesAnalysisTransactionID,
QtyCommittedUnitofMeasure1,
QtyCommittedUnitofMeasure2,
QtyCommittedUnitofMeasure3,
Forecast,
SpecialOrderCode,
WHMgmtInUseWorkstation,
CharacterFillerField15,
UserArea,
ListPrice1,
ListPrice2,
ListPrice3,
ListPrice4,
ListPrice5,
ListPriceCode,
ABCCode,
PriceClass,
QtyBreakClass,
AllowCashDiscountCode,
TradeDiscountCode,
DefaultOrderingUM,
TransactionID1,
TransactionID2,
TransactionID3,
TransactionID4,
DateOfLastMaintCentury,
DateOfLastMaint,
TimePhasedItem,
CommissionCostCode,
CommissionCost,
ItemContractCode,
EconomicOrderQty,
ItemCommitmentCode,
BuyerReviewReqd,
PlantID,
QuotedLeadTime,
CountryofOrigin1,
CountryofOrigin2,
TaxableCode,
ReuseCode,
ItemTaxClass
)

select TOP 10 
ItemNumber,
WarehouseID,
ItemClass,
ItemSubclass,
SuspendCode,
VendorNumber,
PrimaryLocation,
SecondaryLocation,
CycleCountCode,
PhysicalInventoryCode,
SalesAnalysisFlag,
StandardCost,
UserCost,
AverageCost,
LastCost,
LastCostCentury,
LastCostDate,
DateOfLastSaleCentury,
DateofLastSale,
DateLastCountedCentury,
DateLastCounted,
MaximumOnHandQtyUM1,
MaximumOnHandQtyUM2,
MaximumOnHandQtyUM3,
MinimumOnHandQtyUM1,
MinimumOnHandQtyUM2,
MinimumOnHandQtyUM3,
PhysicalOnHandQtyatCountUM1,
PhysicalOnHandQtyatCountUM2,
PhysicalOnHandQtyatCountUM3,
QtyOnHandUM1,
QtyOnHandUM2,
QtyOnHandUM3,
QtyAllocatedUM1,
QtyAllocatedUM2,
QtyAllocatedUM3,
QtyonBackorderUM1,
QtyonBackorderUM2,
QtyonBackorderUM3,
QtyonPurchaseOrderUM1,
QtyonPurchaseOrderUM2,
QtyonPurchaseOrderUM3,
InventoryQtyUnpostedUM1,
InventoryQtyUnpostedUM2,
InventoryQtyUnpostedUM3,
ReceiptsMTDUM1,
ReceiptsMTDUM2,
ReceiptsMTDUM3,
ReceiptsYTDUM1,
ReceiptsYTDUM2,
ReceiptsYTDUM3,
IssuesMTDUM1,
IssuesMTDUM2,
IssuesMTDUM3,
IssuesYTDUM1,
IssuesYTDUM2,
IssuesYTDUM3,
AdjustmentsMTDUM1,
AdjustmentsMTDUM2,
AdjustmentsMTDUM3,
AdjustmentsYTDUM1,
AdjustmentsYTDUM2,
AdjustmentsYTDUM3,
MovesMTDUM1,
MovesMTDUM2,
MovesMTDUM3,
MovesYTDUM1,
MovesYTDUM2,
MovesYTDUM3,
StockoutsMTDUM1,
StockoutsMTDUM2,
StockoutsMTDUM3,
StockoutsYTDUM1,
StockoutsYTDUM2,
StockoutsYTDUM3,
MonthEndOnHandBalance,
TotalMonthEndBalanceYTD,
TotalMonthEndBalanceLY,
NumberofMonthsTY,
NumberofMonthsLY,
QtySoldMTD,
QtySoldYTD,
QtySoldLY,
ItemSalesAmountMTD,
ItemSalesAmountYTD,
ItemSalesAmountLY,
CostsMTD,
CostsYTD,
CostsLY,
DropShipQtyMTD,
DropShipQtyYTD,
DropShipQtyLY,
DropShipSalesMTD,
DropShipSalesYTD,
DropShipSalesLY,
DropShipCostsMTD,
DropShipCostYTD,
DropShipCostsLY,
NumberofOrdersMTD,
NumberofOrdersYTD,
NumberofOrdersLY,
NumberofPicksMTD,
NumberofPicksYTD,
NumberofPicksLY,
InUseWS,
InventoryTransactionID,
SalesAnalysisTransactionID,
QtyCommittedUnitofMeasure1,
QtyCommittedUnitofMeasure2,
QtyCommittedUnitofMeasure3,
Forecast,
SpecialOrderCode,
WHMgmtInUseWorkstation,
CharacterFillerField15,
UserArea,
ListPrice1,
ListPrice2,
ListPrice3,
ListPrice4,
ListPrice5,
ListPriceCode,
ABCCode,
PriceClass,
QtyBreakClass,
AllowCashDiscountCode,
TradeDiscountCode,
DefaultOrderingUM,
TransactionID1,
TransactionID2,
TransactionID3,
TransactionID4,
DateOfLastMaintCentury,
DateOfLastMaint,
TimePhasedItem,
CommissionCostCode,
CommissionCost,
ItemContractCode,
EconomicOrderQty,
ItemCommitmentCode,
BuyerReviewReqd,
PlantID,
QuotedLeadTime,
CountryofOrigin1,
CountryofOrigin2,
TaxableCode,
ReuseCode,
ItemTaxClass 
--Select top 10 *
from openquery (bkl400, 
'select 
IBITNO	as ItemNumber,
IBWHID	as WarehouseID,
IBITCL	as ItemClass,
IBITSC	as ItemSubclass,
IBSUSP	as SuspendCode,
IBVNNO	as VendorNumber,
IBPRLC	as PrimaryLocation,
IBSCLC	as SecondaryLocation,
IBCCCD	as CycleCountCode,
IBPICD	as PhysicalInventoryCode,
IBSAFL	as SalesAnalysisFlag,
IBSTCS	as StandardCost,
IBUSCS	as UserCost,
IBAVCS	as AverageCost,
IBLCST	as LastCost,
IBLCCC	as LastCostCentury,
case IBLCCC 
when 19 then varchar_format(timestamp_format(char(IBLCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IBLCDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastCostDate,
IBLSCC	as DateOfLastSaleCentury,
case IBLSCC 
when 19 then varchar_format(timestamp_format(char(IBLSDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IBLCDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateofLastSale,
IBLXCC	as DateLastCountedCentury,
case IBLXCC 
when 19 then varchar_format(timestamp_format(char(IBLXDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IBLCDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateLastCounted,
IBMXO1	as MaximumOnHandQtyUM1,
IBMXO2	as MaximumOnHandQtyUM2,
IBMXO3	as MaximumOnHandQtyUM3,
IBMNO1	as MinimumOnHandQtyUM1,
IBMNO2	as MinimumOnHandQtyUM2,
IBMNO3	as MinimumOnHandQtyUM3,
IBFOQ1	as PhysicalOnHandQtyatCountUM1,
IBFOQ2	as PhysicalOnHandQtyatCountUM2,
IBFOQ3	as PhysicalOnHandQtyatCountUM3,
IBOHQ1	as QtyOnHandUM1,
IBOHQ2	as QtyOnHandUM2,
IBOHQ3	as QtyOnHandUM3,
IBAQT1	as QtyAllocatedUM1,
IBAQT2	as QtyAllocatedUM2,
IBAQT3	as QtyAllocatedUM3,
IBBOQ1	as QtyonBackorderUM1,
IBBOQ2	as QtyonBackorderUM2,
IBBOQ3	as QtyonBackorderUM3,
IBPOQ1	as QtyonPurchaseOrderUM1,
IBPOQ2	as QtyonPurchaseOrderUM2,
IBPOQ3	as QtyonPurchaseOrderUM3,
IBIQT1	as InventoryQtyUnpostedUM1,
IBIQT2	as InventoryQtyUnpostedUM2,
IBIQT3	as InventoryQtyUnpostedUM3,
IBRMD1	as ReceiptsMTDUM1,
IBRMD2	as ReceiptsMTDUM2,
IBRMD3	as ReceiptsMTDUM3,
IBRYD1	as ReceiptsYTDUM1,
IBRYD2	as ReceiptsYTDUM2,
IBRYD3	as ReceiptsYTDUM3,
IBISM1	as IssuesMTDUM1,
IBISM2	as IssuesMTDUM2,
IBISM3	as IssuesMTDUM3,
IBISY1	as IssuesYTDUM1,
IBISY2	as IssuesYTDUM2,
IBISY3	as IssuesYTDUM3,
IBAMD1	as AdjustmentsMTDUM1,
IBAMD2	as AdjustmentsMTDUM2,
IBAMD3	as AdjustmentsMTDUM3,
IBAYD1	as AdjustmentsYTDUM1,
IBAYD2	as AdjustmentsYTDUM2,
IBAYD3	as AdjustmentsYTDUM3,
IBMMD1	as MovesMTDUM1,
IBMMD2	as MovesMTDUM2,
IBMMD3	as MovesMTDUM3,
IBMYD1	as MovesYTDUM1,
IBMYD2	as MovesYTDUM2,
IBMYD3	as MovesYTDUM3,
IBSMD1	as StockoutsMTDUM1,
IBSMD2	as StockoutsMTDUM2,
IBSMD3	as StockoutsMTDUM3,
IBSYD1	as StockoutsYTDUM1,
IBSYD2	as StockoutsYTDUM2,
IBSYD3	as StockoutsYTDUM3,
IBBLME	as MonthEndOnHandBalance,
IBBLYO	as TotalMonthEndBalanceYTD,
IBBLLY	as TotalMonthEndBalanceLY,
IBNMTY	as NumberofMonthsTY,
IBNMLY	as NumberofMonthsLY,
IBQSMD	as QtySoldMTD,
IBQSYD	as QtySoldYTD,
IBQSLY	as QtySoldLY,
IBISMD	as ItemSalesAmountMTD,
IBISYD	as ItemSalesAmountYTD,
IBISLY	as ItemSalesAmountLY,
IBCSMD	as CostsMTD,
IBCSYD	as CostsYTD,
IBCSLY	as CostsLY,
IBDQMD	as DropShipQtyMTD,
IBDQYD	as DropShipQtyYTD,
IBDQLY	as DropShipQtyLY,
IBDSMD	as DropShipSalesMTD,
IBDSYD	as DropShipSalesYTD,
IBDSLY	as DropShipSalesLY,
IBDCMD	as DropShipCostsMTD,
IBDCYD	as DropShipCostYTD,
IBDCLY	as DropShipCostsLY,
IBNOMD	as NumberofOrdersMTD,
IBNOYD	as NumberofOrdersYTD,
IBNOLY	as NumberofOrdersLY,
IBPKMD	as NumberofPicksMTD,
IBPKYD	as NumberofPicksYTD,
IBPKLY	as NumberofPicksLY,
IBINUS	as InUseWS,
IBIAID	as InventoryTransactionID,
IBSAID	as SalesAnalysisTransactionID,
IBCQT1	as QtyCommittedUnitofMeasure1,
IBCQT2	as QtyCommittedUnitofMeasure2,
IBCQT3	as QtyCommittedUnitofMeasure3,
IBFCST	as Forecast,
IBDRSH	as SpecialOrderCode,
IBWMIU	as WHMgmtInUseWorkstation,
IBFL15	as CharacterFillerField15,
IBUS20	as UserArea,
IBLPR1	as ListPrice1,
IBLPR2	as ListPrice2,
IBLPR3	as ListPrice3,
IBLPR4	as ListPrice4,
IBLPR5	as ListPrice5,
IBLPCD	as ListPriceCode,
IBABCC	as ABCCode,
IBPRCL	as PriceClass,
IBQBCL	as QtyBreakClass,
IBACDC	as AllowCashDiscountCode,
IBTDCD	as TradeDiscountCode,
IBDOUM	as DefaultOrderingUM,
IBTP01	as TransactionID1,
IBTP02	as TransactionID2,
IBTP03	as TransactionID3,
IBTP04	as TransactionID4,
IBLMCC	as DateOfLastMaintCentury,
case IBLMCC 
when 19 then varchar_format(timestamp_format(char(IBLMDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IBLMDT,6,0)),''YYMMDD''),''YYMMDD'') end as DateOfLastMaint,
IBTMPH	as TimePhasedItem,
IBCOMC	as CommissionCostCode,
IBCOMF	as CommissionCost,
IBITCT	as ItemContractCode,
IBEOQT	as EconomicOrderQty,
IBITCM	as ItemCommitmentCode,
IBBRVW	as BuyerReviewReqd,
IBPTID	as PlantID,
IBQTLT	as QuotedLeadTime,
IBCTY1	as CountryofOrigin1,
IBCTY2	as CountryofOrigin2,
IBTXCD	as TaxableCode,
IBREVS	as ReuseCode,
IBITXC	as ItemTaxClass 
from APLUS2FAW.ITBAL')

create table APLUS2FAW.ITWHM (
ItemNumber	varchar(27),
WarehouseID	varchar(3),
PutAwayQty	 DECIMAL	(11,3),
MaximumPickQty	 DECIMAL	(11,3),
CaseQtyFlag	varchar(1),
CaseDescription	varchar(3),
CaseQty	int,
OverrideWarehouseLocation	varchar(12),
MaximumPutAwayQty	 DECIMAL	(11,3),
PutAwayMessage	varchar(30),
QtyperPallet	 DECIMAL	(11,3),
PalletID	varchar(3),
ImmediateCode	varchar(1),
CountCode	varchar(1),
LastCountedCentury	int,
LastCountDate	Date,
LocationClassCode	varchar(3),
ItemLabelFlag	varchar(1),
LotItemPutAwayCode	varchar(1),
ItemBoxingCode 	varchar(1)
)

insert into APLUS2FAW.ITWHM (
ItemNumber,
WarehouseID,
PutAwayQty,
MaximumPickQty,
CaseQtyFlag,
CaseDescription,
CaseQty,
OverrideWarehouseLocation,
MaximumPutAwayQty,
PutAwayMessage,
QtyperPallet,
PalletID,
ImmediateCode,
CountCode,
LastCountedCentury,
LastCountDate,
LocationClassCode,
ItemLabelFlag,
LotItemPutAwayCode,
ItemBoxingCode 
)
select TOP 10 
ItemNumber,
WarehouseID,
PutAwayQty,
MaximumPickQty,
CaseQtyFlag,
CaseDescription,
CaseQty,
OverrideWarehouseLocation,
MaximumPutAwayQty,
PutAwayMessage,
QtyperPallet,
PalletID,
ImmediateCode,
CountCode,
LastCountedCentury,
LastCountDate,
LocationClassCode,
ItemLabelFlag,
LotItemPutAwayCode,
ItemBoxingCode 
from openquery (bkl400, 
'select 
IBITNO	as ItemNumber,
IBWHID	as WarehouseID,
IBPAQT	as PutAwayQty,
IBMXPQ	as MaximumPickQty,
IBCSFL	as CaseQtyFlag,
IBCSDS	as CaseDescription,
IBCSQT	as CaseQty,
IBOVLC	as OverrideWarehouseLocation,
IBMPAQ	as MaximumPutAwayQty,
IBPAMS	as PutAwayMessage,
IBQTPP	as QtyperPallet,
IBPLID	as PalletID,
IBIMCD	as ImmediateCode,
IBCOCD	as CountCode,
IBCOCC	as LastCountedCentury,
case IBCOCC 
when 19 then varchar_format(timestamp_format(char(IBCODT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(IBCODT,6,0)),''YYMMDD''),''YYMMDD'') end as LastCountDate,
IBLCCL	as LocationClassCode,
IBITLB	as ItemLabelFlag,
IBLPAC	as LotItemPutAwayCode,
IBBXCD	as ItemBoxingCode
from APLUS2FAW.ITWHM')

create table APLUS2FAW.PODET (
CompanyNumber	int,
OrderID	varchar(8),
LineSequenceNo	int,
ItemNumber	varchar(27),
DeleteCode	varchar(1),
ItemDescription1	varchar(31),
ItemDescription2	varchar(31),
VendorNumber	varchar(8),
Century	int,
DueDate	Date,
OrderQuantity	 DECIMAL	(10,3),
CurrentAverageCost	 DECIMAL	(11,5),
ManufacturersItemNumber	varchar(27),
NonInventoryFlag	varchar(1),
UnitofMeasure	varchar(3),
PricingUM	varchar(3),
TaxableCode	varchar(1),
UnshippedAmount	 DECIMAL	(9,2),
UnitWeight	 DECIMAL	(9,4),
Unshippedweight	 DECIMAL	(11,4),
LotChargeCode	varchar(1),
OrderAmount	 DECIMAL	(9,2),
OrderedWeight	 DECIMAL	(11,4),
DropShipCode	varchar(1),
ItemClass	varchar(2),
ItemSubClass	varchar(2),
WarehouseID	varchar(2),
OrderCentury	int,
OrderDate	Date,
QuantityReceivedtodate	 DECIMAL	(10,3),
LastReceiptCentury	int,
LastReceiptDate	Date,
GeneralLedgerAccountNumber	int,
RequisitionNumber	varchar(8),
PurchaseOrderNumber	varchar(8),
UpdateAverageCost	varchar(1),
UpdateInventoryCode	varchar(1),
ActualCost	 DECIMAL	(11,5),
NoChargeCode	varchar(1),
DiscountPercent	 DECIMAL	(4,2),
UnpostedReceipts	varchar(1),
LineItemStatus	varchar(1),
NewItemCode	varchar(1),
CharacterUserArea15	varchar(15),
UpdateAIA	varchar(1),
TotActWgtRecvdtodate	 DECIMAL	(11,4),
SpecialOrderCode	varchar(1),
RequestedReceiptCentury	int,
RequestedReceiptDate	Date,
DueDtPromisbyVendorFlag	varchar(1),
CharacterFillerField7	varchar(7),
LocationSize	 DECIMAL	(9,5),
LandingFactor1	 DECIMAL	(9,3),
LandingFactor2	 DECIMAL	(9,3),
LandingFactor3	 DECIMAL	(9,3),
LandingFactor4	 DECIMAL	(9,3),
LandingFactor5	 DECIMAL	(9,3),
LandingFactor6	 DECIMAL	(9,3),
LandingMethod1	varchar(1),
LandingMethod2	varchar(1),
LandingMethod3	varchar(1),
LandingMethod4	varchar(1),
LandingMethod5	varchar(1),
LandingMethod6	varchar(1),
LandingCost1	 DECIMAL	(9,2),
LandingCost2	 DECIMAL	(9,2),
LandingCost3	 DECIMAL	(9,2),
LandingCost4	 DECIMAL	(9,2),
LandingCost5	 DECIMAL	(9,2),
LandingCost6	 DECIMAL	(9,2),
LeadTimeCalc	varchar(1),
ContractNumber	varchar(10),
BuyQty	 DECIMAL	(9,3),
BuyPriceorDisc	 DECIMAL	(11,5),
BuyQtyCostCode	varchar(1),
GetQty	 DECIMAL	(9,3),
GetPriceorDisc	 DECIMAL	(11,5),
GetQtyCostCode	varchar(1),
LandingCode	varchar(5),
ParentOrderNumber	int,
VendorVolumeDiscPercent	 DECIMAL	(5,3),
RecWhCompanyNumber	int,
RecWhRequisitionNumber	varchar(8),
RecWhLineNumber	int,
ReturntoVendorLogNumber	int,
CommodityCode 	int
)

insert into APLUS2FAW.PODET(
CompanyNumber,
OrderID,
LineSequenceNo,
ItemNumber,
DeleteCode,
ItemDescription1,
ItemDescription2,
VendorNumber,
Century,
DueDate,
OrderQuantity,
CurrentAverageCost,
ManufacturersItemNumber,
NonInventoryFlag,
UnitofMeasure,
PricingUM,
TaxableCode,
UnshippedAmount,
UnitWeight,
Unshippedweight,
LotChargeCode,
OrderAmount,
OrderedWeight,
DropShipCode,
ItemClass,
ItemSubClass,
WarehouseID,
OrderCentury,
OrderDate,
QuantityReceivedtodate,
LastReceiptCentury,
LastReceiptDate,
GeneralLedgerAccountNumber,
RequisitionNumber,
PurchaseOrderNumber,
UpdateAverageCost,
UpdateInventoryCode,
ActualCost,
NoChargeCode,
DiscountPercent,
UnpostedReceipts,
LineItemStatus,
NewItemCode,
CharacterUserArea15,
UpdateAIA,
TotActWgtRecvdtodate,
SpecialOrderCode,
RequestedReceiptCentury,
RequestedReceiptDate,
DueDtPromisbyVendorFlag,
CharacterFillerField7,
LocationSize,
LandingFactor1,
LandingFactor2,
LandingFactor3,
LandingFactor4,
LandingFactor5,
LandingFactor6,
LandingMethod1,
LandingMethod2,
LandingMethod3,
LandingMethod4,
LandingMethod5,
LandingMethod6,
LandingCost1,
LandingCost2,
LandingCost3,
LandingCost4,
LandingCost5,
LandingCost6,
LeadTimeCalc,
ContractNumber,
BuyQty,
BuyPriceorDisc,
BuyQtyCostCode,
GetQty,
GetPriceorDisc,
GetQtyCostCode,
LandingCode,
ParentOrderNumber,
VendorVolumeDiscPercent,
RecWhCompanyNumber,
RecWhRequisitionNumber,
RecWhLineNumber,
ReturntoVendorLogNumber,
CommodityCode 
)


select TOP 10 
CompanyNumber,
OrderID,
LineSequenceNo,
ItemNumber,
DeleteCode,
ItemDescription1,
ItemDescription2,
VendorNumber,
Century,
DueDate,
OrderQuantity,
CurrentAverageCost,
ManufacturersItemNumber,
NonInventoryFlag,
UnitofMeasure,
PricingUM,
TaxableCode,
UnshippedAmount,
UnitWeight,
Unshippedweight,
LotChargeCode,
OrderAmount,
OrderedWeight,
DropShipCode,
ItemClass,
ItemSubClass,
WarehouseID,
OrderCentury,
OrderDate,
QuantityReceivedtodate,
LastReceiptCentury,
LastReceiptDate,
GeneralLedgerAccountNumber,
RequisitionNumber,
PurchaseOrderNumber,
UpdateAverageCost,
UpdateInventoryCode,
ActualCost,
NoChargeCode,
DiscountPercent,
UnpostedReceipts,
LineItemStatus,
NewItemCode,
CharacterUserArea15,
UpdateAIA,
TotActWgtRecvdtodate,
SpecialOrderCode,
RequestedReceiptCentury,
RequestedReceiptDate,
DueDtPromisbyVendorFlag,
CharacterFillerField7,
LocationSize,
LandingFactor1,
LandingFactor2,
LandingFactor3,
LandingFactor4,
LandingFactor5,
LandingFactor6,
LandingMethod1,
LandingMethod2,
LandingMethod3,
LandingMethod4,
LandingMethod5,
LandingMethod6,
LandingCost1,
LandingCost2,
LandingCost3,
LandingCost4,
LandingCost5,
LandingCost6,
LeadTimeCalc,
ContractNumber,
BuyQty,
BuyPriceorDisc,
BuyQtyCostCode,
GetQty,
GetPriceorDisc,
GetQtyCostCode,
LandingCode,
ParentOrderNumber,
VendorVolumeDiscPercent,
RecWhCompanyNumber,
RecWhRequisitionNumber,
RecWhLineNumber,
ReturntoVendorLogNumber,
CommodityCode 
from openquery (bkl400, 
'select 
PDCONO	as CompanyNumber,
PDORID	as OrderID,
PDLNSQ	as LineSequenceNo,
PDITNO	as ItemNumber,
PDDLCD	as DeleteCode,
PDPDS1	as ItemDescription1,
PDPDS2	as ItemDescription2,
PDVNNO	as VendorNumber,
PDDUCC	as Century,
case PDDUCC 
when 19 then varchar_format(timestamp_format(char(PDDUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PDDUDT,6,0)),''YYMMDD''),''YYMMDD'') end as DueDate,
PDORQT	as OrderQuantity,
PDCAVC	as CurrentAverageCost,
PDMFNO	as ManufacturersItemNumber,
PDNOIN	as NonInventoryFlag,
PDUNMS	as UnitofMeasure,
PDPRUM	as PricingUM,
PDTXCD	as TaxableCode,
PDBLAM	as UnshippedAmount,
PDUNWT	as UnitWeight,
PDUSWT	as Unshippedweight,
PDLTCH	as LotChargeCode,
PDORAM	as OrderAmount,
PDORWT	as OrderedWeight,
PDDRSH	as DropShipCode,
PDITCL	as ItemClass,
PDITSC	as ItemSubClass,
PDWHID	as WarehouseID,
PDORCC	as OrderCentury,
case PDORCC 
when 19 then varchar_format(timestamp_format(char(PDORDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PDORDT,6,0)),''YYMMDD''),''YYMMDD'') end as OrderDate,
PDQRCD	as QuantityReceivedtodate,
PDLRCC	as LastReceiptCentury,
case PDLRCC 
when 19 then varchar_format(timestamp_format(char(PDLRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PDLRDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastReceiptDate,
PDACNO	as GeneralLedgerAccountNumber,
PDRQNO	as RequisitionNumber,
PDPONO	as PurchaseOrderNumber,
PDUPAV	as UpdateAverageCost,
PDUPIN	as UpdateInventoryCode,
PDACCS	as ActualCost,
PDNCCD	as NoChargeCode,
PDDSPC	as DiscountPercent,
PDUPRC	as UnpostedReceipts,
PDLNST	as LineItemStatus,
PDNWIT	as NewItemCode,
PDUS15	as CharacterUserArea15,
PDUPIA	as UpdateAIA,
PDWTTD	as TotActWgtRecvdtodate,
PDSOCD	as SpecialOrderCode,
PDRRCC	as RequestedReceiptCentury,
case PDRRCC 
when 19 then varchar_format(timestamp_format(char(PDRRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PDRRDT,6,0)),''YYMMDD''),''YYMMDD'') end as RequestedReceiptDate,
PDDPVN	as DueDtPromisbyVendorFlag,
PDFL07	as CharacterFillerField7,
PDLOSZ	as LocationSize,
PDFC01	as LandingFactor1,
PDFC02	as LandingFactor2,
PDFC03	as LandingFactor3,
PDFC04	as LandingFactor4,
PDFC05	as LandingFactor5,
PDFC06	as LandingFactor6,
PDLM01	as LandingMethod1,
PDLM02	as LandingMethod2,
PDLM03	as LandingMethod3,
PDLM04	as LandingMethod4,
PDLM05	as LandingMethod5,
PDLM06	as LandingMethod6,
PDLC01	as LandingCost1,
PDLC02	as LandingCost2,
PDLC03	as LandingCost3,
PDLC04	as LandingCost4,
PDLC05	as LandingCost5,
PDLC06	as LandingCost6,
PDLDFG	as LeadTimeCalc,
PDCNNM	as ContractNumber,
PDBYQT	as BuyQty,
PDBYPD	as BuyPriceorDisc,
PDBQCC	as BuyQtyCostCode,
PDGTQT	as GetQty,
PDGTPD	as GetPriceorDisc,
PDGQCC	as GetQtyCostCode,
PDLNCD	as LandingCode,
PDPRNO	as ParentOrderNumber,
PDVDSC	as VendorVolumeDiscPercent,
PDRWCO	as RecWhCompanyNumber,
PDRWRQ	as RecWhRequisitionNumber,
PDRWLN	as RecWhLineNumber,
PDRTVL	as ReturntoVendorLogNumber,
PDCMOD	as CommodityCode 
from APLUS2FAW.PODET')

create table APLUS2FAW.POHED (
CompanyNumber	int,
OrderID	varchar(6),
DeleteCode	varchar(1),
VendorNumber	varchar(6),
VendorName	varchar(30),
VendorAddressLine1	varchar(30),
VendorAddressLine2	varchar(30),
VendorCity	varchar(20),
VendorStateProvince	varchar(30),
VendorZipCode	varchar(10),
ShipToNumber	int,
ShipToName	varchar(30),
ShipToAddress1	varchar(30),
ShipToAddress2	varchar(30),
ShipToCity	varchar(20),
ShipToStateProvince	varchar(30),
ShipToZipCode	varchar(10),
WarehouseID	varchar(2),
OrderCentury	int,
OrderDate	Date,
QuoteNumber	varchar(15),
ShipVia	varchar(20),
RequisitionNumber	varchar(6),
PurchaseOrderNumber	varchar(6),
FOB	varchar(20),
Terms	varchar(20),
SalesTaxPercent	 DECIMAL	(5,3),
DropShipCode	varchar(1),
BuyerInitial	varchar(3),
TotalItemAmount	 DECIMAL	(9,2),
TotalSpecialCharges	 DECIMAL	(9,2),
SubtotItemsSpecChg	 DECIMAL	(9,2),
SalesTaxAmount	 DECIMAL	(9,2),
UnshippedPOTotal	 DECIMAL	(9,2),
UnshippedPOWeight	 DECIMAL	(13,4),
NumberofItems	int,
NumberofSpecialCharges	int,
ApprovalCode	varchar(3),
TotalPOValue	 DECIMAL	(9,2),
TotalPOWeight	 DECIMAL	(13,4),
DueCentury	int,
DueDate	Date,
LastChangCentury	int,
LastChangeDate	Date,
POReprintCode	varchar(1),
POChangeApprovalCode	varchar(3),
LastReceiptCentury	int,
LastReceiptDate	Date,
POPrintCentury	int,
POPrintDate	Date,
ReprintCentury	int,
ReprintDate	Date,
POStatus	varchar(1),
ConfirmingPO	varchar(1),
CompleteShip	varchar(1),
UpdateAverageCost	varchar(1),
UpdateOnHandQuantity	varchar(1),
POType	varchar(1),
Assignee	varchar(6),
DiscountPercent	 DECIMAL	(4,2),
InUseCode	varchar(1),
InUseWS	varchar(8),
LastUserID	varchar(8),
HoldCode	varchar(2),
ReceiptsPending	varchar(1),
CharacterUserArea15	varchar(15),
ReceiptEnteredatWSID	varchar(8),
UpdateVendItemCost	varchar(1),
CharacterFillerField79	varchar(79),
TotalCubesOrdered	 DECIMAL	(13,5),
TotalUnshippedCubes	 DECIMAL	(13,5),
TotalLandingCost1	 DECIMAL	(9,2),
TotalLandingCost2	 DECIMAL	(9,2),
TotalLandingCost3	 DECIMAL	(9,2),
TotalLandingCost4	 DECIMAL	(9,2),
TotalLandingCost5	 DECIMAL	(9,2),
TotalLandingCost6	 DECIMAL	(9,2),
DistributionMethod1	varchar(1),
DistributionMethod2	varchar(1),
DistributionMethod3	varchar(1),
DistributionMethod4	varchar(1),
DistributionMethod5	varchar(1),
DistributionMethod6	varchar(1),
VendorAddressLine3	varchar(30),
VendorCountry	varchar(3),
ShipToAddress3	varchar(30),
ShiptoCountry	varchar(3),
TradingCurrencyFlag	varchar(1),
EDIPO	varchar(1),
PrintPO	varchar(1),
Status	varchar(1),
EDIPOCentury	int,
EDIPODateSent	Date,
EDIPOTimeSent	Time,
HoldEDIPO	varchar(1),
NickName	varchar(10),
FaxPurchaseOrders	varchar(1),
ContractNumber	varchar(10),
ParentOrderNumber	int,
VendorVolumeDiscPercent	 DECIMAL	(5,3),
CostPercentOverride	varchar(1),
FreightTermsCode	varchar(1),
UnitsthisPO	DECIMAL	(10,3),
PickSlipPrintedFlag	varchar(1),
PickSlipPrintedCentury	int,
PickSlipPrintedDate	Date,
PickSlipPrintedTime	Time,
PickSlipPrintedbyUser	varchar(10),
VendorAddressLine4	varchar(30),
ShipToAddress4	varchar(30),
FOBCode	varchar(5),
ApprovalAmount	 DECIMAL	(10,2),
ModeofTransport	varchar(2),
EmailPurchaseOrders	varchar(1)
)

insert into APLUS2FAW.POHED(
CompanyNumber,
OrderID,
DeleteCode,
VendorNumber,
VendorName,
VendorAddressLine1,
VendorAddressLine2,
VendorCity,
VendorStateProvince,
VendorZipCode,
ShipToNumber,
ShipToName,
ShipToAddress1,
ShipToAddress2,
ShipToCity,
ShipToStateProvince,
ShipToZipCode,
WarehouseID,
OrderCentury,
OrderDate,
QuoteNumber,
ShipVia,
RequisitionNumber,
PurchaseOrderNumber,
FOB,
Terms,
SalesTaxPercent,
DropShipCode,
BuyerInitial,
TotalItemAmount,
TotalSpecialCharges,
SubtotItemsSpecChg,
SalesTaxAmount,
UnshippedPOTotal,
UnshippedPOWeight,
NumberofItems,
NumberofSpecialCharges,
ApprovalCode,
TotalPOValue,
TotalPOWeight,
DueCentury,
DueDate,
LastChangCentury,
LastChangeDate,
POReprintCode,
POChangeApprovalCode,
LastReceiptCentury,
LastReceiptDate,
POPrintCentury,
POPrintDate,
ReprintCentury,
ReprintDate,
POStatus,
ConfirmingPO,
CompleteShip,
UpdateAverageCost,
UpdateOnHandQuantity,
POType,
Assignee,
DiscountPercent,
InUseCode,
InUseWS,
LastUserID,
HoldCode,
ReceiptsPending,
CharacterUserArea15,
ReceiptEnteredatWSID,
UpdateVendItemCost,
CharacterFillerField79,
TotalCubesOrdered,
TotalUnshippedCubes,
TotalLandingCost1,
TotalLandingCost2,
TotalLandingCost3,
TotalLandingCost4,
TotalLandingCost5,
TotalLandingCost6,
DistributionMethod1,
DistributionMethod2,
DistributionMethod3,
DistributionMethod4,
DistributionMethod5,
DistributionMethod6,
VendorAddressLine3,
VendorCountry,
ShipToAddress3,
ShiptoCountry,
TradingCurrencyFlag,
EDIPO,
PrintPO,
Status,
EDIPOCentury,
EDIPODateSent,
EDIPOTimeSent,
HoldEDIPO,
NickName,
FaxPurchaseOrders,
ContractNumber,
ParentOrderNumber,
VendorVolumeDiscPercent,
CostPercentOverride,
FreightTermsCode,
UnitsthisPO,
PickSlipPrintedFlag,
PickSlipPrintedCentury,
PickSlipPrintedDate,
PickSlipPrintedTime,
PickSlipPrintedbyUser,
VendorAddressLine4,
ShipToAddress4,
FOBCode,
ApprovalAmount,
ModeofTransport,
EmailPurchaseOrders 
)
select TOP 10 
CompanyNumber,
OrderID,
DeleteCode,
VendorNumber,
VendorName,
VendorAddressLine1,
VendorAddressLine2,
VendorCity,
VendorStateProvince,
VendorZipCode,
ShipToNumber,
ShipToName,
ShipToAddress1,
ShipToAddress2,
ShipToCity,
ShipToStateProvince,
ShipToZipCode,
WarehouseID,
OrderCentury,
OrderDate,
QuoteNumber,
ShipVia,
RequisitionNumber,
PurchaseOrderNumber,
FOB,
Terms,
SalesTaxPercent,
DropShipCode,
BuyerInitial,
TotalItemAmount,
TotalSpecialCharges,
SubtotItemsSpecChg,
SalesTaxAmount,
UnshippedPOTotal,
UnshippedPOWeight,
NumberofItems,
NumberofSpecialCharges,
ApprovalCode,
TotalPOValue,
TotalPOWeight,
DueCentury,
DueDate,
LastChangCentury,
LastChangeDate,
POReprintCode,
POChangeApprovalCode,
LastReceiptCentury,
LastReceiptDate,
POPrintCentury,
POPrintDate,
ReprintCentury,
ReprintDate,
POStatus,
ConfirmingPO,
CompleteShip,
UpdateAverageCost,
UpdateOnHandQuantity,
POType,
Assignee,
DiscountPercent,
InUseCode,
InUseWS,
LastUserID,
HoldCode,
ReceiptsPending,
CharacterUserArea15,
ReceiptEnteredatWSID,
UpdateVendItemCost,
CharacterFillerField79,
TotalCubesOrdered,
TotalUnshippedCubes,
TotalLandingCost1,
TotalLandingCost2,
TotalLandingCost3,
TotalLandingCost4,
TotalLandingCost5,
TotalLandingCost6,
DistributionMethod1,
DistributionMethod2,
DistributionMethod3,
DistributionMethod4,
DistributionMethod5,
DistributionMethod6,
VendorAddressLine3,
VendorCountry,
ShipToAddress3,
ShiptoCountry,
TradingCurrencyFlag,
EDIPO,
PrintPO,
Status,
EDIPOCentury,
EDIPODateSent,
EDIPOTimeSent,
HoldEDIPO,
NickName,
FaxPurchaseOrders,
ContractNumber,
ParentOrderNumber,
VendorVolumeDiscPercent,
CostPercentOverride,
FreightTermsCode,
UnitsthisPO,
PickSlipPrintedFlag,
PickSlipPrintedCentury,
PickSlipPrintedDate,
PickSlipPrintedTime,
PickSlipPrintedbyUser,
VendorAddressLine4,
ShipToAddress4,
FOBCode,
ApprovalAmount,
ModeofTransport,
EmailPurchaseOrders 
from openquery (bkl400, 
'select 
PHCONO	as CompanyNumber,
PHORID	as OrderID,
PHDLCD	as DeleteCode,
PHVNNO	as VendorNumber,
PHVNNM	as VendorName,
PHVAD1	as VendorAddressLine1,
PHVAD2	as VendorAddressLine2,
PHVCTY	as VendorCity,
PHVNST	as VendorStateProvince,
PHVZIP	as VendorZipCode,
PHPOSH	as ShipToNumber,
PHSHNM	as ShipToName,
PHSAD1	as ShipToAddress1,
PHSAD2	as ShipToAddress2,
PHSCTY	as ShipToCity,
PHSHST	as ShipToStateProvince,
PHSZIP	as ShipToZipCode,
PHWHID	as WarehouseID,
PHORCC	as OrderCentury,
case PHORCC 
when 19 then varchar_format(timestamp_format(char(PHORDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHORDT,6,0)),''YYMMDD''),''YYMMDD'') end as OrderDate,
PHQUNO	as QuoteNumber,
PHSHVI	as ShipVia,
PHRQNO	as RequisitionNumber,
PHPONO	as PurchaseOrderNumber,
PHFOBD	as FOB,
PHTERM	as Terms,
PHTXPC	as SalesTaxPercent,
PHDRSH	as DropShipCode,
PHBUYR	as BuyerInitial,
PHITAM	as TotalItemAmount,
PHSCAM	as TotalSpecialCharges,
PHSUBT	as SubtotItemsSpecChg,
PHTXAM	as SalesTaxAmount,
PHPOAM	as UnshippedPOTotal,
PHPUWT	as UnshippedPOWeight,
PHNOIT	as NumberofItems,
PHNOSC	as NumberofSpecialCharges,
PHAPCD	as ApprovalCode,
PHPOVL	as TotalPOValue,
PHPOWT	as TotalPOWeight,
PHDUCC	as DueCentury,
case PHDUCC 
when 19 then varchar_format(timestamp_format(char(PHDUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHDUDT,6,0)),''YYMMDD''),''YYMMDD'') end as DueDate,
PHCHCC	as LastChangCentury,
case PHCHCC 
when 19 then varchar_format(timestamp_format(char(PHCHDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHCHDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastChangeDate,
PHPORP	as POReprintCode,
PHCAPC	as POChangeApprovalCode,
PHLRCC	as LastReceiptCentury,
case PHLRCC 
when 19 then varchar_format(timestamp_format(char(PHLRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHLRDT,6,0)),''YYMMDD''),''YYMMDD'') end as LastReceiptDate,
PHPRCC	as POPrintCentury,
case PHPRCC 
when 19 then varchar_format(timestamp_format(char(PHPRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHPRDT,6,0)),''YYMMDD''),''YYMMDD'') end as POPrintDate,
PHRPCC	as ReprintCentury,
case PHRPCC 
when 19 then varchar_format(timestamp_format(char(PHRPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHRPDT,6,0)),''YYMMDD''),''YYMMDD'') end as ReprintDate,
PHPOST	as POStatus,
PHCNFR	as ConfirmingPO,
PHCMSH	as CompleteShip,
PHUPAV	as UpdateAverageCost,
PHUPQT	as UpdateOnHandQuantity,
PHPOTP	as POType,
PHASGN	as Assignee,
PHDSPC	as DiscountPercent,
PHINUC	as InUseCode,
PHINUS	as InUseWS,
PHLUS8	as LastUserID,
PHHLCD	as HoldCode,
PHRCPN	as ReceiptsPending,
PHUS15	as CharacterUserArea15,
PHRCWS	as ReceiptEnteredatWSID,
PHUPV1	as UpdateVendItemCost,
PHFL79	as CharacterFillerField79,
PHPOCB	as TotalCubesOrdered,
PHUSCB	as TotalUnshippedCubes,
PHLC01	as TotalLandingCost1,
PHLC02	as TotalLandingCost2,
PHLC03	as TotalLandingCost3,
PHLC04	as TotalLandingCost4,
PHLC05	as TotalLandingCost5,
PHLC06	as TotalLandingCost6,
PHDM01	as DistributionMethod1,
PHDM02	as DistributionMethod2,
PHDM03	as DistributionMethod3,
PHDM04	as DistributionMethod4,
PHDM05	as DistributionMethod5,
PHDM06	as DistributionMethod6,
PHVAD3	as VendorAddressLine3,
PHVCID	as VendorCountry,
PHSAD3	as ShipToAddress3,
PHSCID	as ShiptoCountry,
PHTRFG	as TradingCurrencyFlag,
PHEIPO	as EDIPO,
PHPRPO	as PrintPO,
PHSTAS	as Status,
PHEPCC	as EDIPOCentury,
case PHEPCC 
when 19 then varchar_format(timestamp_format(char(PHEPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHEPDT,6,0)),''YYMMDD''),''YYMMDD'') end as EDIPODateSent,
time(to_date(digits(cast(PHEPTM as dec(6,0))),''HH24MISS'')) as EDIPOTimeSent,
PHEIPH	as HoldEDIPO,
PHNKNM	as NickName,
PHFXPO	as FaxPurchaseOrders,
PHCNNM	as ContractNumber,
PHPRNO	as ParentOrderNumber,
PHVDSC	as VendorVolumeDiscPercent,
PHDOVR	as CostPercentOverride,
PHFTCD	as FreightTermsCode,
PHPOUN	as UnitsthisPO,
PHPSPR	as PickSlipPrintedFlag,
PHPSCC	as PickSlipPrintedCentury,
case PHPSCC 
when 19 then varchar_format(timestamp_format(char(PHPSDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(PHPSDT,6,0)),''YYMMDD''),''YYMMDD'') end as PickSlipPrintedDate,
time(to_date(digits(cast(PHPSTM as dec(6,0))),''HH24MISS'')) as PickSlipPrintedTime,
PHPSUS	as PickSlipPrintedbyUser,
PHVAD4	as VendorAddressLine4,
PHSAD4	as ShipToAddress4,
PHFOBC	as FOBCode,
PHAPAM	as ApprovalAmount,
PHMDTP	as ModeofTransport,
PHEMPO	as EmailPurchaseOrders
from APLUS2FAW.POHED')


create table temp_ORHED1 (
CustomerNumber	int,
CompanyNumber	int,
OrderNumber	varchar(5),
OrderGenerationNumber	int,
OrderType	varchar(1),
OrderStatusCode	varchar(1),
CustomerName	varchar(30),
CustomerAddressLine1	varchar(30),
CustomerAddressLine2	varchar(30),
BillToCity	varchar(20),
BillToStateProvince	varchar(30),
BillToZipCode	varchar(10),
BillToContact	varchar(30),
BillToPhoneNumber	bigint,
ShipToNumber	varchar(7),
ShipToName	varchar(30),
ShipToAddress1	varchar(30),
ShipToAddress2	varchar(30),
ShipToCity	varchar(20),
ShipToStateProvince	varchar(30),
ShipToZipCode	varchar(10),
Contact	varchar(30),
ShipToPhoneNumber	int,
EntryCentury	int,
EntryDate	Date,
AcknowledgePrintCentury	int,
AcknowledgePrintDate	Date,
PickSlipPrintCentury	int,
PickSlipPrintDate	Date,
ShipConfirmCentury	int,
ShipConfirmDate	Date,
InvoicePrintCentury	int,
InvoicePrintDate	Date,
QuoteReviewCentury	int,
QuoteReviewDate	Date,
Route	varchar(4),
Stop	int,
CompleteShipCode	varchar(1),
BackorderCode	varchar(1),
PrintAcknowledgements	varchar(1),
RequestedShipCentury	int,
RequestedShipDate	Date,
InvoiceCentury	int,
InvoiceDate	Date,
DueCentury	int,
DueDate	Date,
NetCentury	int,
NetDate	Date,
FutureCentury	int,
FutureDate	Date,
CustomerPurchaseOrderNumber	varchar(22),
ShippingInstructions	varchar(20),
CreditCardAuthorization	varchar(7),
BackorderCreated	varchar(1),
KitBuildQtyHoldCode	varchar(1),
DeleteReasonCode	varchar(2),
MiscellaneousNote	varchar(30),
PaymentTypeCode	varchar(2),
CreditCardNumber	varchar(18),
CreditCardExpirationMonth	int, --MMYY
CreditCardExpirationYear	int,
CashDiscountPercent	 DECIMAL	(5,3),
CashDiscountAmount	 DECIMAL	(9,2),
ARTermsCode	varchar(2),
InvoiceNumber	int,
OrderReferenceNumber	varchar(6),
ContractNumber	varchar(5),
CustomerPriceList	int,
PriceDiscountCode	int,
OverridePriceDiscountPercent	 DECIMAL	(5,2),
TradeDiscountPercent	 DECIMAL	(5,2),
WarehouseID	varchar(2),
AllocatedCode	varchar(1),
PrimarySalesman	int,
SecondSalesman	int,
ThirdSalesman	int,
CommissionPercentRepNumberOne	 DECIMAL	(5,3),
CommissionPercentRepNumberTwo	 DECIMAL	(5,3),
CommissionPercentRepNumberThree	 DECIMAL	(5,3),
HoldCode	varchar(2),
LastUsertoReleasethisOrder	varchar(8),
LastHoldCode	varchar(2),
PriorHoldCode	varchar(2),
HighestSequenceNumber	int,
WorkStationId	varchar(2),
InUseProgram	varchar(8),
OriginalUserId	varchar(8),
LastUserID	varchar(8),
NumberofItems	int,
NumberofSpecialCharges	int,
NumberofMessages	int,
ItemSalesAmount	 DECIMAL	(9,2),
TotalSpecialCharges	 DECIMAL	(9,2),
TradeDiscountAmount	 DECIMAL	(9,2),
SalesTaxAmount	 DECIMAL	(9,2),
FederalExciseAmount	 DECIMAL	(9,2),
TotalContainerCharge	 DECIMAL	(9,2),
InvoiceAmount	 DECIMAL	(9,2),
ShipToTaxBody	varchar(6),
SalesTaxPercent	 DECIMAL	(5,3),
ExemptCode	varchar(1),
FederalExciseTaxCode	varchar(1),
AmountSubjecttoTax	 DECIMAL	(9,2),
ItemExemptAmount1	 DECIMAL	(9,2),
ItemExemptAmount2	 DECIMAL	(9,2),
ItemExemptAmount3	 DECIMAL	(9,2),
DropShipAmount	 DECIMAL	(9,2),
DepositAmount	 DECIMAL	(9,2),
AccountsReceivableCustomerAmount	 DECIMAL	(9,2),
AmountTendered	 DECIMAL	(9,2)
)


create table temp_ORHED2 (
CustomerNumber	int,
CompanyNumber	int,
OrderNumber	varchar(5),
TotalOrderValue	 DECIMAL	(9,2),
ExtendedOrderCost	 DECIMAL	(9,2),
NewOrderCode	varchar(1),
DropShipCode	varchar(1),
CustomerSortWord	varchar(10),
BlanketOrderCode	varchar(1),
Territory	varchar(3),
CustomerClass	varchar(2),
CustomerSubclass	varchar(2),
AccountsReceivableCustomerNumber	int,
BillToPhoneExtension	int,
ShipToPhoneExtension	int,
ShippedOrderWeight	 DECIMAL	(13,4),
HistoryID	int,
CatchWeightErrorCode	varchar(1),
UpdateAR	varchar(1),
CharacterUserArea15	varchar(15),
OrderPriority	varchar(1),
OrderSource	varchar(2),
CustomerGLCode	varchar(2),
ReturntoStock	varchar(1),
ARCustomerGLCode	varchar(2),
CharacterFillerField1	varchar(1),
ParentOrderNumber	int,
PickListRunNumber	int,
CarrierCode	varchar(5),
TotalCubesOrdered	 DECIMAL	(9,3),
TotalCubesShipped	 DECIMAL	(9,3),
UpdateDemand	varchar(1),
PrintInvoices	varchar(1),
EDIOrderYorblank	varchar(1),
EDIInvoices	varchar(1),
EDIInvoiceStatus	varchar(1),
HoldEDIInvoices	varchar(1),
EDIInvoiceInUseWS	varchar(2),
EDIInvoiceCentury	int,
EDIInvoiceDateSent	Date,
EDIInvoiceTimeSent	Time,
EDIAcknowledgements	varchar(1),
EDIAcknowledgementStatus	varchar(1),
HoldEDIAcknwldgmnts	varchar(1),
EDIAckInUseWS	varchar(2),
EDIAcknowldgementCentury	int,
EDIAcknowldgementDateSent	Date,
EDIAcknowldgementTimeSent	Time,
EDIAdvanceShipnotice	varchar(1),
EDIASNStatus	varchar(1),
HoldEDIASN	varchar(1),
EDIASNInUseWS	varchar(2),
EDIASNCentury	int,
EDIASNDateSent	Date,
EDIASNTimeSent	Time,
EDIOrderCreateTime	time,
FaxInvoices	varchar(1),
FaxAcknowledgements	varchar(1),
NickName	varchar(10),
CustomerAddress3	varchar(30),
BillToCountry	varchar(3),
BillToPhoneCountryCode	varchar(3),
ShiptoAddress3	varchar(30),
ShiptoCountry	varchar(3),
ShiptoPhoneCntryCode	varchar(3),
ShiptoGeoCode	int,
CancelDateCentury	int,
CancelDate	Date,
GST	varchar(1),
GSTTaxPercent	 DECIMAL	(5,3),
GSTAmount	 DECIMAL	(9,2),
PSTYesNoCompounded	varchar(1),
PSTTaxPercent	 DECIMAL	(5,3),
PSTAmount	 DECIMAL	(9,2),
ConsolidatedBillCode	varchar(2),
ConsolidatedInvControlNumber	int,
ConsolidatedInvPrtFlag	varchar(1),
CustomerContractCode	varchar(4),
AllocationCentury	int,
AllocationDate	Date,
ManualReleasedFutureOrder	varchar(1),
EntryTime	Time,
EntryUser	varchar(10),
AcknowledgePrintTime	Time,
AcknowledgePrintUser	varchar(10),
PickSlipPrintTime	Time,
PickSlipPrintUser	varchar(10),
ShipConfirmTime	Time,
ShipConfirmUser	varchar(10),
InvoicePrintTime	Time,
InvoicePrintUser	varchar(10),
PackerID	varchar(3),
PickerID	varchar(3),
DriverID	varchar(3),
ABRCommitmentSeq	varchar(30),
CustomerAddressLine4	varchar(30),
ShipToAddress4	varchar(30),
BillToPhoneNumberA	varchar(20),
ShipToPhoneNumberA	varchar(20),
FOBCode	varchar(5),
TaxExemptCertificateNumber	varchar(15),
ExpirationCentury	int,
ExpirationDate	Date,
ProNumber	varchar(20),
BillOfLadingNumber	varchar(20),
AllItemsBackOrderedFlag	varchar(1),
DaysinProcessCentry	int,
DaysinProcessDate	Date,
DaysinProcessTime	Time,
Department	varchar(5),
InternalVendorNumber	varchar(10),
EmailInvoices	varchar(1),
EmailAcknowledgements 	varchar(1)
)

insert into temp_ORHED1 (
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderType,
OrderStatusCode,
CustomerName,
CustomerAddressLine1,
CustomerAddressLine2,
BillToCity,
BillToStateProvince,
BillToZipCode,
BillToContact,
BillToPhoneNumber,
ShipToNumber,
ShipToName,
ShipToAddress1,
ShipToAddress2,
ShipToCity,
ShipToStateProvince,
ShipToZipCode,
Contact,
ShipToPhoneNumber,
EntryCentury,
EntryDate,
AcknowledgePrintCentury,
AcknowledgePrintDate,
PickSlipPrintCentury,
PickSlipPrintDate,
ShipConfirmCentury,
ShipConfirmDate,
InvoicePrintCentury,
InvoicePrintDate,
QuoteReviewCentury,
QuoteReviewDate,
Route,
Stop,
CompleteShipCode,
BackorderCode,
PrintAcknowledgements,
RequestedShipCentury,
RequestedShipDate,
InvoiceCentury,
InvoiceDate,
DueCentury,
DueDate,
NetCentury,
NetDate,
FutureCentury,
FutureDate,
CustomerPurchaseOrderNumber,
ShippingInstructions,
CreditCardAuthorization,
BackorderCreated,
KitBuildQtyHoldCode,
DeleteReasonCode,
MiscellaneousNote,
PaymentTypeCode,
CreditCardNumber,
CreditCardExpirationMonth,
CreditCardExpirationYear,
CashDiscountPercent,
CashDiscountAmount,
ARTermsCode,
InvoiceNumber,
OrderReferenceNumber,
ContractNumber,
CustomerPriceList,
PriceDiscountCode,
OverridePriceDiscountPercent,
TradeDiscountPercent,
WarehouseID,
AllocatedCode,
PrimarySalesman,
SecondSalesman,
ThirdSalesman,
CommissionPercentRepNumberOne,
CommissionPercentRepNumberTwo,
CommissionPercentRepNumberThree,
HoldCode,
LastUsertoReleasethisOrder,
LastHoldCode,
PriorHoldCode,
HighestSequenceNumber,
WorkStationId,
InUseProgram,
OriginalUserId,
LastUserID,
NumberofItems,
NumberofSpecialCharges,
NumberofMessages,
ItemSalesAmount,
TotalSpecialCharges,
TradeDiscountAmount,
SalesTaxAmount,
FederalExciseAmount,
TotalContainerCharge,
InvoiceAmount,
ShipToTaxBody,
SalesTaxPercent,
ExemptCode,
FederalExciseTaxCode,
AmountSubjecttoTax,
ItemExemptAmount1,
ItemExemptAmount2,
ItemExemptAmount3,
DropShipAmount,
DepositAmount,
AccountsReceivableCustomerAmount,
AmountTendered
)

select TOP 10 
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderType,
OrderStatusCode,
CustomerName,
CustomerAddressLine1,
CustomerAddressLine2,
BillToCity,
BillToStateProvince,
BillToZipCode,
BillToContact,
BillToPhoneNumber,
ShipToNumber,
ShipToName,
ShipToAddress1,
ShipToAddress2,
ShipToCity,
ShipToStateProvince,
ShipToZipCode,
Contact,
ShipToPhoneNumber,
EntryCentury,
EntryDate,
AcknowledgePrintCentury,
AcknowledgePrintDate,
PickSlipPrintCentury,
PickSlipPrintDate,
ShipConfirmCentury,
ShipConfirmDate,
InvoicePrintCentury,
InvoicePrintDate,
QuoteReviewCentury,
QuoteReviewDate,
Route,
Stop,
CompleteShipCode,
BackorderCode,
PrintAcknowledgements,
RequestedShipCentury,
RequestedShipDate,
InvoiceCentury,
InvoiceDate,
DueCentury,
DueDate,
NetCentury,
NetDate,
FutureCentury,
FutureDate,
CustomerPurchaseOrderNumber,
ShippingInstructions,
CreditCardAuthorization,
BackorderCreated,
KitBuildQtyHoldCode,
DeleteReasonCode,
MiscellaneousNote,
PaymentTypeCode,
CreditCardNumber,
CreditCardExpirationMonth,
CreditCardExpirationYear,
CashDiscountPercent,
CashDiscountAmount,
ARTermsCode,
InvoiceNumber,
OrderReferenceNumber,
ContractNumber,
CustomerPriceList,
PriceDiscountCode,
OverridePriceDiscountPercent,
TradeDiscountPercent,
WarehouseID,
AllocatedCode,
PrimarySalesman,
SecondSalesman,
ThirdSalesman,
CommissionPercentRepNumberOne,
CommissionPercentRepNumberTwo,
CommissionPercentRepNumberThree,
HoldCode,
LastUsertoReleasethisOrder,
LastHoldCode,
PriorHoldCode,
HighestSequenceNumber,
WorkStationId,
InUseProgram,
OriginalUserId,
LastUserID,
NumberofItems,
NumberofSpecialCharges,
NumberofMessages,
ItemSalesAmount,
TotalSpecialCharges,
TradeDiscountAmount,
SalesTaxAmount,
FederalExciseAmount,
TotalContainerCharge,
InvoiceAmount,
ShipToTaxBody,
SalesTaxPercent,
ExemptCode,
FederalExciseTaxCode,
AmountSubjecttoTax,
ItemExemptAmount1,
ItemExemptAmount2,
ItemExemptAmount3,
DropShipAmount,
DepositAmount,
AccountsReceivableCustomerAmount,
AmountTendered
from openquery (bkl400, 
'select 
OHCSNO	as CustomerNumber,
OHCONO	as CompanyNumber,
OHORNO	as OrderNumber,
OHORGN	as OrderGenerationNumber,
OHORTP	as OrderType,
OHORST	as OrderStatusCode,
OHCSNM	as CustomerName,
OHCAD1	as CustomerAddressLine1,
OHCAD2	as CustomerAddressLine2,
OHBLCY	as BillToCity,
OHBLST	as BillToStateProvince,
OHBLZP	as BillToZipCode,
OHBLCT	as BillToContact,
OHBLPH	as BillToPhoneNumber,
OHSHP#	as ShipToNumber,
OHSHNM	as ShipToName,
OHSAD1	as ShipToAddress1,
OHSAD2	as ShipToAddress2,
OHSCTY	as ShipToCity,
OHSHST	as ShipToStateProvince,
OHSZIP	as ShipToZipCode,
OHSCNT	as Contact,
OHSHPH	as ShipToPhoneNumber,
OHETCC	as EntryCentury,
case OHETCC 
When 19 then varchar_format(timestamp_format(char(OHETDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHETDT,6,0)),''YYMMDD''),''YYMMDD'') end as EntryDate,
OHACCC	as AcknowledgePrintCentury,
case OHACCC 
When 19 then varchar_format(timestamp_format(char(OHACDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHACDT,6,0)),''YYMMDD''),''YYMMDD'') end as AcknowledgePrintDate,
OHPPCC	as PickSlipPrintCentury,
case OHPPCC 
When 19 then varchar_format(timestamp_format(char(OHPPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHPPDT,6,0)),''YYMMDD''),''YYMMDD'') end as PickSlipPrintDate,
OHSCCC	as ShipConfirmCentury,
case OHSCCC 
When 19 then varchar_format(timestamp_format(char(OHSCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHSCDT,6,0)),''YYMMDD''),''YYMMDD'') end as ShipConfirmDate,
OHINCC	as InvoicePrintCentury,
case OHINCC 
When 19 then varchar_format(timestamp_format(char(OHINDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHINDT,6,0)),''YYMMDD''),''YYMMDD'') end as InvoicePrintDate,
OHQRCC	as QuoteReviewCentury,
case OHQRCC 
When 19 then varchar_format(timestamp_format(char(OHQRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHQRDT,6,0)),''YYMMDD''),''YYMMDD'') end as QuoteReviewDate,
OHROUT	as Route,
OHSTOP	as Stop,
OHCSCD	as CompleteShipCode,
OHBKCD	as BackorderCode,
OHPRAC	as PrintAcknowledgements,
OHRSCC	as RequestedShipCentury,
case OHRSCC 
When 19 then varchar_format(timestamp_format(char(OHRSDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHRSDT,6,0)),''YYMMDD''),''YYMMDD'') end as RequestedShipDate,
OHIVCC	as InvoiceCentury,
case OHIVCC 
When 19 then varchar_format(timestamp_format(char(OHIVDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHIVDT,6,0)),''YYMMDD''),''YYMMDD'') end as InvoiceDate,
OHDUCC	as DueCentury,
case OHDUCC 
When 19 then varchar_format(timestamp_format(char(OHDUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHDUDT,6,0)),''YYMMDD''),''YYMMDD'') end as DueDate,
OHNTCC	as NetCentury,
case OHNTCC 
When 19 then varchar_format(timestamp_format(char(OHNTDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHNTDT,6,0)),''YYMMDD''),''YYMMDD'') end as NetDate,
OHFUCC	as FutureCentury,
case OHFUCC 
When 19 then varchar_format(timestamp_format(char(OHFUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHFUDT,6,0)),''YYMMDD''),''YYMMDD'') end as FutureDate,
OHCSPO	as CustomerPurchaseOrderNumber,
OHSPIN	as ShippingInstructions,
OHCCAU	as CreditCardAuthorization,
OHBOCR	as BackorderCreated,
OHBLQH	as KitBuildQtyHoldCode,
OHDLRS	as DeleteReasonCode,
OHNOTE	as MiscellaneousNote,
OHPYTP	as PaymentTypeCode,
OHCRCD	as CreditCardNumber,
substr(char(LPAD(OHEXPD,4,0)),1,2) as CreditCardExpirationMonth,
substr(char(LPAD(OHEXPD,4,0)),3,4) as CreditCardExpirationYear,
OHCDSP	as CashDiscountPercent,
OHCDAM	as CashDiscountAmount,
OHTMCD	as ARTermsCode,
OHINNO	as InvoiceNumber,
OHORRF	as OrderReferenceNumber,
OHCNNR	as ContractNumber,
OHCPRL	as CustomerPriceList,
OHPRDS	as PriceDiscountCode,
OHOVDP	as OverridePriceDiscountPercent,
OHTDPC	as TradeDiscountPercent,
OHWHID	as WarehouseID,
OHALCD	as AllocatedCode,
OHSLS1	as PrimarySalesman,
OHSLS2	as SecondSalesman,
OHSLS3	as ThirdSalesman,
OHCPR1	as CommissionPercentRepNumberOne,
OHCPR2	as CommissionPercentRepNumberTwo,
OHCPR3	as CommissionPercentRepNumberThree,
OHHLCD	as HoldCode,
OHLUSR	as LastUsertoReleasethisOrder,
OHLSHL	as LastHoldCode,
OHPRHL	as PriorHoldCode,
OHHISQ	as HighestSequenceNumber,
OHWS02	as WorkStationId,
OHINUP	as InUseProgram,
OHORU8	as OriginalUserId,
OHLUS8	as LastUserID,
OHNOIT	as NumberofItems,
OHNOSC	as NumberofSpecialCharges,
OHNOMS	as NumberofMessages,
OHISAM	as ItemSalesAmount,
OHSCAM	as TotalSpecialCharges,
OHTDAM	as TradeDiscountAmount,
OHTXAM	as SalesTaxAmount,
OHFEAM	as FederalExciseAmount,
OHCNCT	as TotalContainerCharge,
OHINAM	as InvoiceAmount,
OHSTXB	as ShipToTaxBody,
OHTXPC	as SalesTaxPercent,
OHEXCD	as ExemptCode,
OHEXCS	as FederalExciseTaxCode,
OHASTX	as AmountSubjecttoTax,
OHEXM1	as ItemExemptAmount1,
OHEXM2	as ItemExemptAmount2,
OHEXM3	as ItemExemptAmount3,
OHDSAM	as DropShipAmount,
OHDPAM	as DepositAmount,
OHARC$	as AccountsReceivableCustomerAmount,
OHTNAM	as AmountTendered
from APLUS2FAW.ORHED')

insert into temp_ORHED2 (
CustomerNumber,
CompanyNumber,
OrderNumber,
TotalOrderValue,
ExtendedOrderCost,
NewOrderCode,
DropShipCode,
CustomerSortWord,
BlanketOrderCode,
Territory,
CustomerClass,
CustomerSubclass,
AccountsReceivableCustomerNumber,
BillToPhoneExtension,
ShipToPhoneExtension,
ShippedOrderWeight,
HistoryID,
CatchWeightErrorCode,
UpdateAR,
CharacterUserArea15,
OrderPriority,
OrderSource,
CustomerGLCode,
ReturntoStock,
ARCustomerGLCode,
CharacterFillerField1,
ParentOrderNumber,
PickListRunNumber,
CarrierCode,
TotalCubesOrdered,
TotalCubesShipped,
UpdateDemand,
PrintInvoices,
EDIOrderYorblank,
EDIInvoices,
EDIInvoiceStatus,
HoldEDIInvoices,
EDIInvoiceInUseWS,
EDIInvoiceCentury,
EDIInvoiceDateSent,
EDIInvoiceTimeSent,
EDIAcknowledgements,
EDIAcknowledgementStatus,
HoldEDIAcknwldgmnts,
EDIAckInUseWS,
EDIAcknowldgementCentury,
EDIAcknowldgementDateSent,
EDIAcknowldgementTimeSent,
EDIAdvanceShipnotice,
EDIASNStatus,
HoldEDIASN,
EDIASNInUseWS,
EDIASNCentury,
EDIASNDateSent,
EDIASNTimeSent,
EDIOrderCreateTime,
FaxInvoices,
FaxAcknowledgements,
NickName,
CustomerAddress3,
BillToCountry,
BillToPhoneCountryCode,
ShiptoAddress3,
ShiptoCountry,
ShiptoPhoneCntryCode,
ShiptoGeoCode,
CancelDateCentury,
CancelDate,
GST,
GSTTaxPercent,
GSTAmount,
PSTYesNoCompounded,
PSTTaxPercent,
PSTAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
CustomerContractCode,
AllocationCentury,
AllocationDate,
ManualReleasedFutureOrder,
EntryTime,
EntryUser,
AcknowledgePrintTime,
AcknowledgePrintUser,
PickSlipPrintTime,
PickSlipPrintUser,
ShipConfirmTime,
ShipConfirmUser,
InvoicePrintTime,
InvoicePrintUser,
PackerID,
PickerID,
DriverID,
ABRCommitmentSeq,
CustomerAddressLine4,
ShipToAddress4,
BillToPhoneNumberA,
ShipToPhoneNumberA,
FOBCode,
TaxExemptCertificateNumber,
ExpirationCentury,
ExpirationDate,
ProNumber,
BillOfLadingNumber,
AllItemsBackOrderedFlag,
DaysinProcessCentry,
DaysinProcessDate,
DaysinProcessTime,
Department,
InternalVendorNumber,
EmailInvoices,
EmailAcknowledgements 
)

Select top 10
CustomerNumber,
CompanyNumber,
OrderNumber,
TotalOrderValue,
ExtendedOrderCost,
NewOrderCode,
DropShipCode,
CustomerSortWord,
BlanketOrderCode,
Territory,
CustomerClass,
CustomerSubclass,
AccountsReceivableCustomerNumber,
BillToPhoneExtension,
ShipToPhoneExtension,
ShippedOrderWeight,
HistoryID,
CatchWeightErrorCode,
UpdateAR,
CharacterUserArea15,
OrderPriority,
OrderSource,
CustomerGLCode,
ReturntoStock,
ARCustomerGLCode,
CharacterFillerField1,
ParentOrderNumber,
PickListRunNumber,
CarrierCode,
TotalCubesOrdered,
TotalCubesShipped,
UpdateDemand,
PrintInvoices,
EDIOrderYorblank,
EDIInvoices,
EDIInvoiceStatus,
HoldEDIInvoices,
EDIInvoiceInUseWS,
EDIInvoiceCentury,
EDIInvoiceDateSent,
EDIInvoiceTimeSent,
EDIAcknowledgements,
EDIAcknowledgementStatus,
HoldEDIAcknwldgmnts,
EDIAckInUseWS,
EDIAcknowldgementCentury,
EDIAcknowldgementDateSent,
EDIAcknowldgementTimeSent,
EDIAdvanceShipnotice,
EDIASNStatus,
HoldEDIASN,
EDIASNInUseWS,
EDIASNCentury,
EDIASNDateSent,
EDIASNTimeSent,
EDIOrderCreateTime,
FaxInvoices,
FaxAcknowledgements,
NickName,
CustomerAddress3,
BillToCountry,
BillToPhoneCountryCode,
ShiptoAddress3,
ShiptoCountry,
ShiptoPhoneCntryCode,
ShiptoGeoCode,
CancelDateCentury,
CancelDate,
GST,
GSTTaxPercent,
GSTAmount,
PSTYesNoCompounded,
PSTTaxPercent,
PSTAmount,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ConsolidatedInvPrtFlag,
CustomerContractCode,
AllocationCentury,
AllocationDate,
ManualReleasedFutureOrder,
EntryTime,
EntryUser,
AcknowledgePrintTime,
AcknowledgePrintUser,
PickSlipPrintTime,
PickSlipPrintUser,
ShipConfirmTime,
ShipConfirmUser,
InvoicePrintTime,
InvoicePrintUser,
PackerID,
PickerID,
DriverID,
ABRCommitmentSeq,
CustomerAddressLine4,
ShipToAddress4,
BillToPhoneNumberA,
ShipToPhoneNumberA,
FOBCode,
TaxExemptCertificateNumber,
ExpirationCentury,
ExpirationDate,
ProNumber,
BillOfLadingNumber,
AllItemsBackOrderedFlag,
DaysinProcessCentry,
DaysinProcessDate,
DaysinProcessTime,
Department,
InternalVendorNumber,
EmailInvoices,
EmailAcknowledgements 
from openquery (bkl400,
'Select 
OHCSNO	as CustomerNumber,
OHCONO	as CompanyNumber,
OHORNO	as OrderNumber,
OHORVL	as TotalOrderValue,
OHORCS	as ExtendedOrderCost,
OHNWOR	as NewOrderCode,
OHDRSH	as DropShipCode,
OHCSRT	as CustomerSortWord,
OHBLKT	as BlanketOrderCode,
OHTERT	as Territory,
OHCSCL	as CustomerClass,
OHCSSC	as CustomerSubclass,
OHARCS	as AccountsReceivableCustomerNumber,
OHBLEX	as BillToPhoneExtension,
OHSHEX	as ShipToPhoneExtension,
OHSHWT	as ShippedOrderWeight,
OHHSID	as HistoryID,
OHCWER	as CatchWeightErrorCode,
OHUPAR	as UpdateAR,
OHUS15	as CharacterUserArea15,
OHORPR	as OrderPriority,
OHORSC	as OrderSource,
OHCSGL	as CustomerGLCode,
OHRTST	as ReturntoStock,
OHARGL	as ARCustomerGLCode,
OHFL01	as CharacterFillerField1,
OHPROR	as ParentOrderNumber,
OHPLRN	as PickListRunNumber,
OHCACD	as CarrierCode,
OHTCBO	as TotalCubesOrdered,
OHTCBS	as TotalCubesShipped,
OHUPDM	as UpdateDemand,
OHPRTI	as PrintInvoices,
OHEIOR	as EDIOrderYorblank,
OHEIIN	as EDIInvoices,
OHEINS	as EDIInvoiceStatus,
OHEIIH	as HoldEDIInvoices,
OHEIIW	as EDIInvoiceInUseWS,
OHEINC	as EDIInvoiceCentury,
case OHEINC 
When 19 then varchar_format(timestamp_format(char(OHEIND+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHEIND,6,0)),''YYMMDD''),''YYMMDD'') end as EDIInvoiceDateSent,
time(to_date(digits(cast(OHEINT as dec(6,0))),''HH24MISS'')) as EDIInvoiceTimeSent,
OHEIAK	as EDIAcknowledgements,
OHEAKS	as EDIAcknowledgementStatus,
OHEIAH	as HoldEDIAcknwldgmnts,
OHEIAW	as EDIAckInUseWS,
OHEAKC	as EDIAcknowldgementCentury,
case OHEAKC 
When 19 then varchar_format(timestamp_format(char(OHEAKD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHEAKD,6,0)),''YYMMDD''),''YYMMDD'') end as EDIAcknowldgementDateSent,
time(to_date(digits(cast(OHEAKT as dec(6,0))),''HH24MISS'')) as EDIAcknowldgementTimeSent,
OHEIAS	as EDIAdvanceShipnotice,
OHEASS	as EDIASNStatus,
OHEASH	as HoldEDIASN,
OHEISW	as EDIASNInUseWS,
OHEASC	as EDIASNCentury,
case OHEASC 
When 19 then varchar_format(timestamp_format(char(OHEASD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHEASD,6,0)),''YYMMDD''),''YYMMDD'') end as EDIASNDateSent,
time(to_date(digits(cast(OHEAST as dec(6,0))),''HH24MISS'')) as EDIASNTimeSent,
time(to_date(digits(cast(OHEICT as dec(6,0))),''HH24MISS'')) as EDIOrderCreateTime,
OHFXIN	as FaxInvoices,
OHFXAK	as FaxAcknowledgements,
OHNKNM	as NickName,
OHCAD3	as CustomerAddress3,
OHCTID	as BillToCountry,
OHCTCD	as BillToPhoneCountryCode,
OHSAD3	as ShiptoAddress3,
OHSHCI	as ShiptoCountry,
OHSHCD	as ShiptoPhoneCntryCode,
OHSGEO	as ShiptoGeoCode,
OHCLCC	as CancelDateCentury,
case OHCLCC 
When 19 then varchar_format(timestamp_format(char(OHCLDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHCLDT,6,0)),''YYMMDD''),''YYMMDD'') end as CancelDate,
OHGTYN	as GST,
OHGTXP	as GSTTaxPercent,
OHGTXA	as GSTAmount,
OHPTYN	as PSTYesNoCompounded,
OHPTXP	as PSTTaxPercent,
OHPTXA	as PSTAmount,
OHCBCD	as ConsolidatedBillCode,
OHCICT	as ConsolidatedInvControlNumber,
OHCIPF	as ConsolidatedInvPrtFlag,
OHCSCT	as CustomerContractCode,
OHALCC	as AllocationCentury,
case OHALCC 
When 19 then varchar_format(timestamp_format(char(OHALDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHALDT,6,0)),''YYMMDD''),''YYMMDD'') end as AllocationDate,
OHMRLF	as ManualReleasedFutureOrder,
time(to_date(digits(cast(OHETTM as dec(6,0))),''HH24MISS'')) as EntryTime,
OHETUS	as EntryUser,
time(to_date(digits(cast(OHACTM as dec(6,0))),''HH24MISS'')) as AcknowledgePrintTime,
OHACUS	as AcknowledgePrintUser,
time(to_date(digits(cast(OHPPTM as dec(6,0))),''HH24MISS'')) as PickSlipPrintTime,
OHPPUS	as PickSlipPrintUser,
time(to_date(digits(cast(OHSCTM as dec(6,0))),''HH24MISS'')) as ShipConfirmTime,
OHSCUS	as ShipConfirmUser,
time(to_date(digits(cast(OHINTM as dec(6,0))),''HH24MISS'')) as InvoicePrintTime,
OHINUR	as InvoicePrintUser,
OHPACC	as PackerID,
OHPICC	as PickerID,
OHDRVC	as DriverID,
OHABRS	as ABRCommitmentSeq,
OHCAD4	as CustomerAddressLine4,
OHSAD4	as ShipToAddress4,
OHBPHA	as BillToPhoneNumberA,
OHSPHA	as ShipToPhoneNumberA,
OHFOBC	as FOBCode,
OHEXNO	as TaxExemptCertificateNumber,
OHEXCC	as ExpirationCentury,
case OHEXCC 
When 19 then varchar_format(timestamp_format(char(OHEXDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHEXDT,6,0)),''YYMMDD''),''YYMMDD'') end as ExpirationDate,
OHPRON	as ProNumber,
OHBOLN	as BillOfLadingNumber,
OHOBOF	as AllItemsBackOrderedFlag,
OHDPCC	as DaysinProcessCentry,
case OHDPCC 
When 19 then varchar_format(timestamp_format(char(OHDPDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(OHDPDT,6,0)),''YYMMDD''),''YYMMDD'') end as DaysinProcessDate,
time(to_date(digits(cast(OHDPTM as dec(6,0))),''HH24MISS'')) as DaysinProcessTime,
OHDEPT	as Department,
OHIAVN	as InternalVendorNumber,
OHEMIN	as EmailInvoices,
OHEMAK	as EmailAcknowledgements 
from APLUS2FAW.ORHED')

create table APLUS2FAW.ORHED(
CustomerNumber	int,
CompanyNumber	int,
OrderNumber	varchar(5),
OrderGenerationNumber	int,
OrderType	varchar(1),
OrderStatusCode	varchar(1),
CustomerName	varchar(30),
CustomerAddressLine1	varchar(30),
CustomerAddressLine2	varchar(30),
BillToCity	varchar(20),
BillToStateProvince	varchar(30),
BillToZipCode	varchar(10),
BillToContact	varchar(30),
BillToPhoneNumber	bigint,
ShipToNumber	varchar(7),
ShipToName	varchar(30),
ShipToAddress1	varchar(30),
ShipToAddress2	varchar(30),
ShipToCity	varchar(20),
ShipToStateProvince	varchar(30),
ShipToZipCode	varchar(10),
Contact	varchar(30),
ShipToPhoneNumber	int,
EntryCentury	int,
EntryDate	Date,
AcknowledgePrintCentury	int,
AcknowledgePrintDate	Date,
PickSlipPrintCentury	int,
PickSlipPrintDate	Date,
ShipConfirmCentury	int,
ShipConfirmDate	Date,
InvoicePrintCentury	int,
InvoicePrintDate	Date,
QuoteReviewCentury	int,
QuoteReviewDate	Date,
Route	varchar(4),
Stop	int,
CompleteShipCode	varchar(1),
BackorderCode	varchar(1),
PrintAcknowledgements	varchar(1),
RequestedShipCentury	int,
RequestedShipDate	Date,
InvoiceCentury	int,
InvoiceDate	Date,
DueCentury	int,
DueDate	Date,
NetCentury	int,
NetDate	Date,
FutureCentury	int,
FutureDate	Date,
CustomerPurchaseOrderNumber	varchar(22),
ShippingInstructions	varchar(20),
CreditCardAuthorization	varchar(7),
BackorderCreated	varchar(1),
KitBuildQtyHoldCode	varchar(1),
DeleteReasonCode	varchar(2),
MiscellaneousNote	varchar(30),
PaymentTypeCode	varchar(2),
CreditCardNumber	varchar(18),
CreditCardExpirationMonth	int, --MMYY
CreditCardExpirationYear	int,
CashDiscountPercent	 DECIMAL	(5,3),
CashDiscountAmount	 DECIMAL	(9,2),
ARTermsCode	varchar(2),
InvoiceNumber	int,
OrderReferenceNumber	varchar(6),
ContractNumber	varchar(5),
CustomerPriceList	int,
PriceDiscountCode	int,
OverridePriceDiscountPercent	 DECIMAL	(5,2),
TradeDiscountPercent	 DECIMAL	(5,2),
WarehouseID	varchar(2),
AllocatedCode	varchar(1),
PrimarySalesman	int,
SecondSalesman	int,
ThirdSalesman	int,
CommissionPercentRepNumberOne	 DECIMAL	(5,3),
CommissionPercentRepNumberTwo	 DECIMAL	(5,3),
CommissionPercentRepNumberThree	 DECIMAL	(5,3),
HoldCode	varchar(2),
LastUsertoReleasethisOrder	varchar(8),
LastHoldCode	varchar(2),
PriorHoldCode	varchar(2),
HighestSequenceNumber	int,
WorkStationId	varchar(2),
InUseProgram	varchar(8),
OriginalUserId	varchar(8),
LastUserID	varchar(8),
NumberofItems	int,
NumberofSpecialCharges	int,
NumberofMessages	int,
ItemSalesAmount	 DECIMAL	(9,2),
TotalSpecialCharges	 DECIMAL	(9,2),
TradeDiscountAmount	 DECIMAL	(9,2),
SalesTaxAmount	 DECIMAL	(9,2),
FederalExciseAmount	 DECIMAL	(9,2),
TotalContainerCharge	 DECIMAL	(9,2),
InvoiceAmount	 DECIMAL	(9,2),
ShipToTaxBody	varchar(6),
SalesTaxPercent	 DECIMAL	(5,3),
ExemptCode	varchar(1),
FederalExciseTaxCode	varchar(1),
AmountSubjecttoTax	 DECIMAL	(9,2),
ItemExemptAmount1	 DECIMAL	(9,2),
ItemExemptAmount2	 DECIMAL	(9,2),
ItemExemptAmount3	 DECIMAL	(9,2),
DropShipAmount	 DECIMAL	(9,2),
DepositAmount	 DECIMAL	(9,2),
AccountsReceivableCustomerAmount	 DECIMAL	(9,2),
AmountTendered	 DECIMAL	(9,2),
TotalOrderValue	 DECIMAL	(9,2),
ExtendedOrderCost	 DECIMAL	(9,2),
NewOrderCode	varchar(1),
DropShipCode	varchar(1),
CustomerSortWord	varchar(10),
BlanketOrderCode	varchar(1),
Territory	varchar(3),
CustomerClass	varchar(2),
CustomerSubclass	varchar(2),
AccountsReceivableCustomerNumber	int,
BillToPhoneExtension	int,
ShipToPhoneExtension	int,
ShippedOrderWeight	 DECIMAL	(13,4),
HistoryID	int,
CatchWeightErrorCode	varchar(1),
UpdateAR	varchar(1),
CharacterUserArea15	varchar(15),
OrderPriority	varchar(1),
OrderSource	varchar(2),
CustomerGLCode	varchar(2),
ReturntoStock	varchar(1),
ARCustomerGLCode	varchar(2),
CharacterFillerField1	varchar(1),
ParentOrderNumber	int,
PickListRunNumber	int,
CarrierCode	varchar(5),
TotalCubesOrdered	 DECIMAL	(9,3),
TotalCubesShipped	 DECIMAL	(9,3),
UpdateDemand	varchar(1),
PrintInvoices	varchar(1),
EDIOrderYorblank	varchar(1),
EDIInvoices	varchar(1),
EDIInvoiceStatus	varchar(1),
HoldEDIInvoices	varchar(1),
EDIInvoiceInUseWS	varchar(2),
EDIInvoiceCentury	int,
EDIInvoiceDateSent	Date,
EDIInvoiceTimeSent	Time,
EDIAcknowledgements	varchar(1),
EDIAcknowledgementStatus	varchar(1),
HoldEDIAcknwldgmnts	varchar(1),
EDIAckInUseWS	varchar(2),
EDIAcknowldgementCentury	int,
EDIAcknowldgementDateSent	Date,
EDIAcknowldgementTimeSent	Time,
EDIAdvanceShipnotice	varchar(1),
EDIASNStatus	varchar(1),
HoldEDIASN	varchar(1),
EDIASNInUseWS	varchar(2),
EDIASNCentury	int,
EDIASNDateSent	Date,
EDIASNTimeSent	Time,
EDIOrderCreateTime	time,
FaxInvoices	varchar(1),
FaxAcknowledgements	varchar(1),
NickName	varchar(10),
CustomerAddress3	varchar(30),
BillToCountry	varchar(3),
BillToPhoneCountryCode	varchar(3),
ShiptoAddress3	varchar(30),
ShiptoCountry	varchar(3),
ShiptoPhoneCntryCode	varchar(3),
ShiptoGeoCode	int,
CancelDateCentury	int,
CancelDate	Date,
GST	varchar(1),
GSTTaxPercent	 DECIMAL	(5,3),
GSTAmount	 DECIMAL	(9,2),
PSTYesNoCompounded	varchar(1),
PSTTaxPercent	 DECIMAL	(5,3),
PSTAmount	 DECIMAL	(9,2),
ConsolidatedBillCode	varchar(2),
ConsolidatedInvControlNumber	int,
ConsolidatedInvPrtFlag	varchar(1),
CustomerContractCode	varchar(4),
AllocationCentury	int,
AllocationDate	Date,
ManualReleasedFutureOrder	varchar(1),
EntryTime	Time,
EntryUser	varchar(10),
AcknowledgePrintTime	Time,
AcknowledgePrintUser	varchar(10),
PickSlipPrintTime	Time,
PickSlipPrintUser	varchar(10),
ShipConfirmTime	Time,
ShipConfirmUser	varchar(10),
InvoicePrintTime	Time,
InvoicePrintUser	varchar(10),
PackerID	varchar(3),
PickerID	varchar(3),
DriverID	varchar(3),
ABRCommitmentSeq	varchar(30),
CustomerAddressLine4	varchar(30),
ShipToAddress4	varchar(30),
BillToPhoneNumberA	varchar(20),
ShipToPhoneNumberA	varchar(20),
FOBCode	varchar(5),
TaxExemptCertificateNumber	varchar(15),
ExpirationCentury	int,
ExpirationDate	Date,
ProNumber	varchar(20),
BillOfLadingNumber	varchar(20),
AllItemsBackOrderedFlag	varchar(1),
DaysinProcessCentry	int,
DaysinProcessDate	Date,
DaysinProcessTime	Time,
Department	varchar(5),
InternalVendorNumber	varchar(10),
EmailInvoices	varchar(1),
EmailAcknowledgements 	varchar(1)
)


insert into APLUS2FAW.ORHED (
CustomerNumber,
      CompanyNumber,
      OrderNumber,
      OrderGenerationNumber,
      OrderType,
      OrderStatusCode,
      CustomerName,
      CustomerAddressLine1,
      CustomerAddressLine2,
      BillToCity,
      BillToStateProvince,
      BillToZipCode,
      BillToContact,
      BillToPhoneNumber,
      ShipToNumber,
      ShipToName,
      ShipToAddress1,
      ShipToAddress2,
      ShipToCity,
      ShipToStateProvince,
      ShipToZipCode,
      Contact,
      ShipToPhoneNumber,
      EntryCentury,
      EntryDate,
      AcknowledgePrintCentury,
      AcknowledgePrintDate,
      PickSlipPrintCentury,
      PickSlipPrintDate,
      ShipConfirmCentury,
      ShipConfirmDate,
      InvoicePrintCentury,
      InvoicePrintDate,
      QuoteReviewCentury,
      QuoteReviewDate,
      Route,
      Stop,
      CompleteShipCode,
      BackorderCode,
      PrintAcknowledgements,
      RequestedShipCentury,
      RequestedShipDate,
      InvoiceCentury,
      InvoiceDate,
      DueCentury,
      DueDate,
      NetCentury,
      NetDate,
      FutureCentury,
      FutureDate,
      CustomerPurchaseOrderNumber,
      ShippingInstructions,
      CreditCardAuthorization,
      BackorderCreated,
      KitBuildQtyHoldCode,
      DeleteReasonCode,
      MiscellaneousNote,
      PaymentTypeCode,
      CreditCardNumber,
      CreditCardExpirationMonth,
      CreditCardExpirationYear,
      CashDiscountPercent,
      CashDiscountAmount,
      ARTermsCode,
      InvoiceNumber,
      OrderReferenceNumber,
      ContractNumber,
      CustomerPriceList,
      PriceDiscountCode,
      OverridePriceDiscountPercent,
      TradeDiscountPercent,
      WarehouseID,
      AllocatedCode,
      PrimarySalesman,
      SecondSalesman,
      ThirdSalesman,
      CommissionPercentRepNumberOne,
      CommissionPercentRepNumberTwo,
      CommissionPercentRepNumberThree,
      HoldCode,
      LastUsertoReleasethisOrder,
      LastHoldCode,
      PriorHoldCode,
      HighestSequenceNumber,
      WorkStationId,
      InUseProgram,
      OriginalUserId,
      LastUserID,
      NumberofItems,
      NumberofSpecialCharges,
      NumberofMessages,
      ItemSalesAmount,
      TotalSpecialCharges,
      TradeDiscountAmount,
      SalesTaxAmount,
      FederalExciseAmount,
      TotalContainerCharge,
      InvoiceAmount,
      ShipToTaxBody,
      SalesTaxPercent,
      ExemptCode,
      FederalExciseTaxCode,
      AmountSubjecttoTax,
      ItemExemptAmount1,
      ItemExemptAmount2,
      ItemExemptAmount3,
      DropShipAmount,
      DepositAmount,
      AccountsReceivableCustomerAmount,
      AmountTendered,
	  TotalOrderValue,
      ExtendedOrderCost,
      NewOrderCode,
      DropShipCode,
      CustomerSortWord,
      BlanketOrderCode,
      Territory,
      CustomerClass,
      CustomerSubclass,
      AccountsReceivableCustomerNumber,
      BillToPhoneExtension,
      ShipToPhoneExtension,
      ShippedOrderWeight,
      HistoryID,
      CatchWeightErrorCode,
      UpdateAR,
      CharacterUserArea15,
      OrderPriority,
      OrderSource,
      CustomerGLCode,
      ReturntoStock,
      ARCustomerGLCode,
      CharacterFillerField1,
      ParentOrderNumber,
      PickListRunNumber,
      CarrierCode,
      TotalCubesOrdered,
      TotalCubesShipped,
      UpdateDemand,
      PrintInvoices,
      EDIOrderYorblank,
      EDIInvoices,
      EDIInvoiceStatus,
      HoldEDIInvoices,
      EDIInvoiceInUseWS,
      EDIInvoiceCentury,
      EDIInvoiceDateSent,
      EDIInvoiceTimeSent,
      EDIAcknowledgements,
      EDIAcknowledgementStatus,
      HoldEDIAcknwldgmnts,
      EDIAckInUseWS,
      EDIAcknowldgementCentury,
      EDIAcknowldgementDateSent,
      EDIAcknowldgementTimeSent,
      EDIAdvanceShipnotice,
      EDIASNStatus,
      HoldEDIASN,
      EDIASNInUseWS,
      EDIASNCentury,
      EDIASNDateSent,
      EDIASNTimeSent,
      EDIOrderCreateTime,
      FaxInvoices,
      FaxAcknowledgements,
      NickName,
      CustomerAddress3,
      BillToCountry,
      BillToPhoneCountryCode,
      ShiptoAddress3,
      ShiptoCountry,
      ShiptoPhoneCntryCode,
      ShiptoGeoCode,
      CancelDateCentury,
      CancelDate,
      GST,
      GSTTaxPercent,
      GSTAmount,
      PSTYesNoCompounded,
      PSTTaxPercent,
      PSTAmount,
      ConsolidatedBillCode,
      ConsolidatedInvControlNumber,
      ConsolidatedInvPrtFlag,
      CustomerContractCode,
      AllocationCentury,
      AllocationDate,
      ManualReleasedFutureOrder,
      EntryTime,
      EntryUser,
      AcknowledgePrintTime,
      AcknowledgePrintUser,
      PickSlipPrintTime,
      PickSlipPrintUser,
      ShipConfirmTime,
      ShipConfirmUser,
      InvoicePrintTime,
      InvoicePrintUser,
      PackerID,
      PickerID,
      DriverID,
      ABRCommitmentSeq,
      CustomerAddressLine4,
      ShipToAddress4,
      BillToPhoneNumberA,
      ShipToPhoneNumberA,
      FOBCode,
      TaxExemptCertificateNumber,
      ExpirationCentury,
      ExpirationDate,
      ProNumber,
      BillOfLadingNumber,
      AllItemsBackOrderedFlag,
      DaysinProcessCentry,
      DaysinProcessDate,
      DaysinProcessTime,
      Department,
      InternalVendorNumber,
      EmailInvoices,
      EmailAcknowledgements
	  )
SELECT o1.CustomerNumber,
      o1.CompanyNumber,
      o1.OrderNumber,
      OrderGenerationNumber,
      OrderType,
      OrderStatusCode,
      CustomerName,
      CustomerAddressLine1,
      CustomerAddressLine2,
      BillToCity,
      BillToStateProvince,
      BillToZipCode,
      BillToContact,
      BillToPhoneNumber,
      ShipToNumber,
      ShipToName,
      ShipToAddress1,
      ShipToAddress2,
      ShipToCity,
      ShipToStateProvince,
      ShipToZipCode,
      Contact,
      ShipToPhoneNumber,
      EntryCentury,
      EntryDate,
      AcknowledgePrintCentury,
      AcknowledgePrintDate,
      PickSlipPrintCentury,
      PickSlipPrintDate,
      ShipConfirmCentury,
      ShipConfirmDate,
      InvoicePrintCentury,
      InvoicePrintDate,
      QuoteReviewCentury,
      QuoteReviewDate,
      Route,
      Stop,
      CompleteShipCode,
      BackorderCode,
      PrintAcknowledgements,
      RequestedShipCentury,
      RequestedShipDate,
      InvoiceCentury,
      InvoiceDate,
      DueCentury,
      DueDate,
      NetCentury,
      NetDate,
      FutureCentury,
      FutureDate,
      CustomerPurchaseOrderNumber,
      ShippingInstructions,
      CreditCardAuthorization,
      BackorderCreated,
      KitBuildQtyHoldCode,
      DeleteReasonCode,
      MiscellaneousNote,
      PaymentTypeCode,
      CreditCardNumber,
      CreditCardExpirationMonth,
      CreditCardExpirationYear,
      CashDiscountPercent,
      CashDiscountAmount,
      ARTermsCode,
      InvoiceNumber,
      OrderReferenceNumber,
      ContractNumber,
      CustomerPriceList,
      PriceDiscountCode,
      OverridePriceDiscountPercent,
      TradeDiscountPercent,
      WarehouseID,
      AllocatedCode,
      PrimarySalesman,
      SecondSalesman,
      ThirdSalesman,
      CommissionPercentRepNumberOne,
      CommissionPercentRepNumberTwo,
      CommissionPercentRepNumberThree,
      HoldCode,
      LastUsertoReleasethisOrder,
      LastHoldCode,
      PriorHoldCode,
      HighestSequenceNumber,
      WorkStationId,
      InUseProgram,
      OriginalUserId,
      LastUserID,
      NumberofItems,
      NumberofSpecialCharges,
      NumberofMessages,
      ItemSalesAmount,
      TotalSpecialCharges,
      TradeDiscountAmount,
      SalesTaxAmount,
      FederalExciseAmount,
      TotalContainerCharge,
      InvoiceAmount,
      ShipToTaxBody,
      SalesTaxPercent,
      ExemptCode,
      FederalExciseTaxCode,
      AmountSubjecttoTax,
      ItemExemptAmount1,
      ItemExemptAmount2,
      ItemExemptAmount3,
      DropShipAmount,
      DepositAmount,
      AccountsReceivableCustomerAmount,
      AmountTendered,
	  TotalOrderValue,
      ExtendedOrderCost,
      NewOrderCode,
      DropShipCode,
      CustomerSortWord,
      BlanketOrderCode,
      Territory,
      CustomerClass,
      CustomerSubclass,
      AccountsReceivableCustomerNumber,
      BillToPhoneExtension,
      ShipToPhoneExtension,
      ShippedOrderWeight,
      HistoryID,
      CatchWeightErrorCode,
      UpdateAR,
      CharacterUserArea15,
      OrderPriority,
      OrderSource,
      CustomerGLCode,
      ReturntoStock,
      ARCustomerGLCode,
      CharacterFillerField1,
      ParentOrderNumber,
      PickListRunNumber,
      CarrierCode,
      TotalCubesOrdered,
      TotalCubesShipped,
      UpdateDemand,
      PrintInvoices,
      EDIOrderYorblank,
      EDIInvoices,
      EDIInvoiceStatus,
      HoldEDIInvoices,
      EDIInvoiceInUseWS,
      EDIInvoiceCentury,
      EDIInvoiceDateSent,
      EDIInvoiceTimeSent,
      EDIAcknowledgements,
      EDIAcknowledgementStatus,
      HoldEDIAcknwldgmnts,
      EDIAckInUseWS,
      EDIAcknowldgementCentury,
      EDIAcknowldgementDateSent,
      EDIAcknowldgementTimeSent,
      EDIAdvanceShipnotice,
      EDIASNStatus,
      HoldEDIASN,
      EDIASNInUseWS,
      EDIASNCentury,
      EDIASNDateSent,
      EDIASNTimeSent,
      EDIOrderCreateTime,
      FaxInvoices,
      FaxAcknowledgements,
      NickName,
      CustomerAddress3,
      BillToCountry,
      BillToPhoneCountryCode,
      ShiptoAddress3,
      ShiptoCountry,
      ShiptoPhoneCntryCode,
      ShiptoGeoCode,
      CancelDateCentury,
      CancelDate,
      GST,
      GSTTaxPercent,
      GSTAmount,
      PSTYesNoCompounded,
      PSTTaxPercent,
      PSTAmount,
      ConsolidatedBillCode,
      ConsolidatedInvControlNumber,
      ConsolidatedInvPrtFlag,
      CustomerContractCode,
      AllocationCentury,
      AllocationDate,
      ManualReleasedFutureOrder,
      EntryTime,
      EntryUser,
      AcknowledgePrintTime,
      AcknowledgePrintUser,
      PickSlipPrintTime,
      PickSlipPrintUser,
      ShipConfirmTime,
      ShipConfirmUser,
      InvoicePrintTime,
      InvoicePrintUser,
      PackerID,
      PickerID,
      DriverID,
      ABRCommitmentSeq,
      CustomerAddressLine4,
      ShipToAddress4,
      BillToPhoneNumberA,
      ShipToPhoneNumberA,
      FOBCode,
      TaxExemptCertificateNumber,
      ExpirationCentury,
      ExpirationDate,
      ProNumber,
      BillOfLadingNumber,
      AllItemsBackOrderedFlag,
      DaysinProcessCentry,
      DaysinProcessDate,
      DaysinProcessTime,
      Department,
      InternalVendorNumber,
      EmailInvoices,
      EmailAcknowledgements
  FROM BAM.dbo.temp_ORHED1 o1 inner join
  BAM.dbo.temp_ORHED2 o2 on o1.CustomerNumber = o2.CustomerNumber and o1.CompanyNumber = o2.CompanyNumber and o1.OrderNumber = o2.OrderNumber


Create table APLUS2FAW.ORDET (
CustomerNumber	int,
CompanyNumber	int,
OrderNumber	varchar(5),
OrderGenerationNumber	int,
OrderSequenceNumber	int,
LineItemType	varchar(1),
ShipToNumber	varchar(7),
SalesRepNumber	int,
WarehouseID	varchar(2),
OrderType	varchar(1),
OrderStatusCode	varchar(1),
OrderHoldCode	varchar(2),
DueCentury	int,
DueDate	Date,
LotCode	varchar(10),
ItemNumber	varchar(27),
ItemDescription1	varchar(31),
ItemDescription2	varchar(31),
QuantityOrdered	 DECIMAL	(10,3),
QuantityShipped	 DECIMAL	(10,3),
QuantityBackordered	 DECIMAL	(10,3),
QuantityCode	varchar(1),
UnitofMeasure	varchar(3),
UMCode 	varchar(1), --123
UMMultiplier	 DECIMAL	(11,5),
ItemClass	varchar(2),
ItemSubClass	varchar(2),
NonStockCode	varchar(1),
PriceList	int,
ListPrice	 DECIMAL	(11,5),
ItemDiscountPercent	 DECIMAL	(5,2),
FinalPriceOverrideCode	varchar(1),
QtyDscType 	varchar(1), --I=ItemC=Classblank=none
SpecialOrderCode	varchar(1),
AdditionalDiscountPercent	 DECIMAL	(5,2),
ActualSellPrice	 DECIMAL	(11,5),
TotalLineAmount	 DECIMAL	(9,2),
LotChargeCode	varchar(1),
SystemListPrice	 DECIMAL	(11,5),
SystemItemDiscountPercent	 DECIMAL	(5,2),
SystemAccountSellPrice	 DECIMAL	(11,5),
SystemCost	 DECIMAL	(11,5),
SystemTotalLineAmount	 DECIMAL	(9,2),
PricingUM	varchar(3),
PriceConversion	 DECIMAL	(11,5),
TaxableCode	varchar(1),
TaxExemptCode	varchar(1),
ContainerCharge	 DECIMAL	(11,5),
FederalExciseTaxAmount	 DECIMAL	(7,2),
AllowCashDiscountCode	varchar(1),
WarehouseLocation	varchar(8),
CurrentAverageCost	 DECIMAL	(11,5),
OurPurchaseOrderNumber	varchar(6),
AllocatedCode	varchar(1),
LineValue	 DECIMAL	(9,2),
CostOverrideCode	varchar(1),
InvoiceCost	 DECIMAL	(9,2),
CatchWeightCode	varchar(1),
UnitWeight	 DECIMAL	(9,4),
ExtendedWeight	 DECIMAL	(11,4),
DropShipCode	varchar(1),
ReUsableCode	varchar(1),
KitBuildQuantity	 DECIMAL	(10,3),
KitBuildAllocatedQuantity	 DECIMAL	(10,3),
GeneralLedgerAccountNumber	int,
BackorderCreated	varchar(1),
DeleteReasonCode	varchar(2),
QuantityBreakClass	varchar(3),
DiscountMarkupCode1	varchar(1),
SystemDiscountMarkupCode	varchar(1),
PriceClass	int,
ContractCode	varchar(1),
PrimaryOrderQuantity	 DECIMAL	(10,3),
QuantityBreakPointer	int,
ClassQuantityDiscountPercent	 DECIMAL	(5,2),
CustomerSortWord	varchar(10),
UpdateStockouts	varchar(1),
ItemQuantityDiscount	 DECIMAL	(11,5),
UserArea	varchar(10),
BillofMaterialsCode	varchar(1),
KitBuildCode	varchar(1),
ItemGLCode	varchar(2),
SpecialOrderSequence	varchar(5),
InsertInProgressFlag	varchar(1),
AssignedComplete	varchar(1),
WHMgmtCode	varchar(1),
BoxType	varchar(2),
PickListSequence	varchar(7),
PrintonPickList	varchar(1),
InvoicePrintSequence	varchar(7),
ParentOrderNumber	int,
EntrySequenceNumber	int,
OriginalQuantity	 DECIMAL	(10,3),
OriginalItemNumber	varchar(27),
ReplacementReasonCode	varchar(1),
OriginalWarehouse	varchar(2),
ShippingWarehouse	varchar(2),
ReturnReasonCode	varchar(2),
TotalCubesOrdered	 DECIMAL	(9,3),
TotalCubesShipped	 DECIMAL	(9,3),
ProcuctRestrictionCode	varchar(6),
MSDSSheetStatus	varchar(1),
CommissionCost	 DECIMAL	(11,5),
InventoryCost	 DECIMAL	(11,5),
RebateVendorNumber	varchar(6),
RebateId	varchar(10),
CustomerOrderUM	varchar(3),
ApplyForRebate	varchar(1),
EDILineReferenceNumber	varchar(11),
CustomerOrderQuantity	 DECIMAL	(10,3),
CustomerPricingUM	varchar(3),
LineItemTaxAmount	 DECIMAL	(9,2),
OrderTaxAmount	 DECIMAL	(9,2),
OriginalParOrderNumber	int,
OriginalEntrySeqNmbr	int,
PickListRunNumber	int,
EffectiveCentury	int,
EffectiveDate	Date,
RevisionLevel	varchar(5),
JobNumber	varchar(15),
ConsolidatedBillCode	varchar(2),
ConsolidatedInvControlNumber	int,
ItemContractCode	varchar(4),
InventoryPostedFlag	varchar(1),
ReturntoVendorLogNumber	int,
MinimumGrossMarginMet	varchar(1),
ActualSpecialChargeCost	 DECIMAL	(9,2),
ProjctedSpecialChargeCost	 DECIMAL	(9,2),
DaysinProcessType 	Varchar(1)
)

insert into APLUS2FAW.ORDET (
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderSequenceNumber,
LineItemType,
ShipToNumber,
SalesRepNumber,
WarehouseID,
OrderType,
OrderStatusCode,
OrderHoldCode,
DueCentury,
DueDate,
LotCode,
ItemNumber,
ItemDescription1,
ItemDescription2,
QuantityOrdered,
QuantityShipped,
QuantityBackordered,
QuantityCode,
UnitofMeasure,
UMCode, --123
UMMultiplier,
ItemClass,
ItemSubClass,
NonStockCode,
PriceList,
ListPrice,
ItemDiscountPercent,
FinalPriceOverrideCode,
QtyDscType, --I=ItemC=Classblank=none
SpecialOrderCode,
AdditionalDiscountPercent,
ActualSellPrice,
TotalLineAmount,
LotChargeCode,
SystemListPrice,
SystemItemDiscountPercent,
SystemAccountSellPrice,
SystemCost,
SystemTotalLineAmount,
PricingUM,
PriceConversion,
TaxableCode,
TaxExemptCode,
ContainerCharge,
FederalExciseTaxAmount,
AllowCashDiscountCode,
WarehouseLocation,
CurrentAverageCost,
OurPurchaseOrderNumber,
AllocatedCode,
LineValue,
CostOverrideCode,
InvoiceCost,
CatchWeightCode,
UnitWeight,
ExtendedWeight,
DropShipCode,
ReUsableCode,
KitBuildQuantity,
KitBuildAllocatedQuantity,
GeneralLedgerAccountNumber,
BackorderCreated,
DeleteReasonCode,
QuantityBreakClass,
DiscountMarkupCode1,
SystemDiscountMarkupCode,
PriceClass,
ContractCode,
PrimaryOrderQuantity,
QuantityBreakPointer,
ClassQuantityDiscountPercent,
CustomerSortWord,
UpdateStockouts,
ItemQuantityDiscount,
UserArea,
BillofMaterialsCode,
KitBuildCode,
ItemGLCode,
SpecialOrderSequence,
InsertInProgressFlag,
AssignedComplete,
WHMgmtCode,
BoxType,
PickListSequence,
PrintonPickList,
InvoicePrintSequence,
ParentOrderNumber,
EntrySequenceNumber,
OriginalQuantity,
OriginalItemNumber,
ReplacementReasonCode,
OriginalWarehouse,
ShippingWarehouse,
ReturnReasonCode,
TotalCubesOrdered,
TotalCubesShipped,
ProcuctRestrictionCode,
MSDSSheetStatus,
CommissionCost,
InventoryCost,
RebateVendorNumber,
RebateId,
CustomerOrderUM,
ApplyForRebate,
EDILineReferenceNumber,
CustomerOrderQuantity,
CustomerPricingUM,
LineItemTaxAmount,
OrderTaxAmount,
OriginalParOrderNumber,
OriginalEntrySeqNmbr,
PickListRunNumber,
EffectiveCentury,
EffectiveDate,
RevisionLevel,
JobNumber,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ItemContractCode,
InventoryPostedFlag,
ReturntoVendorLogNumber,
MinimumGrossMarginMet,
ActualSpecialChargeCost,
ProjctedSpecialChargeCost,
DaysinProcessType 
)
select TOP 10 
CustomerNumber,
CompanyNumber,
OrderNumber,
OrderGenerationNumber,
OrderSequenceNumber,
LineItemType,
ShipToNumber,
SalesRepNumber,
WarehouseID,
OrderType,
OrderStatusCode,
OrderHoldCode,
DueCentury,
DueDate,
LotCode,
ItemNumber,
ItemDescription1,
ItemDescription2,
QuantityOrdered,
QuantityShipped,
QuantityBackordered,
QuantityCode,
UnitofMeasure,
UMCode, --123
UMMultiplier,
ItemClass,
ItemSubClass,
NonStockCode,
PriceList,
ListPrice,
ItemDiscountPercent,
FinalPriceOverrideCode,
QtyDscType, --I=ItemC=Classblank=none
SpecialOrderCode,
AdditionalDiscountPercent,
ActualSellPrice,
TotalLineAmount,
LotChargeCode,
SystemListPrice,
SystemItemDiscountPercent,
SystemAccountSellPrice,
SystemCost,
SystemTotalLineAmount,
PricingUM,
PriceConversion,
TaxableCode,
TaxExemptCode,
ContainerCharge,
FederalExciseTaxAmount,
AllowCashDiscountCode,
WarehouseLocation,
CurrentAverageCost,
OurPurchaseOrderNumber,
AllocatedCode,
LineValue,
CostOverrideCode,
InvoiceCost,
CatchWeightCode,
UnitWeight,
ExtendedWeight,
DropShipCode,
ReUsableCode,
KitBuildQuantity,
KitBuildAllocatedQuantity,
GeneralLedgerAccountNumber,
BackorderCreated,
DeleteReasonCode,
QuantityBreakClass,
DiscountMarkupCode1,
SystemDiscountMarkupCode,
PriceClass,
ContractCode,
PrimaryOrderQuantity,
QuantityBreakPointer,
ClassQuantityDiscountPercent,
CustomerSortWord,
UpdateStockouts,
ItemQuantityDiscount,
UserArea,
BillofMaterialsCode,
KitBuildCode,
ItemGLCode,
SpecialOrderSequence,
InsertInProgressFlag,
AssignedComplete,
WHMgmtCode,
BoxType,
PickListSequence,
PrintonPickList,
InvoicePrintSequence,
ParentOrderNumber,
EntrySequenceNumber,
OriginalQuantity,
OriginalItemNumber,
ReplacementReasonCode,
OriginalWarehouse,
ShippingWarehouse,
ReturnReasonCode,
TotalCubesOrdered,
TotalCubesShipped,
ProcuctRestrictionCode,
MSDSSheetStatus,
CommissionCost,
InventoryCost,
RebateVendorNumber,
RebateId,
CustomerOrderUM,
ApplyForRebate,
EDILineReferenceNumber,
CustomerOrderQuantity,
CustomerPricingUM,
LineItemTaxAmount,
OrderTaxAmount,
OriginalParOrderNumber,
OriginalEntrySeqNmbr,
PickListRunNumber,
EffectiveCentury,
EffectiveDate,
RevisionLevel,
JobNumber,
ConsolidatedBillCode,
ConsolidatedInvControlNumber,
ItemContractCode,
InventoryPostedFlag,
ReturntoVendorLogNumber,
MinimumGrossMarginMet,
ActualSpecialChargeCost,
ProjctedSpecialChargeCost,
DaysinProcessType 
from openquery (bkl400, 
'select 
ODCSNO	as CustomerNumber,
ODCONO	as CompanyNumber,
ODORNO	as OrderNumber,
ODORGN	as OrderGenerationNumber,
ODORSQ	as OrderSequenceNumber,
ODLITP	as LineItemType,
ODSHP#	as ShipToNumber,
ODRPNO	as SalesRepNumber,
ODWHID	as WarehouseID,
ODORTP	as OrderType,
ODORST	as OrderStatusCode,
ODOHLD	as OrderHoldCode,
ODDUCC	as DueCentury,
case ODDUCC 
when 19 then varchar_format(timestamp_format(char(ODDUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(ODDUDT,6,0)),''YYMMDD''),''YYMMDD'') end as DueDate,
ODLTCD	as LotCode,
ODITNO	as ItemNumber,
ODITD1	as ItemDescription1,
ODITD2	as ItemDescription2,
ODQTOR	as QuantityOrdered,
ODQTSH	as QuantityShipped,
ODBOQT	as QuantityBackordered,
ODQTCD	as QuantityCode,
ODUNMS	as UnitofMeasure,
ODUMCD	as UMCode,
ODUMLT	as UMMultiplier,
ODITCL	as ItemClass,
ODITSC	as ItemSubClass,
ODNOST	as NonStockCode,
ODPRLS	as PriceList,
ODLSPR	as ListPrice,
ODDSCP	as ItemDiscountPercent,
ODFPOC	as FinalPriceOverrideCode,
ODQDST	as QtyDscType, 
ODSOCD	as SpecialOrderCode,
ODADSP	as AdditionalDiscountPercent,
ODASLP	as ActualSellPrice,
ODLNAM	as TotalLineAmount,
ODLTCH	as LotChargeCode,
ODSYLS	as SystemListPrice,
ODSYID	as SystemItemDiscountPercent,
ODSASL	as SystemAccountSellPrice,
ODSYCS	as SystemCost,
ODSYAM	as SystemTotalLineAmount,
ODPRUM	as PricingUM,
ODPRCN	as PriceConversion,
ODTXCD	as TaxableCode,
ODEXMT	as TaxExemptCode,
ODCNCH	as ContainerCharge,
ODFETX	as FederalExciseTaxAmount,
ODACDC	as AllowCashDiscountCode,
ODWHLC	as WarehouseLocation,
ODCAVC	as CurrentAverageCost,
ODOUPR	as OurPurchaseOrderNumber,
ODALCD	as AllocatedCode,
ODLNVL	as LineValue,
ODCOVC	as CostOverrideCode,
ODCSTX	as InvoiceCost,
ODCTWT	as CatchWeightCode,
ODUNWT	as UnitWeight,
ODEXWT	as ExtendedWeight,
ODDRSH	as DropShipCode,
ODREUS	as ReUsableCode,
ODBLQT	as KitBuildQuantity,
ODBALQ	as KitBuildAllocatedQuantity,
ODACNO	as GeneralLedgerAccountNumber,
ODBOCR	as BackorderCreated,
ODDLRS	as DeleteReasonCode,
ODQBCL	as QuantityBreakClass,
ODDSMR	as DiscountMarkupCode1,
ODSYDM	as SystemDiscountMarkupCode,
ODPRCL	as PriceClass,
ODCNCD	as ContractCode,
ODPROQ	as PrimaryOrderQuantity,
ODQBPT	as QuantityBreakPointer,
ODCQDP	as ClassQuantityDiscountPercent,
ODCSRT	as CustomerSortWord,
ODUPSO	as UpdateStockouts,
ODIQDS	as ItemQuantityDiscount,
ODUS10	as UserArea,
ODBMCD	as BillofMaterialsCode,
ODBLCD	as KitBuildCode,
ODITGL	as ItemGLCode,
ODSOSQ	as SpecialOrderSequence,
ODIIPG	as InsertInProgressFlag,
ODASCM	as AssignedComplete,
ODWMCD	as WHMgmtCode,
ODBXTP	as BoxType,
ODPLSQ	as PickListSequence,
ODPRPK	as PrintonPickList,
ODIPSQ	as InvoicePrintSequence,
ODPROR	as ParentOrderNumber,
ODETSQ	as EntrySequenceNumber,
ODOGQT	as OriginalQuantity,
ODORIT	as OriginalItemNumber,
ODRRCD	as ReplacementReasonCode,
ODORWH	as OriginalWarehouse,
ODSHWH	as ShippingWarehouse,
ODRTRC	as ReturnReasonCode,
ODTCBO	as TotalCubesOrdered,
ODTCBS	as TotalCubesShipped,
ODRSCD	as ProcuctRestrictionCode,
ODMSDS	as MSDSSheetStatus,
ODCMCS	as CommissionCost,
ODINCS	as InventoryCost,
ODRBVN	as RebateVendorNumber,
ODRBID	as RebateId,
ODCOUM	as CustomerOrderUM,
ODAPRB	as ApplyForRebate,
ODELR#	as EDILineReferenceNumber,
ODCQTO	as CustomerOrderQuantity,
ODCPUM	as CustomerPricingUM,
ODLTXA	as LineItemTaxAmount,
ODOTXA	as OrderTaxAmount,
ODOPAR	as OriginalParOrderNumber,
ODOESQ	as OriginalEntrySeqNmbr,
ODPLRN	as PickListRunNumber,
ODEFCC	as EffectiveCentury,
case ODEFCC 
when 19 then varchar_format(timestamp_format(char(ODEFDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(ODEFDT,6,0)),''YYMMDD''),''YYMMDD'') end as EffectiveDate,
ODRLVL	as RevisionLevel,
ODJOBN	as JobNumber,
ODCBCD	as ConsolidatedBillCode,
ODCICT	as ConsolidatedInvControlNumber,
ODITCT	as ItemContractCode,
ODINVP	as InventoryPostedFlag,
ODRTVL	as ReturntoVendorLogNumber,
ODMGMM	as MinimumGrossMarginMet,
ODASPC	as ActualSpecialChargeCost,
ODPCCS	as ProjctedSpecialChargeCost,
ODDIPT	as DaysinProcessType 
from APLUS2FAW.ORDET')

Create table APLUS2FAW.RCPT (
CompanyNumber	int,
PurchaseOrderNumber	varchar(6),
LineSequenceNo	int,
VendorNumber	varchar(6),
ItemNumber	varchar(27),
WarehouseID	varchar(2),
OrderQuantity	 DECIMAL	(10,3),
UnitofMeasure	varchar(3),
DueCentury	int,
DueDate	Date,
NonInventoryFlag	varchar(1),
UpdateInventoryCode	varchar(1),
UpdateAverageCost	varchar(1),
ReceiptQuantity	 DECIMAL	(10,3),
ReceiptCentury	int,
ReceiptDate	Date,
SequenceNumber3	varchar(3),
ReceivedCompleteCode	varchar(1),
InvoiceCost	 DECIMAL	(9,2),
SubstituteItemNumber	varchar(27),
SubstituteNonStocked	varchar(1),
WorkStationId	varchar(2),
ReservedArea	varchar(6),
LotChargeCode	varchar(1),
OverrideCost1	 DECIMAL	(11,5),
OverrideCode	varchar(1),
ErrorMessage1	varchar(3),
PostingFlag	varchar(1),
TotalReceiptWeight	 DECIMAL	(11,4),
VoucherCompany	varchar(2),
VoucherNumber	varchar(7),
InvoiceValue	 DECIMAL	(9,2),
ReceiverNumber	varchar(8),
GroupIDNumber	varchar(2),
RecordNumber	varchar(5),
UnitofMeasure1	varchar(3),
TransactionCentury	int,
TransactionDate	Date,
Time	Time,
SequenceNumber4	int,
DateTimeStampDate	Date,
DateTimeStampTime	Time,
DrillDownSequenceNo	int,
LeadTimeCalc	varchar(1),
HistorySeqNumber	int,
RcptQtyStckUM 	 DECIMAL	(11,3)
)

insert into APLUS2FAW.RCPT (
CompanyNumber,
PurchaseOrderNumber,
LineSequenceNo,
VendorNumber,
ItemNumber,
WarehouseID,
OrderQuantity,
UnitofMeasure,
DueCentury,
DueDate,
NonInventoryFlag,
UpdateInventoryCode,
UpdateAverageCost,
ReceiptQuantity,
ReceiptCentury,
ReceiptDate,
SequenceNumber3,
ReceivedCompleteCode,
InvoiceCost,
SubstituteItemNumber,
SubstituteNonStocked,
WorkStationId,
ReservedArea,
LotChargeCode,
OverrideCost1,
OverrideCode,
ErrorMessage1,
PostingFlag,
TotalReceiptWeight,
VoucherCompany,
VoucherNumber,
InvoiceValue,
ReceiverNumber,
GroupIDNumber,
RecordNumber,
UnitofMeasure1,
TransactionCentury,
TransactionDate,
Time,
SequenceNumber4,
DateTimeStampDate,
DateTimeStampTime,
DrillDownSequenceNo,
LeadTimeCalc,
HistorySeqNumber,
RcptQtyStckUM 
)
select top 10
CompanyNumber,
PurchaseOrderNumber,
LineSequenceNo,
VendorNumber,
ItemNumber,
WarehouseID,
OrderQuantity,
UnitofMeasure,
DueCentury,
DueDate,
NonInventoryFlag,
UpdateInventoryCode,
UpdateAverageCost,
ReceiptQuantity,
ReceiptCentury,
ReceiptDate,
SequenceNumber3,
ReceivedCompleteCode,
InvoiceCost,
SubstituteItemNumber,
SubstituteNonStocked,
WorkStationId,
ReservedArea,
LotChargeCode,
OverrideCost1,
OverrideCode,
ErrorMessage1,
PostingFlag,
TotalReceiptWeight,
VoucherCompany,
VoucherNumber,
InvoiceValue,
ReceiverNumber,
GroupIDNumber,
RecordNumber,
UnitofMeasure1,
TransactionCentury,
TransactionDate,
Time,
SequenceNumber4,
DateTimeStampDate,
DateTimeStampTime,
DrillDownSequenceNo,
LeadTimeCalc,
HistorySeqNumber,
RcptQtyStckUM 
from openquery (bkl400, 
'select 
RCCONO	as CompanyNumber,
RCPONO	as PurchaseOrderNumber,
RCLNSQ	as LineSequenceNo,
RCVNNO	as VendorNumber,
RCITNO	as ItemNumber,
RCWHID	as WarehouseID,
RCORQT	as OrderQuantity,
RCUNMS	as UnitofMeasure,
RCDUCC	as DueCentury,
case RCDUCC 
when 19 then varchar_format(timestamp_format(char(RCDUDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(RCDUDT,6,0)),''YYMMDD''),''YYMMDD'') end as DueDate,
RCNOIN	as NonInventoryFlag,
RCUPIN	as UpdateInventoryCode,
RCUPAV	as UpdateAverageCost,
RCRCQT	as ReceiptQuantity,
RCRCCC	as ReceiptCentury,
case RCRCCC 
when 19 then varchar_format(timestamp_format(char(RCRCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(RCRCDT,6,0)),''YYMMDD''),''YYMMDD'') end as ReceiptDate,
RCSQA3	as SequenceNumber3,
RCRCCM	as ReceivedCompleteCode,
RCCSTX	as InvoiceCost,
RCSBIT	as SubstituteItemNumber,
RCSBNS	as SubstituteNonStocked,
RCWS02	as WorkStationId,
RCRS06	as ReservedArea,
RCLTCH	as LotChargeCode,
RCOVCS	as OverrideCost1,
RCOVCD	as OverrideCode,
RCERMS	as ErrorMessage1,
RCPOFL	as PostingFlag,
RCRCWT	as TotalReceiptWeight,
RCVOC#	as VoucherCompany,
RCVONO	as VoucherNumber,
RCINVL	as InvoiceValue,
RCRCVR	as ReceiverNumber,
RCGRID	as GroupIDNumber,
RCREC#	as RecordNumber,
RCUNM1	as UnitofMeasure1,
RCTRCC	as TransactionCentury,
case RCTRCC 
when 19 then varchar_format(timestamp_format(char(RCTRDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(RCTRDT,6,0)),''YYMMDD''),''YYMMDD'') end as TransactionDate,
time(to_date(digits(cast(RCTIME as dec(6,0))),''HH24MISS'')) as Time,
RCSQ04	as SequenceNumber4,
varchar_format(timestamp_format(substr(char(LPAD(RCSTMP,12,0)),1,6),''YYMMDD''),''YYMMDD'') as DateTimeStampDate,
time(to_date(digits(cast(substr(RCSTMP,7,12) as dec(6,0))),''HH24MISS'')) as DateTimeStampTime,
RCDDSQ	as DrillDownSequenceNo,
RCLDFG	as LeadTimeCalc,
RCHSSQ	as HistorySeqNumber,
RCQTYS	as RcptQtyStckUM
from APLUS2FAW.RCPT')

Create table APLUS2FAW.WMBAL(
ItemNumber	varchar(27),
WarehouseID	varchar(2),
AssignSequence	int,
Location	varchar(12),
LotSerialNumber	varchar(20),
ExpirationCentury	int,
ExpirationDate	Date,
Notes	varchar(20),
CharacterFillerField08	varchar(8),
HoldCode	varchar(1),
HoldPOCompany	int,
HoldPONumber	varchar(6),
HoldCentury	int,
HoldDate	Date,
CharacterFillerField4	varchar(4),
QtyOnHandUM1	 DECIMAL	(11,3),
QtyOnHandUM2	 DECIMAL	(11,3),
QtyOnHandUM3	 DECIMAL	(11,3),
QtyUsedUM1	 DECIMAL	(11,3),
QtyUsedUM2	 DECIMAL	(11,3),
QtyUsedUM3	 DECIMAL	(11,3),
LastTransactionCentury	int,
LastTransactionDate	Date,
LastTransactionType	varchar(1),
WorkStationId	varchar(2),
CharacterFillerField8	varchar(8),
ReceiptCentury	int,
ReceiptDate Date,
WarehouseWorkField	varchar(2),
LocationWorkField	varchar(12),
Cost	 DECIMAL	(11,5),
MoveNumber	int,
ResequenceWorkField	varchar(1),
TransactionID	int,
CharacterFillerField17	varchar(17),
UnavailableLoc	varchar(1),
UnavailOverrideFlag	varchar(1),
UnavailableReleaseCentury	int,
UnavailableReleaseDate	Date,
TransID1	int,
TransID2	int,
TransID3	int,
TransID4 	int
)

insert into APLUS2FAW.WMBAL(
ItemNumber,
WarehouseID,
AssignSequence,
Location,
LotSerialNumber,
ExpirationCentury,
ExpirationDate,
Notes,
CharacterFillerField08,
HoldCode,
HoldPOCompany,
HoldPONumber,
HoldCentury,
HoldDate,
CharacterFillerField4,
QtyOnHandUM1,
QtyOnHandUM2,
QtyOnHandUM3,
QtyUsedUM1,
QtyUsedUM2,
QtyUsedUM3,
LastTransactionCentury,
LastTransactionDate,
LastTransactionType,
WorkStationId,
CharacterFillerField8,
ReceiptCentury,
ReceiptDate,
WarehouseWorkField,
LocationWorkField,
Cost,
MoveNumber,
ResequenceWorkField,
TransactionID,
CharacterFillerField17,
UnavailableLoc,
UnavailOverrideFlag,
UnavailableReleaseCentury,
UnavailableReleaseDate,
TransID1,
TransID2,
TransID3,
TransID4 
)
select top 10
ItemNumber,
WarehouseID,
AssignSequence,
Location,
LotSerialNumber,
ExpirationCentury,
ExpirationDate,
Notes,
CharacterFillerField08,
HoldCode,
HoldPOCompany,
HoldPONumber,
HoldCentury,
HoldDate,
CharacterFillerField4,
QtyOnHandUM1,
QtyOnHandUM2,
QtyOnHandUM3,
QtyUsedUM1,
QtyUsedUM2,
QtyUsedUM3,
LastTransactionCentury,
LastTransactionDate,
LastTransactionType,
WorkStationId,
CharacterFillerField8,
ReceiptCentury,
ReceiptDate,
WarehouseWorkField,
LocationWorkField,
Cost,
MoveNumber,
ResequenceWorkField,
TransactionID,
CharacterFillerField17,
UnavailableLoc,
UnavailOverrideFlag,
UnavailableReleaseCentury,
UnavailableReleaseDate,
TransID1,
TransID2,
TransID3,
TransID4 
from openquery (bkl400, 
'select 
WBITNO	as ItemNumber,
WBWHID	as WarehouseID,
WBASSQ	as AssignSequence,
WBLOCA	as Location,
WBLTSR	as LotSerialNumber,
WBCNTY	as ExpirationCentury,
case WBCNTY 
when 19 then varchar_format(timestamp_format(char(WBEXDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(WBEXDT,6,0)),''YYMMDD''),''YYMMDD'') end as ExpirationDate,
WBNTES	as Notes,
WBFL08	as CharacterFillerField08,
WBHOLD	as HoldCode,
WBHLCO	as HoldPOCompany,
WBHLPO	as HoldPONumber,
WBCNT1	as HoldCentury,
case WBCNT1 
when 19 then varchar_format(timestamp_format(char(WBHLDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(WBHLDT,6,0)),''YYMMDD''),''YYMMDD'') end as HoldDate,
WBFL04	as CharacterFillerField4,
WBOHQ1	as QtyOnHandUM1,
WBOHQ2	as QtyOnHandUM2,
WBOHQ3	as QtyOnHandUM3,
WBQUS1	as QtyUsedUM1,
WBQUS2	as QtyUsedUM2,
WBQUS3	as QtyUsedUM3,
WBCNT2	as LastTransactionCentury,
case WBCNT2 
when 19 then varchar_format(timestamp_format(char(WBLTRD+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(WBLTRD,6,0)),''YYMMDD''),''YYMMDD'') end as LastTransactionDate,
WBLTRT	as LastTransactionType,
WBWS02	as WorkStationId,
WBFIL8	as CharacterFillerField8,
WBCNT3	as ReceiptCentury,
case WBCNT3 
when 19 then varchar_format(timestamp_format(char(WBRCDT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(WBRCDT,6,0)),''YYMMDD''),''YYMMDD'') end as ReceiptDate,
WBWHWK	as WarehouseWorkField,
WBLCWK	as LocationWorkField,
WBCOST	as Cost,
WBMVNO	as MoveNumber,
WBRESQ	as ResequenceWorkField,
WBTRNI	as TransactionID,
WBFL17	as CharacterFillerField17,
WBBPAR	as UnavailableLoc,
WBUAOV	as UnavailOverrideFlag,
WBUACC	as UnavailableReleaseCentury,
case WBUACC 
when 19 then varchar_format(timestamp_format(char(WBUADT+19000000), ''YYYYMMDD''), ''YYYYMMDD'')
when 20 then varchar_format(timestamp_format(char(LPAD(WBUADT,6,0)),''YYMMDD''),''YYMMDD'') end as UnavailableReleaseDate,
WBTP01	as TransID1,
WBTP02	as TransID2,
WBTP03	as TransID3,
WBTP04	as TransID4
from APLUS2FAW.WMBAL')